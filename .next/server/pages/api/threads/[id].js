"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/threads/[id]";
exports.ids = ["pages/api/threads/[id]"];
exports.modules = {

/***/ "@supabase/supabase-js":
/*!****************************************!*\
  !*** external "@supabase/supabase-js" ***!
  \****************************************/
/***/ ((module) => {

module.exports = require("@supabase/supabase-js");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fthreads%2F%5Bid%5D&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cthreads%5C%5Bid%5D.js&middlewareConfigBase64=e30%3D!":
/*!******************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fthreads%2F%5Bid%5D&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cthreads%5C%5Bid%5D.js&middlewareConfigBase64=e30%3D! ***!
  \******************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_threads_id_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages\\api\\threads\\[id].js */ \"(api)/./pages/api/threads/[id].js\");\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_threads_id_js__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_threads_id_js__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/threads/[id]\",\n        pathname: \"/api/threads/[id]\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _pages_api_threads_id_js__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRnRocmVhZHMlMkYlNUJpZCU1RCZwcmVmZXJyZWRSZWdpb249JmFic29sdXRlUGFnZVBhdGg9LiUyRnBhZ2VzJTVDYXBpJTVDdGhyZWFkcyU1QyU1QmlkJTVELmpzJm1pZGRsZXdhcmVDb25maWdCYXNlNjQ9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNMO0FBQzFEO0FBQzJEO0FBQzNEO0FBQ0EsaUVBQWUsd0VBQUssQ0FBQyxxREFBUSxZQUFZLEVBQUM7QUFDMUM7QUFDTyxlQUFlLHdFQUFLLENBQUMscURBQVE7QUFDcEM7QUFDTyx3QkFBd0IsZ0hBQW1CO0FBQ2xEO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLFlBQVk7QUFDWixDQUFDOztBQUVEIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vNWNoLz81ZmVjIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFBhZ2VzQVBJUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9wYWdlcy1hcGkvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgaG9pc3QgfSBmcm9tIFwibmV4dC9kaXN0L2J1aWxkL3RlbXBsYXRlcy9oZWxwZXJzXCI7XG4vLyBJbXBvcnQgdGhlIHVzZXJsYW5kIGNvZGUuXG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiLi9wYWdlc1xcXFxhcGlcXFxcdGhyZWFkc1xcXFxbaWRdLmpzXCI7XG4vLyBSZS1leHBvcnQgdGhlIGhhbmRsZXIgKHNob3VsZCBiZSB0aGUgZGVmYXVsdCBleHBvcnQpLlxuZXhwb3J0IGRlZmF1bHQgaG9pc3QodXNlcmxhbmQsIFwiZGVmYXVsdFwiKTtcbi8vIFJlLWV4cG9ydCBjb25maWcuXG5leHBvcnQgY29uc3QgY29uZmlnID0gaG9pc3QodXNlcmxhbmQsIFwiY29uZmlnXCIpO1xuLy8gQ3JlYXRlIGFuZCBleHBvcnQgdGhlIHJvdXRlIG1vZHVsZSB0aGF0IHdpbGwgYmUgY29uc3VtZWQuXG5leHBvcnQgY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgUGFnZXNBUElSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuUEFHRVNfQVBJLFxuICAgICAgICBwYWdlOiBcIi9hcGkvdGhyZWFkcy9baWRdXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvdGhyZWFkcy9baWRdXCIsXG4gICAgICAgIC8vIFRoZSBmb2xsb3dpbmcgYXJlbid0IHVzZWQgaW4gcHJvZHVjdGlvbi5cbiAgICAgICAgYnVuZGxlUGF0aDogXCJcIixcbiAgICAgICAgZmlsZW5hbWU6IFwiXCJcbiAgICB9LFxuICAgIHVzZXJsYW5kXG59KTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cGFnZXMtYXBpLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fthreads%2F%5Bid%5D&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cthreads%5C%5Bid%5D.js&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./lib/cache.js":
/*!**********************!*\
  !*** ./lib/cache.js ***!
  \**********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   clearCachedTranslations: () => (/* binding */ clearCachedTranslations),\n/* harmony export */   getAllCachedTranslations: () => (/* binding */ getAllCachedTranslations),\n/* harmony export */   getCachedTranslation: () => (/* binding */ getCachedTranslation),\n/* harmony export */   setCachedTranslation: () => (/* binding */ setCachedTranslation)\n/* harmony export */ });\n// 翻訳キャッシュを管理するシンプルなユーティリティ\n// メモリ内キャッシュとしてシンプルに実装。必要に応じてRedisやSupabaseなどに置き換え可能\n// メモリ内キャッシュオブジェクト（サーバーリスタートでリセットされる）\nif (!global.translationCache) {\n    global.translationCache = {};\n}\nconst cache = global.translationCache;\n/**\r\n * キャッシュキーを生成\r\n * @param {string} sourceId - 翻訳元コンテンツのID\r\n * @param {string} field - 翻訳するフィールド名（title, bodyなど）\r\n * @param {string} targetLang - 翻訳先言語\r\n * @returns {string} キャッシュキー\r\n */ const generateCacheKey = (sourceId, field, targetLang)=>{\n    return `${sourceId}_${field}_${targetLang}`;\n};\n/**\r\n * 翻訳をキャッシュから取得\r\n * @param {string} sourceId - 翻訳元コンテンツのID\r\n * @param {string} field - 翻訳するフィールド名（title, bodyなど）\r\n * @param {string} targetLang - 翻訳先言語\r\n * @returns {string|null} キャッシュされた翻訳テキスト、なければnull\r\n */ function getCachedTranslation(sourceId, field, targetLang) {\n    const key = generateCacheKey(sourceId, field, targetLang);\n    const cached = cache[key];\n    if (cached) {\n        // キャッシュヒット数を記録（オプション）\n        cache[`${key}_hits`] = (cache[`${key}_hits`] || 0) + 1;\n    }\n    return cached || null;\n}\n/**\r\n * 翻訳をキャッシュに保存\r\n * @param {string} sourceId - 翻訳元コンテンツのID\r\n * @param {string} field - 翻訳するフィールド名（title, bodyなど）\r\n * @param {string} targetLang - 翻訳先言語\r\n * @param {string} text - 翻訳テキスト\r\n */ function setCachedTranslation(sourceId, field, targetLang, text) {\n    if (!text) return;\n    const key = generateCacheKey(sourceId, field, targetLang);\n    cache[key] = text;\n    // 最終更新時間を記録（オプション）\n    cache[`${key}_updated`] = Date.now();\n}\n/**\r\n * キャッシュ内のすべての翻訳を取得（デバッグ用）\r\n */ function getAllCachedTranslations() {\n    return {\n        ...cache\n    };\n}\n/**\r\n * 特定の条件に一致するキャッシュエントリをすべて削除\r\n * @param {object} filters - フィルター条件\r\n * @param {string} [filters.sourceId] - 特定のソースIDに関連するキャッシュのみ削除\r\n * @param {string} [filters.field] - 特定のフィールドに関連するキャッシュのみ削除\r\n * @param {string} [filters.targetLang] - 特定の言語に関連するキャッシュのみ削除\r\n */ function clearCachedTranslations(filters = {}) {\n    const { sourceId, field, targetLang } = filters;\n    Object.keys(cache).forEach((key)=>{\n        // メタデータキー（_hitsや_updatedで終わるもの）はスキップ\n        if (key.endsWith(\"_hits\") || key.endsWith(\"_updated\")) return;\n        const [keySourceId, keyField, keyLang] = key.split(\"_\");\n        // フィルター条件に基づいてキャッシュエントリを削除\n        if (sourceId && keySourceId !== sourceId || field && keyField !== field || targetLang && keyLang !== targetLang) {\n            return; // フィルター条件に一致しない場合はスキップ\n        }\n        // フィルター条件に一致する場合、キャッシュエントリとそのメタデータを削除\n        delete cache[key];\n        delete cache[`${key}_hits`];\n        delete cache[`${key}_updated`];\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9saWIvY2FjaGUuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBLDJCQUEyQjtBQUMzQixvREFBb0Q7QUFFcEQscUNBQXFDO0FBQ3JDLElBQUksQ0FBQ0EsT0FBT0MsZ0JBQWdCLEVBQUU7SUFDNUJELE9BQU9DLGdCQUFnQixHQUFHLENBQUM7QUFDN0I7QUFFQSxNQUFNQyxRQUFRRixPQUFPQyxnQkFBZ0I7QUFFckM7Ozs7OztDQU1DLEdBQ0QsTUFBTUUsbUJBQW1CLENBQUNDLFVBQVVDLE9BQU9DO0lBQ3pDLE9BQU8sQ0FBQyxFQUFFRixTQUFTLENBQUMsRUFBRUMsTUFBTSxDQUFDLEVBQUVDLFdBQVcsQ0FBQztBQUM3QztBQUVBOzs7Ozs7Q0FNQyxHQUNNLFNBQVNDLHFCQUFxQkgsUUFBUSxFQUFFQyxLQUFLLEVBQUVDLFVBQVU7SUFDOUQsTUFBTUUsTUFBTUwsaUJBQWlCQyxVQUFVQyxPQUFPQztJQUM5QyxNQUFNRyxTQUFTUCxLQUFLLENBQUNNLElBQUk7SUFFekIsSUFBSUMsUUFBUTtRQUNWLHNCQUFzQjtRQUN0QlAsS0FBSyxDQUFDLENBQUMsRUFBRU0sSUFBSSxLQUFLLENBQUMsQ0FBQyxHQUFHLENBQUNOLEtBQUssQ0FBQyxDQUFDLEVBQUVNLElBQUksS0FBSyxDQUFDLENBQUMsSUFBSSxLQUFLO0lBQ3ZEO0lBRUEsT0FBT0MsVUFBVTtBQUNuQjtBQUVBOzs7Ozs7Q0FNQyxHQUNNLFNBQVNDLHFCQUFxQk4sUUFBUSxFQUFFQyxLQUFLLEVBQUVDLFVBQVUsRUFBRUssSUFBSTtJQUNwRSxJQUFJLENBQUNBLE1BQU07SUFFWCxNQUFNSCxNQUFNTCxpQkFBaUJDLFVBQVVDLE9BQU9DO0lBQzlDSixLQUFLLENBQUNNLElBQUksR0FBR0c7SUFDYixtQkFBbUI7SUFDbkJULEtBQUssQ0FBQyxDQUFDLEVBQUVNLElBQUksUUFBUSxDQUFDLENBQUMsR0FBR0ksS0FBS0MsR0FBRztBQUNwQztBQUVBOztDQUVDLEdBQ00sU0FBU0M7SUFDZCxPQUFPO1FBQUUsR0FBR1osS0FBSztJQUFDO0FBQ3BCO0FBRUE7Ozs7OztDQU1DLEdBQ00sU0FBU2Esd0JBQXdCQyxVQUFVLENBQUMsQ0FBQztJQUNsRCxNQUFNLEVBQUVaLFFBQVEsRUFBRUMsS0FBSyxFQUFFQyxVQUFVLEVBQUUsR0FBR1U7SUFFeENDLE9BQU9DLElBQUksQ0FBQ2hCLE9BQU9pQixPQUFPLENBQUNYLENBQUFBO1FBQ3pCLHFDQUFxQztRQUNyQyxJQUFJQSxJQUFJWSxRQUFRLENBQUMsWUFBWVosSUFBSVksUUFBUSxDQUFDLGFBQWE7UUFFdkQsTUFBTSxDQUFDQyxhQUFhQyxVQUFVQyxRQUFRLEdBQUdmLElBQUlnQixLQUFLLENBQUM7UUFFbkQsMkJBQTJCO1FBQzNCLElBQ0UsWUFBYUgsZ0JBQWdCakIsWUFDNUJDLFNBQVNpQixhQUFhakIsU0FDdEJDLGNBQWNpQixZQUFZakIsWUFDM0I7WUFDQSxRQUFRLHVCQUF1QjtRQUNqQztRQUVBLHNDQUFzQztRQUN0QyxPQUFPSixLQUFLLENBQUNNLElBQUk7UUFDakIsT0FBT04sS0FBSyxDQUFDLENBQUMsRUFBRU0sSUFBSSxLQUFLLENBQUMsQ0FBQztRQUMzQixPQUFPTixLQUFLLENBQUMsQ0FBQyxFQUFFTSxJQUFJLFFBQVEsQ0FBQyxDQUFDO0lBQ2hDO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly81Y2gvLi9saWIvY2FjaGUuanM/ZjU0MyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyDnv7voqLPjgq3jg6Pjg4Pjgrfjg6XjgpLnrqHnkIbjgZnjgovjgrfjg7Pjg5fjg6vjgarjg6bjg7zjg4bjgqPjg6rjg4bjgqNcclxuLy8g44Oh44Oi44Oq5YaF44Kt44Oj44OD44K344Ol44Go44GX44Gm44K344Oz44OX44Or44Gr5a6f6KOF44CC5b+F6KaB44Gr5b+c44GY44GmUmVkaXPjgoRTdXBhYmFzZeOBquOBqeOBq+e9ruOBjeaPm+OBiOWPr+iDvVxyXG5cclxuLy8g44Oh44Oi44Oq5YaF44Kt44Oj44OD44K344Ol44Kq44OW44K444Kn44Kv44OI77yI44K144O844OQ44O844Oq44K544K/44O844OI44Gn44Oq44K744OD44OI44GV44KM44KL77yJXHJcbmlmICghZ2xvYmFsLnRyYW5zbGF0aW9uQ2FjaGUpIHtcclxuICBnbG9iYWwudHJhbnNsYXRpb25DYWNoZSA9IHt9O1xyXG59XHJcblxyXG5jb25zdCBjYWNoZSA9IGdsb2JhbC50cmFuc2xhdGlvbkNhY2hlO1xyXG5cclxuLyoqXHJcbiAqIOOCreODo+ODg+OCt+ODpeOCreODvOOCkueUn+aIkFxyXG4gKiBAcGFyYW0ge3N0cmluZ30gc291cmNlSWQgLSDnv7voqLPlhYPjgrPjg7Pjg4bjg7Pjg4Tjga5JRFxyXG4gKiBAcGFyYW0ge3N0cmluZ30gZmllbGQgLSDnv7voqLPjgZnjgovjg5XjgqPjg7zjg6vjg4nlkI3vvIh0aXRsZSwgYm9keeOBquOBqe+8iVxyXG4gKiBAcGFyYW0ge3N0cmluZ30gdGFyZ2V0TGFuZyAtIOe/u+ios+WFiOiogOiqnlxyXG4gKiBAcmV0dXJucyB7c3RyaW5nfSDjgq3jg6Pjg4Pjgrfjg6Xjgq3jg7xcclxuICovXHJcbmNvbnN0IGdlbmVyYXRlQ2FjaGVLZXkgPSAoc291cmNlSWQsIGZpZWxkLCB0YXJnZXRMYW5nKSA9PiB7XHJcbiAgcmV0dXJuIGAke3NvdXJjZUlkfV8ke2ZpZWxkfV8ke3RhcmdldExhbmd9YDtcclxufTtcclxuXHJcbi8qKlxyXG4gKiDnv7voqLPjgpLjgq3jg6Pjg4Pjgrfjg6XjgYvjgonlj5blvpdcclxuICogQHBhcmFtIHtzdHJpbmd9IHNvdXJjZUlkIC0g57+76Kiz5YWD44Kz44Oz44OG44Oz44OE44GuSURcclxuICogQHBhcmFtIHtzdHJpbmd9IGZpZWxkIC0g57+76Kiz44GZ44KL44OV44Kj44O844Or44OJ5ZCN77yIdGl0bGUsIGJvZHnjgarjganvvIlcclxuICogQHBhcmFtIHtzdHJpbmd9IHRhcmdldExhbmcgLSDnv7voqLPlhYjoqIDoqp5cclxuICogQHJldHVybnMge3N0cmluZ3xudWxsfSDjgq3jg6Pjg4Pjgrfjg6XjgZXjgozjgZ/nv7voqLPjg4bjgq3jgrnjg4jjgIHjgarjgZHjgozjgbBudWxsXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZ2V0Q2FjaGVkVHJhbnNsYXRpb24oc291cmNlSWQsIGZpZWxkLCB0YXJnZXRMYW5nKSB7XHJcbiAgY29uc3Qga2V5ID0gZ2VuZXJhdGVDYWNoZUtleShzb3VyY2VJZCwgZmllbGQsIHRhcmdldExhbmcpO1xyXG4gIGNvbnN0IGNhY2hlZCA9IGNhY2hlW2tleV07XHJcbiAgXHJcbiAgaWYgKGNhY2hlZCkge1xyXG4gICAgLy8g44Kt44Oj44OD44K344Ol44OS44OD44OI5pWw44KS6KiY6Yyy77yI44Kq44OX44K344On44Oz77yJXHJcbiAgICBjYWNoZVtgJHtrZXl9X2hpdHNgXSA9IChjYWNoZVtgJHtrZXl9X2hpdHNgXSB8fCAwKSArIDE7XHJcbiAgfVxyXG4gIFxyXG4gIHJldHVybiBjYWNoZWQgfHwgbnVsbDtcclxufVxyXG5cclxuLyoqXHJcbiAqIOe/u+ios+OCkuOCreODo+ODg+OCt+ODpeOBq+S/neWtmFxyXG4gKiBAcGFyYW0ge3N0cmluZ30gc291cmNlSWQgLSDnv7voqLPlhYPjgrPjg7Pjg4bjg7Pjg4Tjga5JRFxyXG4gKiBAcGFyYW0ge3N0cmluZ30gZmllbGQgLSDnv7voqLPjgZnjgovjg5XjgqPjg7zjg6vjg4nlkI3vvIh0aXRsZSwgYm9keeOBquOBqe+8iVxyXG4gKiBAcGFyYW0ge3N0cmluZ30gdGFyZ2V0TGFuZyAtIOe/u+ios+WFiOiogOiqnlxyXG4gKiBAcGFyYW0ge3N0cmluZ30gdGV4dCAtIOe/u+ios+ODhuOCreOCueODiFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHNldENhY2hlZFRyYW5zbGF0aW9uKHNvdXJjZUlkLCBmaWVsZCwgdGFyZ2V0TGFuZywgdGV4dCkge1xyXG4gIGlmICghdGV4dCkgcmV0dXJuO1xyXG4gIFxyXG4gIGNvbnN0IGtleSA9IGdlbmVyYXRlQ2FjaGVLZXkoc291cmNlSWQsIGZpZWxkLCB0YXJnZXRMYW5nKTtcclxuICBjYWNoZVtrZXldID0gdGV4dDtcclxuICAvLyDmnIDntYLmm7TmlrDmmYLplpPjgpLoqJjpjLLvvIjjgqrjg5fjgrfjg6fjg7PvvIlcclxuICBjYWNoZVtgJHtrZXl9X3VwZGF0ZWRgXSA9IERhdGUubm93KCk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiDjgq3jg6Pjg4Pjgrfjg6XlhoXjga7jgZnjgbnjgabjga7nv7voqLPjgpLlj5blvpfvvIjjg4fjg5Djg4PjgrDnlKjvvIlcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRBbGxDYWNoZWRUcmFuc2xhdGlvbnMoKSB7XHJcbiAgcmV0dXJuIHsgLi4uY2FjaGUgfTtcclxufVxyXG5cclxuLyoqXHJcbiAqIOeJueWumuOBruadoeS7tuOBq+S4gOiHtOOBmeOCi+OCreODo+ODg+OCt+ODpeOCqOODs+ODiOODquOCkuOBmeOBueOBpuWJiumZpFxyXG4gKiBAcGFyYW0ge29iamVjdH0gZmlsdGVycyAtIOODleOCo+ODq+OCv+ODvOadoeS7tlxyXG4gKiBAcGFyYW0ge3N0cmluZ30gW2ZpbHRlcnMuc291cmNlSWRdIC0g54m55a6a44Gu44K944O844K5SUTjgavplqLpgKPjgZnjgovjgq3jg6Pjg4Pjgrfjg6Xjga7jgb/liYrpmaRcclxuICogQHBhcmFtIHtzdHJpbmd9IFtmaWx0ZXJzLmZpZWxkXSAtIOeJueWumuOBruODleOCo+ODvOODq+ODieOBq+mWoumAo+OBmeOCi+OCreODo+ODg+OCt+ODpeOBruOBv+WJiumZpFxyXG4gKiBAcGFyYW0ge3N0cmluZ30gW2ZpbHRlcnMudGFyZ2V0TGFuZ10gLSDnibnlrprjga7oqIDoqp7jgavplqLpgKPjgZnjgovjgq3jg6Pjg4Pjgrfjg6Xjga7jgb/liYrpmaRcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBjbGVhckNhY2hlZFRyYW5zbGF0aW9ucyhmaWx0ZXJzID0ge30pIHtcclxuICBjb25zdCB7IHNvdXJjZUlkLCBmaWVsZCwgdGFyZ2V0TGFuZyB9ID0gZmlsdGVycztcclxuICBcclxuICBPYmplY3Qua2V5cyhjYWNoZSkuZm9yRWFjaChrZXkgPT4ge1xyXG4gICAgLy8g44Oh44K/44OH44O844K/44Kt44O877yIX2hpdHPjgoRfdXBkYXRlZOOBp+e1guOCj+OCi+OCguOBru+8ieOBr+OCueOCreODg+ODl1xyXG4gICAgaWYgKGtleS5lbmRzV2l0aCgnX2hpdHMnKSB8fCBrZXkuZW5kc1dpdGgoJ191cGRhdGVkJykpIHJldHVybjtcclxuICAgIFxyXG4gICAgY29uc3QgW2tleVNvdXJjZUlkLCBrZXlGaWVsZCwga2V5TGFuZ10gPSBrZXkuc3BsaXQoJ18nKTtcclxuICAgIFxyXG4gICAgLy8g44OV44Kj44Or44K/44O85p2h5Lu244Gr5Z+644Gl44GE44Gm44Kt44Oj44OD44K344Ol44Ko44Oz44OI44Oq44KS5YmK6ZmkXHJcbiAgICBpZiAoXHJcbiAgICAgIChzb3VyY2VJZCAmJiBrZXlTb3VyY2VJZCAhPT0gc291cmNlSWQpIHx8XHJcbiAgICAgIChmaWVsZCAmJiBrZXlGaWVsZCAhPT0gZmllbGQpIHx8XHJcbiAgICAgICh0YXJnZXRMYW5nICYmIGtleUxhbmcgIT09IHRhcmdldExhbmcpXHJcbiAgICApIHtcclxuICAgICAgcmV0dXJuOyAvLyDjg5XjgqPjg6vjgr/jg7zmnaHku7bjgavkuIDoh7TjgZfjgarjgYTloLTlkIjjga/jgrnjgq3jg4Pjg5dcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8g44OV44Kj44Or44K/44O85p2h5Lu244Gr5LiA6Ie044GZ44KL5aC05ZCI44CB44Kt44Oj44OD44K344Ol44Ko44Oz44OI44Oq44Go44Gd44Gu44Oh44K/44OH44O844K/44KS5YmK6ZmkXHJcbiAgICBkZWxldGUgY2FjaGVba2V5XTtcclxuICAgIGRlbGV0ZSBjYWNoZVtgJHtrZXl9X2hpdHNgXTtcclxuICAgIGRlbGV0ZSBjYWNoZVtgJHtrZXl9X3VwZGF0ZWRgXTtcclxuICB9KTtcclxufSAiXSwibmFtZXMiOlsiZ2xvYmFsIiwidHJhbnNsYXRpb25DYWNoZSIsImNhY2hlIiwiZ2VuZXJhdGVDYWNoZUtleSIsInNvdXJjZUlkIiwiZmllbGQiLCJ0YXJnZXRMYW5nIiwiZ2V0Q2FjaGVkVHJhbnNsYXRpb24iLCJrZXkiLCJjYWNoZWQiLCJzZXRDYWNoZWRUcmFuc2xhdGlvbiIsInRleHQiLCJEYXRlIiwibm93IiwiZ2V0QWxsQ2FjaGVkVHJhbnNsYXRpb25zIiwiY2xlYXJDYWNoZWRUcmFuc2xhdGlvbnMiLCJmaWx0ZXJzIiwiT2JqZWN0Iiwia2V5cyIsImZvckVhY2giLCJlbmRzV2l0aCIsImtleVNvdXJjZUlkIiwia2V5RmllbGQiLCJrZXlMYW5nIiwic3BsaXQiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./lib/cache.js\n");

/***/ }),

/***/ "(api)/./lib/dataStore.js":
/*!**************************!*\
  !*** ./lib/dataStore.js ***!
  \**************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   addPost: () => (/* binding */ addPost),\n/* harmony export */   addThread: () => (/* binding */ addThread),\n/* harmony export */   debugDataStore: () => (/* binding */ debugDataStore),\n/* harmony export */   getThreadWithPosts: () => (/* binding */ getThreadWithPosts),\n/* harmony export */   postsStore: () => (/* binding */ postsStore),\n/* harmony export */   threadsStore: () => (/* binding */ threadsStore)\n/* harmony export */ });\n/**\r\n * サーバーサイドで共有するデータストア\r\n * Next.jsの開発サーバーでAPIエンドポイント間でデータを共有するために使用\r\n */ // グローバル変数として保存するためのヘルパー\nif (!global.threadsStore) {\n    global.threadsStore = [\n        {\n            thread_id: \"1\",\n            title: \"サンプルスレッド1\",\n            created_at: new Date().toISOString(),\n            updated_at: new Date().toISOString(),\n            language: \"ja\"\n        },\n        {\n            thread_id: \"2\",\n            title: \"サンプルスレッド2\",\n            created_at: new Date(Date.now() - 86400000).toISOString(),\n            updated_at: new Date(Date.now() - 3600000).toISOString(),\n            language: \"ja\"\n        },\n        {\n            thread_id: \"3\",\n            title: \"プログラミングについての議論\",\n            created_at: new Date(Date.now() - 172800000).toISOString(),\n            updated_at: new Date(Date.now() - 5400000).toISOString(),\n            language: \"ja\"\n        }\n    ];\n}\nif (!global.postsStore) {\n    global.postsStore = {\n        \"1\": [\n            {\n                post_id: \"1_1\",\n                thread_id: \"1\",\n                body: \"最初の投稿です\",\n                anonymous_id: \"匿名123\",\n                created_at: new Date(Date.now() - 3600000).toISOString(),\n                language: \"ja\"\n            },\n            {\n                post_id: \"1_2\",\n                thread_id: \"1\",\n                body: \"返信です\",\n                anonymous_id: \"匿名456\",\n                created_at: new Date().toISOString(),\n                language: \"ja\"\n            }\n        ],\n        \"2\": [\n            {\n                post_id: \"2_1\",\n                thread_id: \"2\",\n                body: \"別のスレッドの投稿です\",\n                anonymous_id: \"匿名789\",\n                created_at: new Date(Date.now() - 2400000).toISOString(),\n                language: \"ja\"\n            }\n        ],\n        \"3\": [\n            {\n                post_id: \"3_1\",\n                thread_id: \"3\",\n                body: \"プログラミングについて話しましょう\",\n                anonymous_id: \"匿名101\",\n                created_at: new Date(Date.now() - 172000000).toISOString(),\n                language: \"ja\"\n            }\n        ]\n    };\n}\n// スレッドデータ保存用配列をエクスポート\nconst threadsStore = global.threadsStore;\n// 投稿データ保存用オブジェクトをエクスポート\nconst postsStore = global.postsStore;\n// 新しいスレッドを追加するユーティリティ関数\nfunction addThread(thread) {\n    // 既存のスレッドを確認（重複追加防止）\n    const existingThread = threadsStore.find((t)=>t.thread_id === thread.thread_id);\n    if (!existingThread) {\n        threadsStore.push({\n            ...thread\n        }); // オブジェクトをコピーして追加\n        console.log(`スレッド追加: ID=${thread.thread_id}, タイトル=\"${thread.title}\"`);\n        console.log(\"現在のスレッド一覧:\", threadsStore.map((t)=>t.thread_id));\n    }\n}\n// 新しい投稿を追加するユーティリティ関数\nfunction addPost(threadId, post) {\n    if (!postsStore[threadId]) {\n        postsStore[threadId] = [];\n    }\n    postsStore[threadId].push({\n        id: post.post_id,\n        threadId,\n        body: post.body,\n        language: post.language,\n        createdAt: post.created_at || new Date().toISOString()\n    });\n    console.log(`投稿追加: スレッドID=${threadId}, 投稿ID=${post.post_id}`);\n}\n// デバッグ用：データストアの内容を表示\nfunction debugDataStore() {\n    console.log(\"===== データストア内容 =====\");\n    console.log(\"スレッド数:\", threadsStore.length);\n    console.log(\"スレッドID一覧:\", threadsStore.map((t)=>t.thread_id));\n    console.log(\"投稿数:\", Object.keys(postsStore).length);\n    console.log(\"==========================\");\n}\n/**\r\n * スレッドと投稿を一度に取得\r\n * @param {string} threadId - スレッドID\r\n * @returns {object|null} スレッドと投稿の情報、見つからない場合はnull\r\n */ function getThreadWithPosts(threadId) {\n    // スレッドをメモリから取得\n    const thread = threadsStore.find((t)=>t.thread_id === threadId);\n    if (!thread) {\n        console.log(`スレッド未発見: ID=${threadId}`);\n        return null;\n    }\n    // 投稿をメモリから取得\n    const posts = postsStore[threadId] || [];\n    // 投稿データを整形\n    const formattedPosts = posts.map((post)=>({\n            id: post.post_id || post.id,\n            body: post.body,\n            anonymous_id: post.anonymous_id,\n            thread_id: post.thread_id,\n            created_at: post.created_at || post.createdAt,\n            original_lang: post.language,\n            translated_to: null // 翻訳先言語（後で設定）\n        }));\n    return {\n        thread: {\n            ...thread,\n            id: thread.thread_id\n        },\n        posts: formattedPosts,\n        lang: thread.language // スレッドの言語\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q1EsZUFBZVYsS0FBS2pCLFFBQVE7WUFDNUI0QixlQUFlLEtBQUssY0FBYztRQUNwQztJQUVBLE9BQU87UUFDTHJCLFFBQVE7WUFDTixHQUFHQSxNQUFNO1lBQ1RXLElBQUlYLE9BQU9iLFNBQVM7UUFDdEI7UUFDQStCLE9BQU9DO1FBQ1BHLE1BQU10QixPQUFPUCxRQUFRLENBQUMsVUFBVTtJQUNsQztBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vNWNoLy4vbGliL2RhdGFTdG9yZS5qcz81ZDFmIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiDjgrXjg7zjg5Djg7zjgrXjgqTjg4njgaflhbHmnInjgZnjgovjg4fjg7zjgr/jgrnjg4jjgqJcclxuICogTmV4dC5qc+OBrumWi+eZuuOCteODvOODkOODvOOBp0FQSeOCqOODs+ODieODneOCpOODs+ODiOmWk+OBp+ODh+ODvOOCv+OCkuWFseacieOBmeOCi+OBn+OCgeOBq+S9v+eUqFxyXG4gKi9cclxuXHJcbi8vIOOCsOODreODvOODkOODq+WkieaVsOOBqOOBl+OBpuS/neWtmOOBmeOCi+OBn+OCgeOBruODmOODq+ODkeODvFxyXG5pZiAoIWdsb2JhbC50aHJlYWRzU3RvcmUpIHtcclxuICBnbG9iYWwudGhyZWFkc1N0b3JlID0gW1xyXG4gICAge1xyXG4gICAgICB0aHJlYWRfaWQ6ICcxJyxcclxuICAgICAgdGl0bGU6ICfjgrXjg7Pjg5fjg6vjgrnjg6zjg4Pjg4kxJyxcclxuICAgICAgY3JlYXRlZF9hdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxyXG4gICAgICB1cGRhdGVkX2F0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXHJcbiAgICAgIGxhbmd1YWdlOiAnamEnXHJcbiAgICB9LFxyXG4gICAge1xyXG4gICAgICB0aHJlYWRfaWQ6ICcyJyxcclxuICAgICAgdGl0bGU6ICfjgrXjg7Pjg5fjg6vjgrnjg6zjg4Pjg4kyJyxcclxuICAgICAgY3JlYXRlZF9hdDogbmV3IERhdGUoRGF0ZS5ub3coKSAtIDg2NDAwMDAwKS50b0lTT1N0cmluZygpLFxyXG4gICAgICB1cGRhdGVkX2F0OiBuZXcgRGF0ZShEYXRlLm5vdygpIC0gMzYwMDAwMCkudG9JU09TdHJpbmcoKSxcclxuICAgICAgbGFuZ3VhZ2U6ICdqYSdcclxuICAgIH0sXHJcbiAgICB7XHJcbiAgICAgIHRocmVhZF9pZDogJzMnLFxyXG4gICAgICB0aXRsZTogJ+ODl+ODreOCsOODqeODn+ODs+OCsOOBq+OBpOOBhOOBpuOBruitsOirlicsXHJcbiAgICAgIGNyZWF0ZWRfYXQ6IG5ldyBEYXRlKERhdGUubm93KCkgLSAxNzI4MDAwMDApLnRvSVNPU3RyaW5nKCksXHJcbiAgICAgIHVwZGF0ZWRfYXQ6IG5ldyBEYXRlKERhdGUubm93KCkgLSA1NDAwMDAwKS50b0lTT1N0cmluZygpLFxyXG4gICAgICBsYW5ndWFnZTogJ2phJ1xyXG4gICAgfVxyXG4gIF07XHJcbn1cclxuXHJcbmlmICghZ2xvYmFsLnBvc3RzU3RvcmUpIHtcclxuICBnbG9iYWwucG9zdHNTdG9yZSA9IHtcclxuICAgICcxJzogW1xyXG4gICAgICB7XHJcbiAgICAgICAgcG9zdF9pZDogJzFfMScsXHJcbiAgICAgICAgdGhyZWFkX2lkOiAnMScsXHJcbiAgICAgICAgYm9keTogJ+acgOWIneOBruaKleeov+OBp+OBmScsXHJcbiAgICAgICAgYW5vbnltb3VzX2lkOiAn5Yy/5ZCNMTIzJyxcclxuICAgICAgICBjcmVhdGVkX2F0OiBuZXcgRGF0ZShEYXRlLm5vdygpIC0gMzYwMDAwMCkudG9JU09TdHJpbmcoKSxcclxuICAgICAgICBsYW5ndWFnZTogJ2phJ1xyXG4gICAgICB9LFxyXG4gICAgICB7XHJcbiAgICAgICAgcG9zdF9pZDogJzFfMicsXHJcbiAgICAgICAgdGhyZWFkX2lkOiAnMScsXHJcbiAgICAgICAgYm9keTogJ+i/lOS/oeOBp+OBmScsXHJcbiAgICAgICAgYW5vbnltb3VzX2lkOiAn5Yy/5ZCNNDU2JyxcclxuICAgICAgICBjcmVhdGVkX2F0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgbGFuZ3VhZ2U6ICdqYSdcclxuICAgICAgfVxyXG4gICAgXSxcclxuICAgICcyJzogW1xyXG4gICAgICB7XHJcbiAgICAgICAgcG9zdF9pZDogJzJfMScsXHJcbiAgICAgICAgdGhyZWFkX2lkOiAnMicsXHJcbiAgICAgICAgYm9keTogJ+WIpeOBruOCueODrOODg+ODieOBruaKleeov+OBp+OBmScsXHJcbiAgICAgICAgYW5vbnltb3VzX2lkOiAn5Yy/5ZCNNzg5JyxcclxuICAgICAgICBjcmVhdGVkX2F0OiBuZXcgRGF0ZShEYXRlLm5vdygpIC0gMjQwMDAwMCkudG9JU09TdHJpbmcoKSxcclxuICAgICAgICBsYW5ndWFnZTogJ2phJ1xyXG4gICAgICB9XHJcbiAgICBdLFxyXG4gICAgJzMnOiBbXHJcbiAgICAgIHtcclxuICAgICAgICBwb3N0X2lkOiAnM18xJyxcclxuICAgICAgICB0aHJlYWRfaWQ6ICczJyxcclxuICAgICAgICBib2R5OiAn44OX44Ot44Kw44Op44Of44Oz44Kw44Gr44Gk44GE44Gm6Kmx44GX44G+44GX44KH44GGJyxcclxuICAgICAgICBhbm9ueW1vdXNfaWQ6ICfljL/lkI0xMDEnLFxyXG4gICAgICAgIGNyZWF0ZWRfYXQ6IG5ldyBEYXRlKERhdGUubm93KCkgLSAxNzIwMDAwMDApLnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgbGFuZ3VhZ2U6ICdqYSdcclxuICAgICAgfVxyXG4gICAgXVxyXG4gIH07XHJcbn1cclxuXHJcbi8vIOOCueODrOODg+ODieODh+ODvOOCv+S/neWtmOeUqOmFjeWIl+OCkuOCqOOCr+OCueODneODvOODiFxyXG5leHBvcnQgY29uc3QgdGhyZWFkc1N0b3JlID0gZ2xvYmFsLnRocmVhZHNTdG9yZTtcclxuXHJcbi8vIOaKleeov+ODh+ODvOOCv+S/neWtmOeUqOOCquODluOCuOOCp+OCr+ODiOOCkuOCqOOCr+OCueODneODvOODiFxyXG5leHBvcnQgY29uc3QgcG9zdHNTdG9yZSA9IGdsb2JhbC5wb3N0c1N0b3JlO1xyXG5cclxuLy8g5paw44GX44GE44K544Os44OD44OJ44KS6L+95Yqg44GZ44KL44Om44O844OG44Kj44Oq44OG44Kj6Zai5pWwXHJcbmV4cG9ydCBmdW5jdGlvbiBhZGRUaHJlYWQodGhyZWFkKSB7XHJcbiAgLy8g5pei5a2Y44Gu44K544Os44OD44OJ44KS56K66KqN77yI6YeN6KSH6L+95Yqg6Ziy5q2i77yJXHJcbiAgY29uc3QgZXhpc3RpbmdUaHJlYWQgPSB0aHJlYWRzU3RvcmUuZmluZCh0ID0+IHQudGhyZWFkX2lkID09PSB0aHJlYWQudGhyZWFkX2lkKTtcclxuICBpZiAoIWV4aXN0aW5nVGhyZWFkKSB7XHJcbiAgICB0aHJlYWRzU3RvcmUucHVzaCh7Li4udGhyZWFkfSk7IC8vIOOCquODluOCuOOCp+OCr+ODiOOCkuOCs+ODlOODvOOBl+OBpui/veWKoFxyXG4gICAgY29uc29sZS5sb2coYOOCueODrOODg+ODiei/veWKoDogSUQ9JHt0aHJlYWQudGhyZWFkX2lkfSwg44K/44Kk44OI44OrPVwiJHt0aHJlYWQudGl0bGV9XCJgKTtcclxuICAgIGNvbnNvbGUubG9nKCfnj77lnKjjga7jgrnjg6zjg4Pjg4nkuIDopqc6JywgdGhyZWFkc1N0b3JlLm1hcCh0ID0+IHQudGhyZWFkX2lkKSk7XHJcbiAgfVxyXG59XHJcblxyXG4vLyDmlrDjgZfjgYTmipXnqL/jgpLov73liqDjgZnjgovjg6bjg7zjg4bjgqPjg6rjg4bjgqPplqLmlbBcclxuZXhwb3J0IGZ1bmN0aW9uIGFkZFBvc3QodGhyZWFkSWQsIHBvc3QpIHtcclxuICBpZiAoIXBvc3RzU3RvcmVbdGhyZWFkSWRdKSB7XHJcbiAgICBwb3N0c1N0b3JlW3RocmVhZElkXSA9IFtdO1xyXG4gIH1cclxuICBwb3N0c1N0b3JlW3RocmVhZElkXS5wdXNoKHtcclxuICAgIGlkOiBwb3N0LnBvc3RfaWQsXHJcbiAgICB0aHJlYWRJZCxcclxuICAgIGJvZHk6IHBvc3QuYm9keSxcclxuICAgIGxhbmd1YWdlOiBwb3N0Lmxhbmd1YWdlLFxyXG4gICAgY3JlYXRlZEF0OiBwb3N0LmNyZWF0ZWRfYXQgfHwgbmV3IERhdGUoKS50b0lTT1N0cmluZygpXHJcbiAgfSk7XHJcbiAgY29uc29sZS5sb2coYOaKleeov+i/veWKoDog44K544Os44OD44OJSUQ9JHt0aHJlYWRJZH0sIOaKleeov0lEPSR7cG9zdC5wb3N0X2lkfWApO1xyXG59XHJcblxyXG4vLyDjg4fjg5Djg4PjgrDnlKjvvJrjg4fjg7zjgr/jgrnjg4jjgqLjga7lhoXlrrnjgpLooajnpLpcclxuZXhwb3J0IGZ1bmN0aW9uIGRlYnVnRGF0YVN0b3JlKCkge1xyXG4gIGNvbnNvbGUubG9nKCc9PT09PSDjg4fjg7zjgr/jgrnjg4jjgqLlhoXlrrkgPT09PT0nKTtcclxuICBjb25zb2xlLmxvZygn44K544Os44OD44OJ5pWwOicsIHRocmVhZHNTdG9yZS5sZW5ndGgpO1xyXG4gIGNvbnNvbGUubG9nKCfjgrnjg6zjg4Pjg4lJROS4gOimpzonLCB0aHJlYWRzU3RvcmUubWFwKHQgPT4gdC50aHJlYWRfaWQpKTtcclxuICBjb25zb2xlLmxvZygn5oqV56i/5pWwOicsIE9iamVjdC5rZXlzKHBvc3RzU3RvcmUpLmxlbmd0aCk7XHJcbiAgY29uc29sZS5sb2coJz09PT09PT09PT09PT09PT09PT09PT09PT09Jyk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiDjgrnjg6zjg4Pjg4njgajmipXnqL/jgpLkuIDluqbjgavlj5blvpdcclxuICogQHBhcmFtIHtzdHJpbmd9IHRocmVhZElkIC0g44K544Os44OD44OJSURcclxuICogQHJldHVybnMge29iamVjdHxudWxsfSDjgrnjg6zjg4Pjg4njgajmipXnqL/jga7mg4XloLHjgIHopovjgaTjgYvjgonjgarjgYTloLTlkIjjga9udWxsXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZ2V0VGhyZWFkV2l0aFBvc3RzKHRocmVhZElkKSB7XHJcbiAgLy8g44K544Os44OD44OJ44KS44Oh44Oi44Oq44GL44KJ5Y+W5b6XXHJcbiAgY29uc3QgdGhyZWFkID0gdGhyZWFkc1N0b3JlLmZpbmQodCA9PiB0LnRocmVhZF9pZCA9PT0gdGhyZWFkSWQpO1xyXG4gIFxyXG4gIGlmICghdGhyZWFkKSB7XHJcbiAgICBjb25zb2xlLmxvZyhg44K544Os44OD44OJ5pyq55m66KaLOiBJRD0ke3RocmVhZElkfWApO1xyXG4gICAgcmV0dXJuIG51bGw7XHJcbiAgfVxyXG4gIFxyXG4gIC8vIOaKleeov+OCkuODoeODouODquOBi+OCieWPluW+l1xyXG4gIGNvbnN0IHBvc3RzID0gcG9zdHNTdG9yZVt0aHJlYWRJZF0gfHwgW107XHJcbiAgXHJcbiAgLy8g5oqV56i/44OH44O844K/44KS5pW05b2iXHJcbiAgY29uc3QgZm9ybWF0dGVkUG9zdHMgPSBwb3N0cy5tYXAocG9zdCA9PiAoe1xyXG4gICAgaWQ6IHBvc3QucG9zdF9pZCB8fCBwb3N0LmlkLFxyXG4gICAgYm9keTogcG9zdC5ib2R5LFxyXG4gICAgYW5vbnltb3VzX2lkOiBwb3N0LmFub255bW91c19pZCxcclxuICAgIHRocmVhZF9pZDogcG9zdC50aHJlYWRfaWQsXHJcbiAgICBjcmVhdGVkX2F0OiBwb3N0LmNyZWF0ZWRfYXQgfHwgcG9zdC5jcmVhdGVkQXQsXHJcbiAgICBvcmlnaW5hbF9sYW5nOiBwb3N0Lmxhbmd1YWdlLCAvLyDlhYPjga7oqIDoqp7jgpLkv53mjIFcclxuICAgIHRyYW5zbGF0ZWRfdG86IG51bGwgLy8g57+76Kiz5YWI6KiA6Kqe77yI5b6M44Gn6Kit5a6a77yJXHJcbiAgfSkpO1xyXG4gIFxyXG4gIHJldHVybiB7XHJcbiAgICB0aHJlYWQ6IHtcclxuICAgICAgLi4udGhyZWFkLFxyXG4gICAgICBpZDogdGhyZWFkLnRocmVhZF9pZFxyXG4gICAgfSxcclxuICAgIHBvc3RzOiBmb3JtYXR0ZWRQb3N0cyxcclxuICAgIGxhbmc6IHRocmVhZC5sYW5ndWFnZSAvLyDjgrnjg6zjg4Pjg4njga7oqIDoqp5cclxuICB9O1xyXG59ICJdLCJuYW1lcyI6WyJnbG9iYWwiLCJ0aHJlYWRzU3RvcmUiLCJ0aHJlYWRfaWQiLCJ0aXRsZSIsImNyZWF0ZWRfYXQiLCJEYXRlIiwidG9JU09TdHJpbmciLCJ1cGRhdGVkX2F0IiwibGFuZ3VhZ2UiLCJub3ciLCJwb3N0c1N0b3JlIiwicG9zdF9pZCIsImJvZHkiLCJhbm9ueW1vdXNfaWQiLCJhZGRUaHJlYWQiLCJ0aHJlYWQiLCJleGlzdGluZ1RocmVhZCIsImZpbmQiLCJ0IiwicHVzaCIsImNvbnNvbGUiLCJsb2ciLCJtYXAiLCJhZGRQb3N0IiwidGhyZWFkSWQiLCJwb3N0IiwiaWQiLCJjcmVhdGVkQXQiLCJkZWJ1Z0RhdGFTdG9yZSIsImxlbmd0aCIsIk9iamVjdCIsImtleXMiLCJnZXRUaHJlYWRXaXRoUG9zdHMiLCJwb3N0cyIsImZvcm1hdHRlZFBvc3RzIiwib3JpZ2luYWxfbGFuZyIsInRyYW5zbGF0ZWRfdG8iLCJsYW5nIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./lib/dataStore.js\n");

/***/ }),

/***/ "(api)/./lib/deepl.js":
/*!**********************!*\
  !*** ./lib/deepl.js ***!
  \**********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ deepl)\n/* harmony export */ });\n/**\r\n * DeepL API を呼び出し、翻訳済みテキストを返します。\r\n * 必ず .env.local に DEEPL_API_KEY=xxxxxxxx を設定してください。\r\n * @param {string} text        翻訳したい原文\r\n * @param {string} targetLang  例: 'EN', 'JA' など（大文字2文字）\r\n * @param {string} sourceLang  任意：原文言語 例:'JA'（空なら自動判定）\r\n * @returns {Promise<string>}  翻訳後テキスト（失敗時は原文を返す）\r\n */ async function deepl(text, targetLang, sourceLang = \"\") {\n    try {\n        if (!text || text.trim() === \"\") {\n            console.log(\"空のテキストが渡されました。原文を返します。\");\n            return text;\n        }\n        const apiKey = \"3b6926d8-d7fe-0ab5-a139-58078d395af5:fx\";\n        if (!apiKey) {\n            console.error(\"DeepL API キーが設定されていません。環境変数 DEEPL_API_KEY を確認してください。\");\n            return text;\n        }\n        // 言語コードの正規化\n        const normalizedTargetLang = targetLang.toUpperCase();\n        const normalizedSourceLang = sourceLang ? sourceLang.toUpperCase() : \"\";\n        // 同じ言語の場合は翻訳せずに返す\n        if (normalizedSourceLang && normalizedSourceLang === normalizedTargetLang) {\n            console.log(`同じ言語 (${normalizedSourceLang}) なので翻訳をスキップします。`);\n            return text;\n        }\n        // 辞書による簡易翻訳チェック (短い単語の場合)\n        if (text.length < 10) {\n            const simpleDictionary = {\n                \"犬\": {\n                    EN: \"dog\",\n                    JA: \"犬\"\n                },\n                \"猫\": {\n                    EN: \"cat\",\n                    JA: \"猫\"\n                },\n                \"dog\": {\n                    EN: \"dog\",\n                    JA: \"犬\"\n                },\n                \"cat\": {\n                    EN: \"cat\",\n                    JA: \"猫\"\n                }\n            };\n            const dictEntry = simpleDictionary[text.trim()];\n            if (dictEntry && dictEntry[normalizedTargetLang]) {\n                console.log(`辞書による翻訳: ${text} → ${dictEntry[normalizedTargetLang]}`);\n                return dictEntry[normalizedTargetLang];\n            }\n        }\n        // リクエストパラメータ\n        const params = new URLSearchParams();\n        params.append(\"auth_key\", apiKey);\n        params.append(\"text\", text);\n        params.append(\"target_lang\", normalizedTargetLang);\n        // ソース言語が指定されている場合のみ追加\n        // 重要: 同じ言語間の翻訳を避けるため、ソース言語を明示的に設定\n        if (normalizedSourceLang) {\n            params.append(\"source_lang\", normalizedSourceLang);\n        }\n        // 翻訳文のフォーマット保持設定（日本語→英語の場合は保持しない）\n        const isJaToEn = normalizedSourceLang === \"JA\" && normalizedTargetLang === \"EN\" || !normalizedSourceLang && /[\\u3040-\\u30FF\\u4E00-\\u9FFF]/.test(text) && normalizedTargetLang === \"EN\";\n        if (!isJaToEn) {\n            params.append(\"preserve_formatting\", \"1\");\n        }\n        // リクエスト送信\n        console.log(`DeepL API リクエスト: ${normalizedSourceLang || \"自動検出\"} → ${normalizedTargetLang} \"${text.slice(0, 30)}...\"`);\n        const response = await fetch(\"https://api-free.deepl.com/v2/translate\", {\n            method: \"POST\",\n            headers: {\n                \"Content-Type\": \"application/x-www-form-urlencoded\",\n                \"User-Agent\": \"5ch-board/1.0\"\n            },\n            body: params\n        });\n        // レスポンスチェック\n        if (!response.ok) {\n            const errorText = await response.text().catch(()=>\"\");\n            throw new Error(`DeepL API エラー: ${response.status} ${response.statusText} ${errorText}`);\n        }\n        // レスポンス解析\n        const data = await response.json();\n        if (!data.translations || data.translations.length === 0) {\n            console.warn(\"DeepL API: 翻訳結果が空です。\", {\n                text,\n                targetLang\n            });\n            return text;\n        }\n        const translatedText = data.translations[0].text;\n        const detectedSourceLang = data.translations[0].detected_source_language;\n        // 翻訳結果の検証 - 入力と出力が同じで言語が異なる場合はおかしい\n        if (translatedText.trim() === text.trim() && detectedSourceLang && normalizedTargetLang !== detectedSourceLang) {\n            console.warn(\"翻訳結果が元のテキストと同じです。2回目の試行を行います。\", {\n                detected: detectedSourceLang,\n                target: normalizedTargetLang\n            });\n            // 2回目の試行 - ソース言語を明示的に設定して再試行\n            const retryParams = new URLSearchParams();\n            retryParams.append(\"auth_key\", apiKey);\n            retryParams.append(\"text\", text);\n            retryParams.append(\"target_lang\", normalizedTargetLang);\n            retryParams.append(\"source_lang\", detectedSourceLang);\n            retryParams.append(\"preserve_formatting\", \"0\"); // フォーマット保持しない\n            const retryResponse = await fetch(\"https://api-free.deepl.com/v2/translate\", {\n                method: \"POST\",\n                headers: {\n                    \"Content-Type\": \"application/x-www-form-urlencoded\"\n                },\n                body: retryParams\n            });\n            if (retryResponse.ok) {\n                const retryData = await retryResponse.json();\n                if (retryData.translations && retryData.translations.length > 0) {\n                    const retryText = retryData.translations[0].text;\n                    if (retryText.trim() !== text.trim()) {\n                        console.log(`再試行成功: \"${text.slice(0, 20)}...\" → \"${retryText.slice(0, 20)}...\"`);\n                        return retryText;\n                    }\n                }\n            }\n            // 万が一それでも同じなら、簡易翻訳を試す（特定の単語のみ）\n            if (/^[a-zA-Z\\s]+$/.test(text) && normalizedTargetLang === \"JA\") {\n                // 英語→日本語の簡易辞書\n                const enToJa = {\n                    \"dog\": \"犬\",\n                    \"cat\": \"猫\",\n                    \"hello\": \"こんにちは\",\n                    \"good morning\": \"おはようございます\",\n                    \"thank you\": \"ありがとう\",\n                    \"yes\": \"はい\",\n                    \"no\": \"いいえ\"\n                };\n                const lowerText = text.toLowerCase().trim();\n                if (enToJa[lowerText]) {\n                    console.log(`簡易辞書翻訳: ${text} → ${enToJa[lowerText]}`);\n                    return enToJa[lowerText];\n                }\n            } else if (/[\\u3040-\\u30FF\\u4E00-\\u9FFF]/.test(text) && normalizedTargetLang === \"EN\") {\n                // 日本語→英語の簡易辞書\n                const jaToEn = {\n                    \"犬\": \"dog\",\n                    \"猫\": \"cat\",\n                    \"こんにちは\": \"hello\",\n                    \"おはようございます\": \"good morning\",\n                    \"ありがとう\": \"thank you\",\n                    \"はい\": \"yes\",\n                    \"いいえ\": \"no\"\n                };\n                if (jaToEn[text.trim()]) {\n                    console.log(`簡易辞書翻訳: ${text} → ${jaToEn[text.trim()]}`);\n                    return jaToEn[text.trim()];\n                }\n            }\n        }\n        // デバッグログ\n        console.log(`DeepL翻訳: ${detectedSourceLang} → ${normalizedTargetLang}`, text.slice(0, 20), \"→\", translatedText.slice(0, 20));\n        return translatedText;\n    } catch (err) {\n        console.error(\"[deepl] 翻訳エラー:\", err.message, {\n            text: text.slice(0, 50),\n            targetLang\n        });\n        // ネットワークエラーの場合はフラグを立てて、後でリトライできるようにする\n        if (err.name === \"TypeError\" || err.name === \"NetworkError\" || err.message.includes(\"network\")) {\n            console.error(\"[deepl] ネットワークエラーが発生しました。後でリトライします。\");\n        }\n        return text; // 失敗した場合は原文を返す\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9saWIvZGVlcGwuanMiLCJtYXBwaW5ncyI6Ijs7OztBQUFBOzs7Ozs7O0NBT0MsR0FDYyxlQUFlQSxNQUFNQyxJQUFJLEVBQUVDLFVBQVUsRUFBRUMsYUFBYSxFQUFFO0lBQ25FLElBQUk7UUFDRixJQUFJLENBQUNGLFFBQVFBLEtBQUtHLElBQUksT0FBTyxJQUFJO1lBQy9CQyxRQUFRQyxHQUFHLENBQUM7WUFDWixPQUFPTDtRQUNUO1FBRUEsTUFBTU0sU0FBU0MseUNBQXlCO1FBQ3hDLElBQUksQ0FBQ0QsUUFBUTtZQUNYRixRQUFRTSxLQUFLLENBQUM7WUFDZCxPQUFPVjtRQUNUO1FBRUEsWUFBWTtRQUNaLE1BQU1XLHVCQUF1QlYsV0FBV1csV0FBVztRQUNuRCxNQUFNQyx1QkFBdUJYLGFBQWFBLFdBQVdVLFdBQVcsS0FBSztRQUVyRSxrQkFBa0I7UUFDbEIsSUFBSUMsd0JBQXdCQSx5QkFBeUJGLHNCQUFzQjtZQUN6RVAsUUFBUUMsR0FBRyxDQUFDLENBQUMsTUFBTSxFQUFFUSxxQkFBcUIsZ0JBQWdCLENBQUM7WUFDM0QsT0FBT2I7UUFDVDtRQUVBLDBCQUEwQjtRQUMxQixJQUFJQSxLQUFLYyxNQUFNLEdBQUcsSUFBSTtZQUNwQixNQUFNQyxtQkFBbUI7Z0JBQ3ZCLEtBQUs7b0JBQUVDLElBQUk7b0JBQU9DLElBQUk7Z0JBQUk7Z0JBQzFCLEtBQUs7b0JBQUVELElBQUk7b0JBQU9DLElBQUk7Z0JBQUk7Z0JBQzFCLE9BQU87b0JBQUVELElBQUk7b0JBQU9DLElBQUk7Z0JBQUk7Z0JBQzVCLE9BQU87b0JBQUVELElBQUk7b0JBQU9DLElBQUk7Z0JBQUk7WUFDOUI7WUFFQSxNQUFNQyxZQUFZSCxnQkFBZ0IsQ0FBQ2YsS0FBS0csSUFBSSxHQUFHO1lBQy9DLElBQUllLGFBQWFBLFNBQVMsQ0FBQ1AscUJBQXFCLEVBQUU7Z0JBQ2hEUCxRQUFRQyxHQUFHLENBQUMsQ0FBQyxTQUFTLEVBQUVMLEtBQUssR0FBRyxFQUFFa0IsU0FBUyxDQUFDUCxxQkFBcUIsQ0FBQyxDQUFDO2dCQUNuRSxPQUFPTyxTQUFTLENBQUNQLHFCQUFxQjtZQUN4QztRQUNGO1FBRUEsYUFBYTtRQUNiLE1BQU1RLFNBQVMsSUFBSUM7UUFDbkJELE9BQU9FLE1BQU0sQ0FBQyxZQUFZZjtRQUMxQmEsT0FBT0UsTUFBTSxDQUFDLFFBQVFyQjtRQUN0Qm1CLE9BQU9FLE1BQU0sQ0FBQyxlQUFlVjtRQUU3QixzQkFBc0I7UUFDdEIsa0NBQWtDO1FBQ2xDLElBQUlFLHNCQUFzQjtZQUN4Qk0sT0FBT0UsTUFBTSxDQUFDLGVBQWVSO1FBQy9CO1FBRUEsa0NBQWtDO1FBQ2xDLE1BQU1TLFdBQVcseUJBQTBCLFFBQVFYLHlCQUF5QixRQUMxRCxDQUFDRSx3QkFBd0IsK0JBQStCVSxJQUFJLENBQUN2QixTQUFTVyx5QkFBeUI7UUFFakgsSUFBSSxDQUFDVyxVQUFVO1lBQ2JILE9BQU9FLE1BQU0sQ0FBQyx1QkFBdUI7UUFDdkM7UUFFQSxVQUFVO1FBQ1ZqQixRQUFRQyxHQUFHLENBQUMsQ0FBQyxpQkFBaUIsRUFBRVEsd0JBQXdCLE9BQU8sR0FBRyxFQUFFRixxQkFBcUIsRUFBRSxFQUFFWCxLQUFLd0IsS0FBSyxDQUFDLEdBQUcsSUFBSSxJQUFJLENBQUM7UUFFcEgsTUFBTUMsV0FBVyxNQUFNQyxNQUFNLDJDQUEyQztZQUN0RUMsUUFBUTtZQUNSQyxTQUFTO2dCQUNQLGdCQUFnQjtnQkFDaEIsY0FBYztZQUNoQjtZQUNBQyxNQUFNVjtRQUNSO1FBRUEsWUFBWTtRQUNaLElBQUksQ0FBQ00sU0FBU0ssRUFBRSxFQUFFO1lBQ2hCLE1BQU1DLFlBQVksTUFBTU4sU0FBU3pCLElBQUksR0FBR2dDLEtBQUssQ0FBQyxJQUFNO1lBQ3BELE1BQU0sSUFBSUMsTUFBTSxDQUFDLGVBQWUsRUFBRVIsU0FBU1MsTUFBTSxDQUFDLENBQUMsRUFBRVQsU0FBU1UsVUFBVSxDQUFDLENBQUMsRUFBRUosVUFBVSxDQUFDO1FBQ3pGO1FBRUEsVUFBVTtRQUNWLE1BQU1LLE9BQU8sTUFBTVgsU0FBU1ksSUFBSTtRQUVoQyxJQUFJLENBQUNELEtBQUtFLFlBQVksSUFBSUYsS0FBS0UsWUFBWSxDQUFDeEIsTUFBTSxLQUFLLEdBQUc7WUFDeERWLFFBQVFtQyxJQUFJLENBQUMsd0JBQXdCO2dCQUFFdkM7Z0JBQU1DO1lBQVc7WUFDeEQsT0FBT0Q7UUFDVDtRQUVBLE1BQU13QyxpQkFBaUJKLEtBQUtFLFlBQVksQ0FBQyxFQUFFLENBQUN0QyxJQUFJO1FBQ2hELE1BQU15QyxxQkFBcUJMLEtBQUtFLFlBQVksQ0FBQyxFQUFFLENBQUNJLHdCQUF3QjtRQUV4RSxtQ0FBbUM7UUFDbkMsSUFBSUYsZUFBZXJDLElBQUksT0FBT0gsS0FBS0csSUFBSSxNQUNuQ3NDLHNCQUFzQjlCLHlCQUF5QjhCLG9CQUFvQjtZQUNyRXJDLFFBQVFtQyxJQUFJLENBQUMsaUNBQ0Q7Z0JBQUVJLFVBQVVGO2dCQUFvQkcsUUFBUWpDO1lBQXFCO1lBRXpFLDZCQUE2QjtZQUM3QixNQUFNa0MsY0FBYyxJQUFJekI7WUFDeEJ5QixZQUFZeEIsTUFBTSxDQUFDLFlBQVlmO1lBQy9CdUMsWUFBWXhCLE1BQU0sQ0FBQyxRQUFRckI7WUFDM0I2QyxZQUFZeEIsTUFBTSxDQUFDLGVBQWVWO1lBQ2xDa0MsWUFBWXhCLE1BQU0sQ0FBQyxlQUFlb0I7WUFDbENJLFlBQVl4QixNQUFNLENBQUMsdUJBQXVCLE1BQU0sY0FBYztZQUU5RCxNQUFNeUIsZ0JBQWdCLE1BQU1wQixNQUFNLDJDQUEyQztnQkFDM0VDLFFBQVE7Z0JBQ1JDLFNBQVM7b0JBQUUsZ0JBQWdCO2dCQUFvQztnQkFDL0RDLE1BQU1nQjtZQUNSO1lBRUEsSUFBSUMsY0FBY2hCLEVBQUUsRUFBRTtnQkFDcEIsTUFBTWlCLFlBQVksTUFBTUQsY0FBY1QsSUFBSTtnQkFDMUMsSUFBSVUsVUFBVVQsWUFBWSxJQUFJUyxVQUFVVCxZQUFZLENBQUN4QixNQUFNLEdBQUcsR0FBRztvQkFDL0QsTUFBTWtDLFlBQVlELFVBQVVULFlBQVksQ0FBQyxFQUFFLENBQUN0QyxJQUFJO29CQUNoRCxJQUFJZ0QsVUFBVTdDLElBQUksT0FBT0gsS0FBS0csSUFBSSxJQUFJO3dCQUNwQ0MsUUFBUUMsR0FBRyxDQUFDLENBQUMsUUFBUSxFQUFFTCxLQUFLd0IsS0FBSyxDQUFDLEdBQUcsSUFBSSxRQUFRLEVBQUV3QixVQUFVeEIsS0FBSyxDQUFDLEdBQUcsSUFBSSxJQUFJLENBQUM7d0JBQy9FLE9BQU93QjtvQkFDVDtnQkFDRjtZQUNGO1lBRUEsK0JBQStCO1lBQy9CLElBQUksZ0JBQWdCekIsSUFBSSxDQUFDdkIsU0FBU1cseUJBQXlCLE1BQU07Z0JBQy9ELGNBQWM7Z0JBQ2QsTUFBTXNDLFNBQVM7b0JBQ2IsT0FBTztvQkFDUCxPQUFPO29CQUNQLFNBQVM7b0JBQ1QsZ0JBQWdCO29CQUNoQixhQUFhO29CQUNiLE9BQU87b0JBQ1AsTUFBTTtnQkFDUjtnQkFDQSxNQUFNQyxZQUFZbEQsS0FBS21ELFdBQVcsR0FBR2hELElBQUk7Z0JBQ3pDLElBQUk4QyxNQUFNLENBQUNDLFVBQVUsRUFBRTtvQkFDckI5QyxRQUFRQyxHQUFHLENBQUMsQ0FBQyxRQUFRLEVBQUVMLEtBQUssR0FBRyxFQUFFaUQsTUFBTSxDQUFDQyxVQUFVLENBQUMsQ0FBQztvQkFDcEQsT0FBT0QsTUFBTSxDQUFDQyxVQUFVO2dCQUMxQjtZQUNGLE9BQU8sSUFBSSwrQkFBK0IzQixJQUFJLENBQUN2QixTQUFTVyx5QkFBeUIsTUFBTTtnQkFDckYsY0FBYztnQkFDZCxNQUFNeUMsU0FBUztvQkFDYixLQUFLO29CQUNMLEtBQUs7b0JBQ0wsU0FBUztvQkFDVCxhQUFhO29CQUNiLFNBQVM7b0JBQ1QsTUFBTTtvQkFDTixPQUFPO2dCQUNUO2dCQUNBLElBQUlBLE1BQU0sQ0FBQ3BELEtBQUtHLElBQUksR0FBRyxFQUFFO29CQUN2QkMsUUFBUUMsR0FBRyxDQUFDLENBQUMsUUFBUSxFQUFFTCxLQUFLLEdBQUcsRUFBRW9ELE1BQU0sQ0FBQ3BELEtBQUtHLElBQUksR0FBRyxDQUFDLENBQUM7b0JBQ3RELE9BQU9pRCxNQUFNLENBQUNwRCxLQUFLRyxJQUFJLEdBQUc7Z0JBQzVCO1lBQ0Y7UUFDRjtRQUVBLFNBQVM7UUFDVEMsUUFBUUMsR0FBRyxDQUFDLENBQUMsU0FBUyxFQUFFb0MsbUJBQW1CLEdBQUcsRUFBRTlCLHFCQUFxQixDQUFDLEVBQ3BFWCxLQUFLd0IsS0FBSyxDQUFDLEdBQUcsS0FBSyxLQUFLZ0IsZUFBZWhCLEtBQUssQ0FBQyxHQUFHO1FBRWxELE9BQU9nQjtJQUNULEVBQUUsT0FBT2EsS0FBSztRQUNaakQsUUFBUU0sS0FBSyxDQUFDLGtCQUFrQjJDLElBQUlDLE9BQU8sRUFBRTtZQUFFdEQsTUFBTUEsS0FBS3dCLEtBQUssQ0FBQyxHQUFHO1lBQUt2QjtRQUFXO1FBRW5GLHNDQUFzQztRQUN0QyxJQUFJb0QsSUFBSUUsSUFBSSxLQUFLLGVBQWVGLElBQUlFLElBQUksS0FBSyxrQkFBa0JGLElBQUlDLE9BQU8sQ0FBQ0UsUUFBUSxDQUFDLFlBQVk7WUFDOUZwRCxRQUFRTSxLQUFLLENBQUM7UUFDaEI7UUFFQSxPQUFPVixNQUFNLGVBQWU7SUFDOUI7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovLzVjaC8uL2xpYi9kZWVwbC5qcz9jNzc2Il0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBEZWVwTCBBUEkg44KS5ZG844Gz5Ye644GX44CB57+76Kiz5riI44G/44OG44Kt44K544OI44KS6L+U44GX44G+44GZ44CCXHJcbiAqIOW/heOBmiAuZW52LmxvY2FsIOOBqyBERUVQTF9BUElfS0VZPXh4eHh4eHh4IOOCkuioreWumuOBl+OBpuOBj+OBoOOBleOBhOOAglxyXG4gKiBAcGFyYW0ge3N0cmluZ30gdGV4dCAgICAgICAg57+76Kiz44GX44Gf44GE5Y6f5paHXHJcbiAqIEBwYXJhbSB7c3RyaW5nfSB0YXJnZXRMYW5nICDkvos6ICdFTicsICdKQScg44Gq44Gp77yI5aSn5paH5a2XMuaWh+Wtl++8iVxyXG4gKiBAcGFyYW0ge3N0cmluZ30gc291cmNlTGFuZyAg5Lu75oSP77ya5Y6f5paH6KiA6KqeIOS+izonSkEn77yI56m644Gq44KJ6Ieq5YuV5Yik5a6a77yJXHJcbiAqIEByZXR1cm5zIHtQcm9taXNlPHN0cmluZz59ICDnv7voqLPlvozjg4bjgq3jgrnjg4jvvIjlpLHmlZfmmYLjga/ljp/mlofjgpLov5TjgZnvvIlcclxuICovXHJcbmV4cG9ydCBkZWZhdWx0IGFzeW5jIGZ1bmN0aW9uIGRlZXBsKHRleHQsIHRhcmdldExhbmcsIHNvdXJjZUxhbmcgPSAnJykge1xyXG4gIHRyeSB7XHJcbiAgICBpZiAoIXRleHQgfHwgdGV4dC50cmltKCkgPT09ICcnKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKCfnqbrjga7jg4bjgq3jgrnjg4jjgYzmuKHjgZXjgozjgb7jgZfjgZ/jgILljp/mlofjgpLov5TjgZfjgb7jgZnjgIInKTtcclxuICAgICAgcmV0dXJuIHRleHQ7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgYXBpS2V5ID0gcHJvY2Vzcy5lbnYuREVFUExfQVBJX0tFWTtcclxuICAgIGlmICghYXBpS2V5KSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0RlZXBMIEFQSSDjgq3jg7zjgYzoqK3lrprjgZXjgozjgabjgYTjgb7jgZvjgpPjgILnkrDlooPlpInmlbAgREVFUExfQVBJX0tFWSDjgpLnorroqo3jgZfjgabjgY/jgaDjgZXjgYTjgIInKTtcclxuICAgICAgcmV0dXJuIHRleHQ7XHJcbiAgICB9XHJcblxyXG4gICAgLy8g6KiA6Kqe44Kz44O844OJ44Gu5q2j6KaP5YyWXHJcbiAgICBjb25zdCBub3JtYWxpemVkVGFyZ2V0TGFuZyA9IHRhcmdldExhbmcudG9VcHBlckNhc2UoKTtcclxuICAgIGNvbnN0IG5vcm1hbGl6ZWRTb3VyY2VMYW5nID0gc291cmNlTGFuZyA/IHNvdXJjZUxhbmcudG9VcHBlckNhc2UoKSA6ICcnO1xyXG5cclxuICAgIC8vIOWQjOOBmOiogOiqnuOBruWgtOWQiOOBr+e/u+ios+OBm+OBmuOBq+i/lOOBmVxyXG4gICAgaWYgKG5vcm1hbGl6ZWRTb3VyY2VMYW5nICYmIG5vcm1hbGl6ZWRTb3VyY2VMYW5nID09PSBub3JtYWxpemVkVGFyZ2V0TGFuZykge1xyXG4gICAgICBjb25zb2xlLmxvZyhg5ZCM44GY6KiA6KqeICgke25vcm1hbGl6ZWRTb3VyY2VMYW5nfSkg44Gq44Gu44Gn57+76Kiz44KS44K544Kt44OD44OX44GX44G+44GZ44CCYCk7XHJcbiAgICAgIHJldHVybiB0ZXh0O1xyXG4gICAgfVxyXG5cclxuICAgIC8vIOi+nuabuOOBq+OCiOOCi+ewoeaYk+e/u+ios+ODgeOCp+ODg+OCryAo55+t44GE5Y2Y6Kqe44Gu5aC05ZCIKVxyXG4gICAgaWYgKHRleHQubGVuZ3RoIDwgMTApIHtcclxuICAgICAgY29uc3Qgc2ltcGxlRGljdGlvbmFyeSA9IHtcclxuICAgICAgICAn54qsJzogeyBFTjogJ2RvZycsIEpBOiAn54qsJyB9LFxyXG4gICAgICAgICfnjKsnOiB7IEVOOiAnY2F0JywgSkE6ICfnjKsnIH0sXHJcbiAgICAgICAgJ2RvZyc6IHsgRU46ICdkb2cnLCBKQTogJ+eKrCcgfSxcclxuICAgICAgICAnY2F0JzogeyBFTjogJ2NhdCcsIEpBOiAn54yrJyB9LFxyXG4gICAgICB9O1xyXG4gICAgICBcclxuICAgICAgY29uc3QgZGljdEVudHJ5ID0gc2ltcGxlRGljdGlvbmFyeVt0ZXh0LnRyaW0oKV07XHJcbiAgICAgIGlmIChkaWN0RW50cnkgJiYgZGljdEVudHJ5W25vcm1hbGl6ZWRUYXJnZXRMYW5nXSkge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGDovp7mm7jjgavjgojjgovnv7voqLM6ICR7dGV4dH0g4oaSICR7ZGljdEVudHJ5W25vcm1hbGl6ZWRUYXJnZXRMYW5nXX1gKTtcclxuICAgICAgICByZXR1cm4gZGljdEVudHJ5W25vcm1hbGl6ZWRUYXJnZXRMYW5nXTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIOODquOCr+OCqOOCueODiOODkeODqeODoeODvOOCv1xyXG4gICAgY29uc3QgcGFyYW1zID0gbmV3IFVSTFNlYXJjaFBhcmFtcygpO1xyXG4gICAgcGFyYW1zLmFwcGVuZCgnYXV0aF9rZXknLCBhcGlLZXkpO1xyXG4gICAgcGFyYW1zLmFwcGVuZCgndGV4dCcsIHRleHQpO1xyXG4gICAgcGFyYW1zLmFwcGVuZCgndGFyZ2V0X2xhbmcnLCBub3JtYWxpemVkVGFyZ2V0TGFuZyk7XHJcbiAgICBcclxuICAgIC8vIOOCveODvOOCueiogOiqnuOBjOaMh+WumuOBleOCjOOBpuOBhOOCi+WgtOWQiOOBruOBv+i/veWKoFxyXG4gICAgLy8g6YeN6KaBOiDlkIzjgZjoqIDoqp7plpPjga7nv7voqLPjgpLpgb/jgZHjgovjgZ/jgoHjgIHjgr3jg7zjgrnoqIDoqp7jgpLmmI7npLrnmoTjgavoqK3lrppcclxuICAgIGlmIChub3JtYWxpemVkU291cmNlTGFuZykge1xyXG4gICAgICBwYXJhbXMuYXBwZW5kKCdzb3VyY2VfbGFuZycsIG5vcm1hbGl6ZWRTb3VyY2VMYW5nKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyDnv7voqLPmlofjga7jg5Xjgqnjg7zjg57jg4Pjg4jkv53mjIHoqK3lrprvvIjml6XmnKzoqp7ihpLoi7Hoqp7jga7loLTlkIjjga/kv53mjIHjgZfjgarjgYTvvIlcclxuICAgIGNvbnN0IGlzSmFUb0VuID0gKG5vcm1hbGl6ZWRTb3VyY2VMYW5nID09PSAnSkEnICYmIG5vcm1hbGl6ZWRUYXJnZXRMYW5nID09PSAnRU4nKSB8fCBcclxuICAgICAgICAgICAgICAgICAgICAgKCFub3JtYWxpemVkU291cmNlTGFuZyAmJiAvW1xcdTMwNDAtXFx1MzBGRlxcdTRFMDAtXFx1OUZGRl0vLnRlc3QodGV4dCkgJiYgbm9ybWFsaXplZFRhcmdldExhbmcgPT09ICdFTicpO1xyXG4gICAgXHJcbiAgICBpZiAoIWlzSmFUb0VuKSB7XHJcbiAgICAgIHBhcmFtcy5hcHBlbmQoJ3ByZXNlcnZlX2Zvcm1hdHRpbmcnLCAnMScpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIOODquOCr+OCqOOCueODiOmAgeS/oVxyXG4gICAgY29uc29sZS5sb2coYERlZXBMIEFQSSDjg6rjgq/jgqjjgrnjg4g6ICR7bm9ybWFsaXplZFNvdXJjZUxhbmcgfHwgJ+iHquWLleaknOWHuid9IOKGkiAke25vcm1hbGl6ZWRUYXJnZXRMYW5nfSBcIiR7dGV4dC5zbGljZSgwLCAzMCl9Li4uXCJgKTtcclxuICAgIFxyXG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCgnaHR0cHM6Ly9hcGktZnJlZS5kZWVwbC5jb20vdjIvdHJhbnNsYXRlJywge1xyXG4gICAgICBtZXRob2Q6ICdQT1NUJyxcclxuICAgICAgaGVhZGVyczogeyBcclxuICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCcsXHJcbiAgICAgICAgJ1VzZXItQWdlbnQnOiAnNWNoLWJvYXJkLzEuMCcsXHJcbiAgICAgIH0sXHJcbiAgICAgIGJvZHk6IHBhcmFtcyxcclxuICAgIH0pO1xyXG5cclxuICAgIC8vIOODrOOCueODneODs+OCueODgeOCp+ODg+OCr1xyXG4gICAgaWYgKCFyZXNwb25zZS5vaykge1xyXG4gICAgICBjb25zdCBlcnJvclRleHQgPSBhd2FpdCByZXNwb25zZS50ZXh0KCkuY2F0Y2goKCkgPT4gJycpO1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYERlZXBMIEFQSSDjgqjjg6njg7w6ICR7cmVzcG9uc2Uuc3RhdHVzfSAke3Jlc3BvbnNlLnN0YXR1c1RleHR9ICR7ZXJyb3JUZXh0fWApO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIOODrOOCueODneODs+OCueino+aekFxyXG4gICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcclxuICAgIFxyXG4gICAgaWYgKCFkYXRhLnRyYW5zbGF0aW9ucyB8fCBkYXRhLnRyYW5zbGF0aW9ucy5sZW5ndGggPT09IDApIHtcclxuICAgICAgY29uc29sZS53YXJuKCdEZWVwTCBBUEk6IOe/u+ios+e1kOaenOOBjOepuuOBp+OBmeOAgicsIHsgdGV4dCwgdGFyZ2V0TGFuZyB9KTtcclxuICAgICAgcmV0dXJuIHRleHQ7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGNvbnN0IHRyYW5zbGF0ZWRUZXh0ID0gZGF0YS50cmFuc2xhdGlvbnNbMF0udGV4dDtcclxuICAgIGNvbnN0IGRldGVjdGVkU291cmNlTGFuZyA9IGRhdGEudHJhbnNsYXRpb25zWzBdLmRldGVjdGVkX3NvdXJjZV9sYW5ndWFnZTtcclxuICAgIFxyXG4gICAgLy8g57+76Kiz57WQ5p6c44Gu5qSc6Ki8IC0g5YWl5Yqb44Go5Ye65Yqb44GM5ZCM44GY44Gn6KiA6Kqe44GM55Ww44Gq44KL5aC05ZCI44Gv44GK44GL44GX44GEXHJcbiAgICBpZiAodHJhbnNsYXRlZFRleHQudHJpbSgpID09PSB0ZXh0LnRyaW0oKSAmJiBcclxuICAgICAgICBkZXRlY3RlZFNvdXJjZUxhbmcgJiYgbm9ybWFsaXplZFRhcmdldExhbmcgIT09IGRldGVjdGVkU291cmNlTGFuZykge1xyXG4gICAgICBjb25zb2xlLndhcm4oJ+e/u+ios+e1kOaenOOBjOWFg+OBruODhuOCreOCueODiOOBqOWQjOOBmOOBp+OBmeOAgjLlm57nm67jga7oqabooYzjgpLooYzjgYTjgb7jgZnjgIInLCBcclxuICAgICAgICAgICAgICAgICAgeyBkZXRlY3RlZDogZGV0ZWN0ZWRTb3VyY2VMYW5nLCB0YXJnZXQ6IG5vcm1hbGl6ZWRUYXJnZXRMYW5nIH0pO1xyXG4gICAgICBcclxuICAgICAgLy8gMuWbnuebruOBruippuihjCAtIOOCveODvOOCueiogOiqnuOCkuaYjuekuueahOOBq+ioreWumuOBl+OBpuWGjeippuihjFxyXG4gICAgICBjb25zdCByZXRyeVBhcmFtcyA9IG5ldyBVUkxTZWFyY2hQYXJhbXMoKTtcclxuICAgICAgcmV0cnlQYXJhbXMuYXBwZW5kKCdhdXRoX2tleScsIGFwaUtleSk7XHJcbiAgICAgIHJldHJ5UGFyYW1zLmFwcGVuZCgndGV4dCcsIHRleHQpO1xyXG4gICAgICByZXRyeVBhcmFtcy5hcHBlbmQoJ3RhcmdldF9sYW5nJywgbm9ybWFsaXplZFRhcmdldExhbmcpO1xyXG4gICAgICByZXRyeVBhcmFtcy5hcHBlbmQoJ3NvdXJjZV9sYW5nJywgZGV0ZWN0ZWRTb3VyY2VMYW5nKTtcclxuICAgICAgcmV0cnlQYXJhbXMuYXBwZW5kKCdwcmVzZXJ2ZV9mb3JtYXR0aW5nJywgJzAnKTsgLy8g44OV44Kp44O844Oe44OD44OI5L+d5oyB44GX44Gq44GEXHJcbiAgICAgIFxyXG4gICAgICBjb25zdCByZXRyeVJlc3BvbnNlID0gYXdhaXQgZmV0Y2goJ2h0dHBzOi8vYXBpLWZyZWUuZGVlcGwuY29tL3YyL3RyYW5zbGF0ZScsIHtcclxuICAgICAgICBtZXRob2Q6ICdQT1NUJyxcclxuICAgICAgICBoZWFkZXJzOiB7ICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkJyB9LFxyXG4gICAgICAgIGJvZHk6IHJldHJ5UGFyYW1zLFxyXG4gICAgICB9KTtcclxuICAgICAgXHJcbiAgICAgIGlmIChyZXRyeVJlc3BvbnNlLm9rKSB7XHJcbiAgICAgICAgY29uc3QgcmV0cnlEYXRhID0gYXdhaXQgcmV0cnlSZXNwb25zZS5qc29uKCk7XHJcbiAgICAgICAgaWYgKHJldHJ5RGF0YS50cmFuc2xhdGlvbnMgJiYgcmV0cnlEYXRhLnRyYW5zbGF0aW9ucy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICBjb25zdCByZXRyeVRleHQgPSByZXRyeURhdGEudHJhbnNsYXRpb25zWzBdLnRleHQ7XHJcbiAgICAgICAgICBpZiAocmV0cnlUZXh0LnRyaW0oKSAhPT0gdGV4dC50cmltKCkpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coYOWGjeippuihjOaIkOWKnzogXCIke3RleHQuc2xpY2UoMCwgMjApfS4uLlwiIOKGkiBcIiR7cmV0cnlUZXh0LnNsaWNlKDAsIDIwKX0uLi5cImApO1xyXG4gICAgICAgICAgICByZXR1cm4gcmV0cnlUZXh0O1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICBcclxuICAgICAgLy8g5LiH44GM5LiA44Gd44KM44Gn44KC5ZCM44GY44Gq44KJ44CB57Ch5piT57+76Kiz44KS6Kmm44GZ77yI54m55a6a44Gu5Y2Y6Kqe44Gu44G/77yJXHJcbiAgICAgIGlmICgvXlthLXpBLVpcXHNdKyQvLnRlc3QodGV4dCkgJiYgbm9ybWFsaXplZFRhcmdldExhbmcgPT09ICdKQScpIHtcclxuICAgICAgICAvLyDoi7Hoqp7ihpLml6XmnKzoqp7jga7nsKHmmJPovp7mm7hcclxuICAgICAgICBjb25zdCBlblRvSmEgPSB7XHJcbiAgICAgICAgICAnZG9nJzogJ+eKrCcsXHJcbiAgICAgICAgICAnY2F0JzogJ+eMqycsXHJcbiAgICAgICAgICAnaGVsbG8nOiAn44GT44KT44Gr44Gh44GvJyxcclxuICAgICAgICAgICdnb29kIG1vcm5pbmcnOiAn44GK44Gv44KI44GG44GU44GW44GE44G+44GZJyxcclxuICAgICAgICAgICd0aGFuayB5b3UnOiAn44GC44KK44GM44Go44GGJyxcclxuICAgICAgICAgICd5ZXMnOiAn44Gv44GEJyxcclxuICAgICAgICAgICdubyc6ICfjgYTjgYTjgYgnXHJcbiAgICAgICAgfTtcclxuICAgICAgICBjb25zdCBsb3dlclRleHQgPSB0ZXh0LnRvTG93ZXJDYXNlKCkudHJpbSgpO1xyXG4gICAgICAgIGlmIChlblRvSmFbbG93ZXJUZXh0XSkge1xyXG4gICAgICAgICAgY29uc29sZS5sb2coYOewoeaYk+i+nuabuOe/u+ioszogJHt0ZXh0fSDihpIgJHtlblRvSmFbbG93ZXJUZXh0XX1gKTtcclxuICAgICAgICAgIHJldHVybiBlblRvSmFbbG93ZXJUZXh0XTtcclxuICAgICAgICB9XHJcbiAgICAgIH0gZWxzZSBpZiAoL1tcXHUzMDQwLVxcdTMwRkZcXHU0RTAwLVxcdTlGRkZdLy50ZXN0KHRleHQpICYmIG5vcm1hbGl6ZWRUYXJnZXRMYW5nID09PSAnRU4nKSB7XHJcbiAgICAgICAgLy8g5pel5pys6Kqe4oaS6Iux6Kqe44Gu57Ch5piT6L6e5pu4XHJcbiAgICAgICAgY29uc3QgamFUb0VuID0ge1xyXG4gICAgICAgICAgJ+eKrCc6ICdkb2cnLFxyXG4gICAgICAgICAgJ+eMqyc6ICdjYXQnLFxyXG4gICAgICAgICAgJ+OBk+OCk+OBq+OBoeOBryc6ICdoZWxsbycsXHJcbiAgICAgICAgICAn44GK44Gv44KI44GG44GU44GW44GE44G+44GZJzogJ2dvb2QgbW9ybmluZycsXHJcbiAgICAgICAgICAn44GC44KK44GM44Go44GGJzogJ3RoYW5rIHlvdScsXHJcbiAgICAgICAgICAn44Gv44GEJzogJ3llcycsXHJcbiAgICAgICAgICAn44GE44GE44GIJzogJ25vJ1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgaWYgKGphVG9Fblt0ZXh0LnRyaW0oKV0pIHtcclxuICAgICAgICAgIGNvbnNvbGUubG9nKGDnsKHmmJPovp7mm7jnv7voqLM6ICR7dGV4dH0g4oaSICR7amFUb0VuW3RleHQudHJpbSgpXX1gKTtcclxuICAgICAgICAgIHJldHVybiBqYVRvRW5bdGV4dC50cmltKCldO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyDjg4fjg5Djg4PjgrDjg63jgrBcclxuICAgIGNvbnNvbGUubG9nKGBEZWVwTOe/u+ioszogJHtkZXRlY3RlZFNvdXJjZUxhbmd9IOKGkiAke25vcm1hbGl6ZWRUYXJnZXRMYW5nfWAsIFxyXG4gICAgICB0ZXh0LnNsaWNlKDAsIDIwKSwgJ+KGkicsIHRyYW5zbGF0ZWRUZXh0LnNsaWNlKDAsIDIwKSk7XHJcbiAgICBcclxuICAgIHJldHVybiB0cmFuc2xhdGVkVGV4dDtcclxuICB9IGNhdGNoIChlcnIpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ1tkZWVwbF0g57+76Kiz44Ko44Op44O8OicsIGVyci5tZXNzYWdlLCB7IHRleHQ6IHRleHQuc2xpY2UoMCwgNTApLCB0YXJnZXRMYW5nIH0pO1xyXG4gICAgXHJcbiAgICAvLyDjg43jg4Pjg4jjg6/jg7zjgq/jgqjjg6njg7zjga7loLTlkIjjga/jg5Xjg6njgrDjgpLnq4vjgabjgabjgIHlvozjgafjg6rjg4jjg6njgqTjgafjgY3jgovjgojjgYbjgavjgZnjgotcclxuICAgIGlmIChlcnIubmFtZSA9PT0gJ1R5cGVFcnJvcicgfHwgZXJyLm5hbWUgPT09ICdOZXR3b3JrRXJyb3InIHx8IGVyci5tZXNzYWdlLmluY2x1ZGVzKCduZXR3b3JrJykpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignW2RlZXBsXSDjg43jg4Pjg4jjg6/jg7zjgq/jgqjjg6njg7zjgYznmbrnlJ/jgZfjgb7jgZfjgZ/jgILlvozjgafjg6rjg4jjg6njgqTjgZfjgb7jgZnjgIInKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgcmV0dXJuIHRleHQ7IC8vIOWkseaVl+OBl+OBn+WgtOWQiOOBr+WOn+aWh+OCkui/lOOBmVxyXG4gIH1cclxufSAiXSwibmFtZXMiOlsiZGVlcGwiLCJ0ZXh0IiwidGFyZ2V0TGFuZyIsInNvdXJjZUxhbmciLCJ0cmltIiwiY29uc29sZSIsImxvZyIsImFwaUtleSIsInByb2Nlc3MiLCJlbnYiLCJERUVQTF9BUElfS0VZIiwiZXJyb3IiLCJub3JtYWxpemVkVGFyZ2V0TGFuZyIsInRvVXBwZXJDYXNlIiwibm9ybWFsaXplZFNvdXJjZUxhbmciLCJsZW5ndGgiLCJzaW1wbGVEaWN0aW9uYXJ5IiwiRU4iLCJKQSIsImRpY3RFbnRyeSIsInBhcmFtcyIsIlVSTFNlYXJjaFBhcmFtcyIsImFwcGVuZCIsImlzSmFUb0VuIiwidGVzdCIsInNsaWNlIiwicmVzcG9uc2UiLCJmZXRjaCIsIm1ldGhvZCIsImhlYWRlcnMiLCJib2R5Iiwib2siLCJlcnJvclRleHQiLCJjYXRjaCIsIkVycm9yIiwic3RhdHVzIiwic3RhdHVzVGV4dCIsImRhdGEiLCJqc29uIiwidHJhbnNsYXRpb25zIiwid2FybiIsInRyYW5zbGF0ZWRUZXh0IiwiZGV0ZWN0ZWRTb3VyY2VMYW5nIiwiZGV0ZWN0ZWRfc291cmNlX2xhbmd1YWdlIiwiZGV0ZWN0ZWQiLCJ0YXJnZXQiLCJyZXRyeVBhcmFtcyIsInJldHJ5UmVzcG9uc2UiLCJyZXRyeURhdGEiLCJyZXRyeVRleHQiLCJlblRvSmEiLCJsb3dlclRleHQiLCJ0b0xvd2VyQ2FzZSIsImphVG9FbiIsImVyciIsIm1lc3NhZ2UiLCJuYW1lIiwiaW5jbHVkZXMiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./lib/deepl.js\n");

/***/ }),

/***/ "(api)/./lib/langUtil.js":
/*!*************************!*\
  !*** ./lib/langUtil.js ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   detectLang: () => (/* binding */ detectLang),\n/* harmony export */   dictionaryLookup: () => (/* binding */ dictionaryLookup),\n/* harmony export */   manualDict: () => (/* binding */ manualDict),\n/* harmony export */   mapLang: () => (/* binding */ mapLang),\n/* harmony export */   oppositeLang: () => (/* binding */ oppositeLang)\n/* harmony export */ });\n// ── 言語ユーティリティ ────────────────────────────────\nconst jaChar = /[\\u3000-\\u303F\\u3040-\\u309F\\u30A0-\\u30FF\\u4E00-\\u9FFF]/;\nconst detectLang = (t = \"\")=>jaChar.test(t) ? \"JA\" : \"EN\";\nconst oppositeLang = (l)=>l === \"JA\" ? \"EN\" : \"JA\";\nconst mapLang = (l = \"\")=>l.toLowerCase().startsWith(\"en\") ? \"EN\" : l.toLowerCase().startsWith(\"ja\") ? \"JA\" : l.toUpperCase();\nconst manualDict = {\n    \"犬\": \"dog\",\n    \"猫\": \"cat\",\n    \"dog\": \"犬\",\n    \"cat\": \"猫\"\n};\nconst dictionaryLookup = (text, target)=>{\n    const hit = manualDict[text.trim()];\n    if (!hit) return null;\n    return target === \"EN\" ? hit : Object.keys(manualDict).find((k)=>manualDict[k] === text.trim()) || null;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9saWIvbGFuZ1V0aWwuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBQSxnREFBZ0Q7QUFDaEQsTUFBTUEsU0FBUztBQUNSLE1BQU1DLGFBQWEsQ0FBQ0MsSUFBSSxFQUFFLEdBQU1GLE9BQU9HLElBQUksQ0FBQ0QsS0FBSyxPQUFPLEtBQU07QUFDOUQsTUFBTUUsZUFBZSxDQUFDQyxJQUFPQSxNQUFNLE9BQU8sT0FBTyxLQUFNO0FBQ3ZELE1BQU1DLFVBQVUsQ0FBQ0QsSUFBSSxFQUFFLEdBQzVCQSxFQUFFRSxXQUFXLEdBQUdDLFVBQVUsQ0FBQyxRQUFRLE9BQ2pDSCxFQUFFRSxXQUFXLEdBQUdDLFVBQVUsQ0FBQyxRQUFRLE9BQ25DSCxFQUFFSSxXQUFXLEdBQUc7QUFFYixNQUFNQyxhQUFhO0lBQ3hCLEtBQUs7SUFBUSxLQUFLO0lBQ2xCLE9BQU87SUFBTSxPQUFPO0FBQ3RCLEVBQUU7QUFFSyxNQUFNQyxtQkFBbUIsQ0FBQ0MsTUFBTUM7SUFDckMsTUFBTUMsTUFBTUosVUFBVSxDQUFDRSxLQUFLRyxJQUFJLEdBQUc7SUFDbkMsSUFBSSxDQUFDRCxLQUFLLE9BQU87SUFDakIsT0FBT0QsV0FBVyxPQUFPQyxNQUFNRSxPQUFPQyxJQUFJLENBQUNQLFlBQ3hDUSxJQUFJLENBQUNDLENBQUFBLElBQUtULFVBQVUsQ0FBQ1MsRUFBRSxLQUFLUCxLQUFLRyxJQUFJLE9BQU87QUFDakQsRUFBRSIsInNvdXJjZXMiOlsid2VicGFjazovLzVjaC8uL2xpYi9sYW5nVXRpbC5qcz9mMTM4Il0sInNvdXJjZXNDb250ZW50IjpbIi8vIOKUgOKUgCDoqIDoqp7jg6bjg7zjg4bjgqPjg6rjg4bjgqMg4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSAXHJcbmNvbnN0IGphQ2hhciA9IC9bXFx1MzAwMC1cXHUzMDNGXFx1MzA0MC1cXHUzMDlGXFx1MzBBMC1cXHUzMEZGXFx1NEUwMC1cXHU5RkZGXS87XHJcbmV4cG9ydCBjb25zdCBkZXRlY3RMYW5nID0gKHQgPSAnJykgPT4gKGphQ2hhci50ZXN0KHQpID8gJ0pBJyA6ICdFTicpO1xyXG5leHBvcnQgY29uc3Qgb3Bwb3NpdGVMYW5nID0gKGwpID0+IChsID09PSAnSkEnID8gJ0VOJyA6ICdKQScpO1xyXG5leHBvcnQgY29uc3QgbWFwTGFuZyA9IChsID0gJycpID0+XHJcbiAgbC50b0xvd2VyQ2FzZSgpLnN0YXJ0c1dpdGgoJ2VuJykgPyAnRU4nXHJcbiAgOiBsLnRvTG93ZXJDYXNlKCkuc3RhcnRzV2l0aCgnamEnKSA/ICdKQSdcclxuICA6IGwudG9VcHBlckNhc2UoKTtcclxuXHJcbmV4cG9ydCBjb25zdCBtYW51YWxEaWN0ID0ge1xyXG4gICfniqwnOiAnZG9nJywgICfnjKsnOiAnY2F0JyxcclxuICAnZG9nJzogJ+eKrCcsICAnY2F0JzogJ+eMqycsXHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgZGljdGlvbmFyeUxvb2t1cCA9ICh0ZXh0LCB0YXJnZXQpID0+IHtcclxuICBjb25zdCBoaXQgPSBtYW51YWxEaWN0W3RleHQudHJpbSgpXTtcclxuICBpZiAoIWhpdCkgcmV0dXJuIG51bGw7XHJcbiAgcmV0dXJuIHRhcmdldCA9PT0gJ0VOJyA/IGhpdCA6IE9iamVjdC5rZXlzKG1hbnVhbERpY3QpXHJcbiAgICAuZmluZChrID0+IG1hbnVhbERpY3Rba10gPT09IHRleHQudHJpbSgpKSB8fCBudWxsO1xyXG59OyAiXSwibmFtZXMiOlsiamFDaGFyIiwiZGV0ZWN0TGFuZyIsInQiLCJ0ZXN0Iiwib3Bwb3NpdGVMYW5nIiwibCIsIm1hcExhbmciLCJ0b0xvd2VyQ2FzZSIsInN0YXJ0c1dpdGgiLCJ0b1VwcGVyQ2FzZSIsIm1hbnVhbERpY3QiLCJkaWN0aW9uYXJ5TG9va3VwIiwidGV4dCIsInRhcmdldCIsImhpdCIsInRyaW0iLCJPYmplY3QiLCJrZXlzIiwiZmluZCIsImsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./lib/langUtil.js\n");

/***/ }),

/***/ "(api)/./lib/supabaseClient.js":
/*!*******************************!*\
  !*** ./lib/supabaseClient.js ***!
  \*******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   supabase: () => (/* binding */ supabase)\n/* harmony export */ });\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @supabase/supabase-js */ \"@supabase/supabase-js\");\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__);\n\nconst url = process.env.NEXT_PUBLIC_SUPABASE_URL;\nconst key = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY || process.env.SUPABASE_SERVICE_ROLE_KEY;\nconst supabase = url && key ? (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__.createClient)(url, key) // 本番・Preview では実接続\n : {\n    from: ()=>({\n            select: ()=>({\n                    eq: ()=>({\n                            single: async ()=>({\n                                    data: null,\n                                    error: null\n                                })\n                        })\n                }),\n            upsert: ()=>({\n                    select: ()=>({\n                            single: async ()=>({\n                                    data: null,\n                                    error: null\n                                })\n                        })\n                }),\n            insert: ()=>({\n                    select: ()=>({\n                            single: async ()=>({\n                                    data: null,\n                                    error: null\n                                })\n                        })\n                })\n        }),\n    channel: ()=>({\n            on: ()=>({\n                    subscribe: ()=>({\n                            unsubscribe: ()=>{}\n                        })\n                })\n        })\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9saWIvc3VwYWJhc2VDbGllbnQuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQXFEO0FBRXJELE1BQU1DLE1BQU1DLFFBQVFDLEdBQUcsQ0FBQ0Msd0JBQXdCO0FBQ2hELE1BQU1DLE1BQ0pILFFBQVFDLEdBQUcsQ0FBQ0csNkJBQTZCLElBQ3pDSixRQUFRQyxHQUFHLENBQUNJLHlCQUF5QjtBQUVoQyxNQUFNQyxXQUNYUCxPQUFPSSxNQUNITCxtRUFBWUEsQ0FBQ0MsS0FBS0ksS0FBWSxtQkFBbUI7R0FDakQ7SUFDRUksTUFBTSxJQUFPO1lBQ1hDLFFBQVEsSUFBTztvQkFBRUMsSUFBSSxJQUFPOzRCQUFFQyxRQUFRLFVBQWE7b0NBQUVDLE1BQU07b0NBQU1DLE9BQU87Z0NBQUs7d0JBQUc7Z0JBQUc7WUFDbkZDLFFBQVEsSUFBTztvQkFDYkwsUUFBUSxJQUFPOzRCQUFFRSxRQUFRLFVBQWE7b0NBQUVDLE1BQU07b0NBQU1DLE9BQU87Z0NBQUs7d0JBQUc7Z0JBQ3JFO1lBQ0FFLFFBQVEsSUFBTztvQkFBRU4sUUFBUSxJQUFPOzRCQUFFRSxRQUFRLFVBQWE7b0NBQUVDLE1BQU07b0NBQU1DLE9BQU87Z0NBQUs7d0JBQUc7Z0JBQUc7UUFDekY7SUFDQUcsU0FBUyxJQUFPO1lBQUVDLElBQUksSUFBTztvQkFBRUMsV0FBVyxJQUFPOzRCQUFFQyxhQUFhLEtBQU87d0JBQUU7Z0JBQUc7UUFBRztBQUNqRixFQUFFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vNWNoLy4vbGliL3N1cGFiYXNlQ2xpZW50LmpzPzVmMGQiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY3JlYXRlQ2xpZW50IH0gZnJvbSAnQHN1cGFiYXNlL3N1cGFiYXNlLWpzJztcclxuXHJcbmNvbnN0IHVybCA9IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTDtcclxuY29uc3Qga2V5ID1cclxuICBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19TVVBBQkFTRV9BTk9OX0tFWSB8fFxyXG4gIHByb2Nlc3MuZW52LlNVUEFCQVNFX1NFUlZJQ0VfUk9MRV9LRVk7XHJcblxyXG5leHBvcnQgY29uc3Qgc3VwYWJhc2UgPVxyXG4gIHVybCAmJiBrZXlcclxuICAgID8gY3JlYXRlQ2xpZW50KHVybCwga2V5KSAgICAgICAgLy8g5pys55Wq44O7UHJldmlldyDjgafjga/lrp/mjqXntppcclxuICAgIDogeyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g44Ot44O844Kr44Or6ZaL55m644Gn44Gv44Oi44OD44KvXHJcbiAgICAgICAgZnJvbTogKCkgPT4gKHtcclxuICAgICAgICAgIHNlbGVjdDogKCkgPT4gKHsgZXE6ICgpID0+ICh7IHNpbmdsZTogYXN5bmMgKCkgPT4gKHsgZGF0YTogbnVsbCwgZXJyb3I6IG51bGwgfSkgfSkgfSksXHJcbiAgICAgICAgICB1cHNlcnQ6ICgpID0+ICh7XHJcbiAgICAgICAgICAgIHNlbGVjdDogKCkgPT4gKHsgc2luZ2xlOiBhc3luYyAoKSA9PiAoeyBkYXRhOiBudWxsLCBlcnJvcjogbnVsbCB9KSB9KSxcclxuICAgICAgICAgIH0pLFxyXG4gICAgICAgICAgaW5zZXJ0OiAoKSA9PiAoeyBzZWxlY3Q6ICgpID0+ICh7IHNpbmdsZTogYXN5bmMgKCkgPT4gKHsgZGF0YTogbnVsbCwgZXJyb3I6IG51bGwgfSkgfSkgfSksXHJcbiAgICAgICAgfSksXHJcbiAgICAgICAgY2hhbm5lbDogKCkgPT4gKHsgb246ICgpID0+ICh7IHN1YnNjcmliZTogKCkgPT4gKHsgdW5zdWJzY3JpYmU6ICgpID0+IHt9IH0pIH0pIH0pLFxyXG4gICAgICB9OyAiXSwibmFtZXMiOlsiY3JlYXRlQ2xpZW50IiwidXJsIiwicHJvY2VzcyIsImVudiIsIk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTCIsImtleSIsIk5FWFRfUFVCTElDX1NVUEFCQVNFX0FOT05fS0VZIiwiU1VQQUJBU0VfU0VSVklDRV9ST0xFX0tFWSIsInN1cGFiYXNlIiwiZnJvbSIsInNlbGVjdCIsImVxIiwic2luZ2xlIiwiZGF0YSIsImVycm9yIiwidXBzZXJ0IiwiaW5zZXJ0IiwiY2hhbm5lbCIsIm9uIiwic3Vic2NyaWJlIiwidW5zdWJzY3JpYmUiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./lib/supabaseClient.js\n");

/***/ }),

/***/ "(api)/./lib/translation.js":
/*!****************************!*\
  !*** ./lib/translation.js ***!
  \****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ensureLangCodeFormat: () => (/* binding */ ensureLangCodeFormat),\n/* harmony export */   getTranslation: () => (/* binding */ getTranslation),\n/* harmony export */   saveTranslation: () => (/* binding */ saveTranslation),\n/* harmony export */   translateText: () => (/* binding */ translateText),\n/* harmony export */   translateWithDeepL: () => (/* binding */ translateWithDeepL)\n/* harmony export */ });\n/* harmony import */ var _deepl_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./deepl.js */ \"(api)/./lib/deepl.js\");\n/* harmony import */ var _supabaseClient_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./supabaseClient.js */ \"(api)/./lib/supabaseClient.js\");\n/* harmony import */ var _langUtil_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./langUtil.js */ \"(api)/./lib/langUtil.js\");\n/* harmony import */ var _dataStore_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./dataStore.js */ \"(api)/./lib/dataStore.js\");\n\n\n\n\n// 日本語文字を含むか簡易判定\nconst jpRegex = /[\\u3000-\\u303F\\u3040-\\u309F\\u30A0-\\u30FF\\u4E00-\\u9FFF]/;\nconst detectSourceLang = (t = \"\")=>jpRegex.test(t) ? \"JA\" : \"EN\";\n// DeepL API設定\nconst DEEPL_API_KEY = \"3b6926d8-d7fe-0ab5-a139-58078d395af5:fx\";\n/**\r\n * 言語コードを正規化する（DeepLに適した形式に変換する）\r\n * @param {string} langCode - 言語コード（ja, en, JA, EN など）\r\n * @returns {string} 正規化された言語コード（JA, ENなど）\r\n */ function ensureLangCodeFormat(langCode = \"\") {\n    if (!langCode) return \"JA\"; // デフォルト値\n    // すでに正しい形式（JA, EN）であれば、そのまま返す\n    if (langCode === \"JA\" || langCode === \"EN\") {\n        return langCode;\n    }\n    // 小文字を大文字に変換\n    return langCode.toLowerCase().startsWith(\"ja\") ? \"JA\" : langCode.toLowerCase().startsWith(\"en\") ? \"EN\" : langCode.toUpperCase(); // その他の言語コードはそのまま大文字に\n}\n/**\r\n * DeepL APIを使用してテキストを翻訳する\r\n * @param {object} params - パラメータ\r\n * @param {string|string[]} params.text - 翻訳するテキストまたはテキストの配列\r\n * @param {string} params.targetLang - ターゲット言語コード（'EN'または'JA'）\r\n * @returns {Promise<string>} - 翻訳されたテキスト\r\n */ async function translateWithDeepL({ text, targetLang }) {\n    if (!text) return \"\";\n    if (!DEEPL_API_KEY) {\n        console.error(\"DeepL API キーが設定されていません。\");\n        return Array.isArray(text) ? text[0] || \"\" : text; // APIキーがない場合は原文を返す\n    }\n    // 言語コードの正規化\n    const normalizedTargetLang = (0,_langUtil_js__WEBPACK_IMPORTED_MODULE_2__.mapLang)(targetLang);\n    // ① 前処理 ― 改行→空白・トリム・連続ピリオド整理\n    const cleaned = Array.isArray(text) ? text[0] : text;\n    const cleanedText = cleaned.replace(/\\r?\\n+/g, \" \") // 改行を半角スペースに\n    .replace(/\\.{3,}/g, \"...\") // ピリオド 3 個を超える部分は 3 個に\n    .trim();\n    if (!cleanedText) return \"\";\n    // 短いテキストの場合は辞書を使った直接翻訳を試みる\n    if (cleanedText.length < 10) {\n        const simpleDict = {\n            \"犬\": {\n                en: \"dog\",\n                ja: \"犬\"\n            },\n            \"猫\": {\n                en: \"cat\",\n                ja: \"猫\"\n            },\n            \"dog\": {\n                en: \"dog\",\n                ja: \"犬\"\n            },\n            \"cat\": {\n                en: \"cat\",\n                ja: \"猫\"\n            },\n            \"hello\": {\n                en: \"hello\",\n                ja: \"こんにちは\"\n            },\n            \"yes\": {\n                en: \"yes\",\n                ja: \"はい\"\n            },\n            \"no\": {\n                en: \"no\",\n                ja: \"いいえ\"\n            }\n        };\n        const dictKey = cleanedText.toLowerCase().trim();\n        const dictEntry = simpleDict[dictKey];\n        if (dictEntry) {\n            const targetLangCode = normalizedTargetLang.toLowerCase() === \"en\" ? \"en\" : \"ja\";\n            const translated = dictEntry[targetLangCode];\n            if (translated && translated !== cleanedText) {\n                console.log(`辞書翻訳: \"${cleanedText}\" → \"${translated}\"`);\n                return translated;\n            }\n        }\n    }\n    try {\n        // ソース言語を検出（日本語文字が含まれるかどうか）\n        const detectedSourceLang = detectSourceLang(cleanedText);\n        // 同じ言語への翻訳は避ける\n        if (detectedSourceLang.toLowerCase() === normalizedTargetLang.toLowerCase()) {\n            console.log(`同じ言語への翻訳をスキップ: ${detectedSourceLang}`);\n            return cleanedText;\n        }\n        console.log(`DeepL翻訳リクエスト: \"${cleanedText.slice(0, 20)}...\" (${detectedSourceLang} → ${normalizedTargetLang})`);\n        // DeepL API呼び出し関数（内部用）\n        async function callDeeplApi(reqText, keepFormatting = true) {\n            try {\n                // Deepl 関数を直接呼び出し\n                const results = await (0,_deepl_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(reqText, normalizedTargetLang, detectedSourceLang // ソース言語を明示的に指定\n                );\n                // 文字列として結果を返す\n                return results || reqText;\n            } catch (err) {\n                console.error(\"DeepL API 呼び出しエラー:\", err.message);\n                return reqText; // エラー時は原文を返す\n            }\n        }\n        // ① １回目の翻訳試行\n        const first = await callDeeplApi(cleanedText, true);\n        // ② 翻訳結果が原文と同じかチェック\n        if (first.trim() === cleanedText.trim()) {\n            console.log(\"翻訳結果が原文と同じです。別の方法で再試行します。\");\n            // 単語辞書で再確認\n            const dictWords = {\n                \"犬\": \"dog\",\n                \"猫\": \"cat\",\n                \"こんにちは\": \"hello\",\n                \"おはよう\": \"good morning\",\n                \"ありがとう\": \"thank you\",\n                \"dog\": \"犬\",\n                \"cat\": \"猫\",\n                \"hello\": \"こんにちは\",\n                \"good morning\": \"おはよう\",\n                \"thank you\": \"ありがとう\"\n            };\n            if (dictWords[cleanedText]) {\n                const dictResult = dictWords[cleanedText];\n                console.log(`辞書による再翻訳: \"${cleanedText}\" → \"${dictResult}\"`);\n                return dictResult;\n            }\n            // フォーマット維持なしで再試行\n            const retry = await callDeeplApi(cleanedText, false);\n            if (retry.trim() !== cleanedText.trim()) {\n                console.log(`フォーマット維持なしで翻訳成功: \"${cleanedText}\" → \"${retry}\"`);\n                return retry;\n            }\n            // それでも同じならソース言語を変えて試す最後の手段\n            const forcedSourceLang = detectedSourceLang === \"JA\" ? \"EN\" : \"JA\";\n            console.log(`最終試行: ソース言語を強制的に ${forcedSourceLang} に設定`);\n            try {\n                const results = await (0,_deepl_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(cleanedText, normalizedTargetLang, forcedSourceLang);\n                const final = results || cleanedText;\n                if (final.trim() !== cleanedText.trim()) {\n                    console.log(`最終試行成功: \"${cleanedText}\" → \"${final}\"`);\n                    return final;\n                }\n            } catch (finalError) {\n                console.error(\"最終翻訳試行エラー:\", finalError);\n            }\n            console.log(\"全ての翻訳試行が失敗しました。原文を返します。\");\n            return cleanedText;\n        }\n        console.log(`翻訳成功: \"${cleanedText.slice(0, 20)}...\" → \"${first.slice(0, 20)}...\"`);\n        return first;\n    } catch (error) {\n        console.error(\"translateWithDeepL エラー:\", error);\n        return cleanedText; // エラー時は原文を返す\n    }\n}\n/**\r\n * DeepL で翻訳し、翻訳テキストを返す\r\n * cleaned: 末尾の「...」などを除去した本文\r\n * @param {string} cleaned - 翻訳するテキスト\r\n * @param {string} targetLang - 翻訳先言語コード\r\n * @param {string|null} sourceLang - 翻訳元言語コード（オプション）\r\n * @returns {Promise<string>} - 翻訳されたテキスト（文字列）\r\n */ async function translateText(cleaned, targetLang, sourceLang = null) {\n    if (!cleaned) return \"\";\n    if (!DEEPL_API_KEY) {\n        console.error(\"DeepL API キーが設定されていません。\");\n        return cleaned; // APIキーがない場合は原文を返す\n    }\n    try {\n        // 言語コードの正規化\n        const normalizedTargetLang = (0,_langUtil_js__WEBPACK_IMPORTED_MODULE_2__.mapLang)(targetLang);\n        //   0: 全体, 1: 本体, 2: 末尾記号\n        const [, core = \"\", trailer = \"\"] = cleaned.match(/^(.*?)([\\u0021-\\u002E\\u3001-\\u303F\\uFF01-\\uFF0F\\u2026]+)?$/u) || [];\n        const text = core || cleaned.trim();\n        if (!text) return cleaned;\n        // ソース言語を検出\n        const effectiveSourceLang = sourceLang ? (0,_langUtil_js__WEBPACK_IMPORTED_MODULE_2__.mapLang)(sourceLang) : detectSourceLang(text);\n        // 同じ言語への翻訳は避ける\n        if (effectiveSourceLang.toLowerCase() === normalizedTargetLang.toLowerCase()) {\n            console.log(`同じ言語への翻訳をスキップ: ${effectiveSourceLang}`);\n            return cleaned;\n        }\n        // まず辞書検索を試す\n        const dictResult = translateWithDictionary(text, normalizedTargetLang);\n        if (dictResult) {\n            console.log(`辞書翻訳成功: \"${text.slice(0, 20)}...\" → \"${dictResult.slice(0, 20)}...\"`);\n            return dictResult + trailer;\n        }\n        // DeepL API呼び出し\n        console.log(`翻訳リクエスト: ${effectiveSourceLang} → ${normalizedTargetLang}`, text.slice(0, 20));\n        const translatedResults = await (0,_deepl_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(text, normalizedTargetLang, effectiveSourceLang);\n        // deepl関数は配列ではなく文字列を返すようになったので、そのまま使用\n        const translatedText = translatedResults || text;\n        // 翻訳結果 + 元の末尾記号を結合\n        const result = (translatedText + trailer).trim();\n        // 翻訳結果が原文と同じ場合は辞書を再確認\n        if (result.trim() === text.trim() + trailer.trim()) {\n            console.log(\"翻訳結果が原文と同じです。強制的に翻訳を試みます。\");\n            // 強制的に反対言語に設定して再試行\n            const forcedSourceLang = effectiveSourceLang === \"JA\" ? \"EN\" : \"JA\";\n            const forcedResults = await (0,_deepl_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(text, normalizedTargetLang, forcedSourceLang);\n            // 配列ではなく文字列を使用\n            const forcedResult = forcedResults || text;\n            if (forcedResult.trim() !== text.trim()) {\n                console.log(`強制翻訳成功: \"${text.slice(0, 20)}...\" → \"${forcedResult.slice(0, 20)}...\"`);\n                return (forcedResult + trailer).trim();\n            }\n            return result; // 失敗した場合はDeepLの結果をそのまま返す\n        }\n        return result;\n    } catch (error) {\n        console.error(\"translateText エラー:\", error);\n        return cleaned; // エラー時は原文を返す\n    }\n}\n/**\r\n * 簡易辞書を使った翻訳\r\n * @param {string} text - 翻訳するテキスト\r\n * @param {string} targetLang - 対象言語\r\n * @returns {string|null} - 翻訳結果、辞書にない場合はnull\r\n */ function translateWithDictionary(text, targetLang) {\n    const simpleDictionary = {\n        // 日本語→英語\n        \"犬\": \"dog\",\n        \"猫\": \"cat\",\n        \"こんにちは\": \"hello\",\n        \"おはよう\": \"good morning\",\n        \"ありがとう\": \"thank you\",\n        \"はい\": \"yes\",\n        \"いいえ\": \"no\",\n        // 英語→日本語\n        \"dog\": \"犬\",\n        \"cat\": \"猫\",\n        \"hello\": \"こんにちは\",\n        \"good morning\": \"おはよう\",\n        \"thank you\": \"ありがとう\",\n        \"yes\": \"はい\",\n        \"no\": \"いいえ\"\n    };\n    const normalizedText = text.trim().toLowerCase();\n    if (simpleDictionary[normalizedText]) {\n        const isENTarget = targetLang.toUpperCase() === \"EN\";\n        const isJAText = /[\\u3040-\\u30FF\\u4E00-\\u9FFF]/.test(normalizedText);\n        // 日本語→英語 または 英語→日本語の方向が合っている場合のみ翻訳\n        if (isENTarget && isJAText || !isENTarget && !isJAText) {\n            return simpleDictionary[normalizedText];\n        }\n    }\n    return null;\n}\n/* ------------------------------------------------------------------------\r\n * ★ 重要: saveTranslation は \"sourceId を必須\" に一本化する\r\n *   - thread でも post でも ID をそのまま sourceId に渡す\r\n *   - 呼び出し側ロジックを単純化\r\n * --------------------------------------------------------------------- */ async function saveTranslation({ sourceId, field, lang, text }) {\n    if (!sourceId || !field || !lang || !text) {\n        console.error(\"saveTranslation: 引数が不足しています\", {\n            sourceId,\n            field,\n            lang,\n            text\n        });\n        return {\n            success: false,\n            error: \"引数が不足しています\"\n        };\n    }\n    try {\n        // 言語コードの正規化\n        const normalizedLang = lang.toLowerCase();\n        const row = {\n            source_id: sourceId,\n            field,\n            language: normalizedLang,\n            translated_content: text,\n            created_at: new Date().toISOString()\n        };\n        // Supabase が null ならメモリだけで動かす\n        if (!_supabaseClient_js__WEBPACK_IMPORTED_MODULE_1__.supabase) {\n            console.log(\"翻訳保存 [mock]:\", sourceId, field, normalizedLang, text.slice(0, 20));\n            return {\n                success: true\n            };\n        }\n        const { error } = await _supabaseClient_js__WEBPACK_IMPORTED_MODULE_1__.supabase.from(\"translations\").upsert(row, {\n            onConflict: \"source_id,field,language\"\n        });\n        if (error) {\n            console.error(\"翻訳保存エラー:\", error);\n            return {\n                success: false,\n                error\n            };\n        }\n        console.log(\"翻訳保存成功:\", sourceId, field, normalizedLang, text.slice(0, 20));\n        return {\n            success: true\n        };\n    } catch (error) {\n        console.error(\"saveTranslation エラー:\", error);\n        return {\n            success: false,\n            error\n        };\n    }\n}\n/* -------------------------------------------------------------------- */ async function getTranslation(sourceId, field, lang) {\n    if (!sourceId || !field || !lang) {\n        console.error(\"getTranslation: 引数が不足しています\", {\n            sourceId,\n            field,\n            lang\n        });\n        return null;\n    }\n    try {\n        // 言語コードの正規化\n        const normalizedLang = lang.toLowerCase();\n        if (!_supabaseClient_js__WEBPACK_IMPORTED_MODULE_1__.supabase) {\n            console.log(\"翻訳取得 [mock]:\", sourceId, field, normalizedLang);\n            return null;\n        }\n        const { data, error } = await _supabaseClient_js__WEBPACK_IMPORTED_MODULE_1__.supabase.from(\"translations\").select(\"translated_content, created_at\").eq(\"source_id\", sourceId).eq(\"field\", field).eq(\"language\", normalizedLang).single();\n        if (error) {\n            // データが見つからない場合はエラーにしない\n            if (error.code === \"PGRST116\") {\n                return null;\n            }\n            console.error(\"翻訳取得エラー:\", error);\n            return null;\n        }\n        console.log(\"翻訳取得成功:\", sourceId, field, normalizedLang, data.translated_content.slice(0, 20));\n        return data.translated_content;\n    } catch (error) {\n        console.error(\"getTranslation エラー:\", error);\n        return null;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LGtCQUFrQixDQUFDdkMsS0FBSyxDQUFDLEdBQUc7UUFDekYsT0FBTytDLEtBQUtSLGtCQUFrQjtJQUNoQyxFQUFFLE9BQU96RCxPQUFPO1FBQ2RELFFBQVFDLEtBQUssQ0FBQyx1QkFBdUJBO1FBQ3JDLE9BQU87SUFDVDtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vNWNoLy4vbGliL3RyYW5zbGF0aW9uLmpzP2NkMjgiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGRlZXBsIGZyb20gJy4vZGVlcGwuanMnO1xyXG5pbXBvcnQgeyBzdXBhYmFzZSB9IGZyb20gJy4vc3VwYWJhc2VDbGllbnQuanMnO1xyXG5pbXBvcnQgeyBkZXRlY3RMYW5nLCBtYXBMYW5nLCBvcHBvc2l0ZUxhbmcgfSBmcm9tICcuL2xhbmdVdGlsLmpzJztcclxuaW1wb3J0IHsgdGhyZWFkc1N0b3JlLCBwb3N0c1N0b3JlIH0gZnJvbSAnLi9kYXRhU3RvcmUuanMnO1xyXG5cclxuLy8g5pel5pys6Kqe5paH5a2X44KS5ZCr44KA44GL57Ch5piT5Yik5a6aXHJcbmNvbnN0IGpwUmVnZXggPSAvW1xcdTMwMDAtXFx1MzAzRlxcdTMwNDAtXFx1MzA5RlxcdTMwQTAtXFx1MzBGRlxcdTRFMDAtXFx1OUZGRl0vO1xyXG5jb25zdCBkZXRlY3RTb3VyY2VMYW5nID0gKHQgPSAnJykgPT4gKGpwUmVnZXgudGVzdCh0KSA/ICdKQScgOiAnRU4nKTtcclxuXHJcbi8vIERlZXBMIEFQSeioreWumlxyXG5jb25zdCBERUVQTF9BUElfS0VZID0gcHJvY2Vzcy5lbnYuREVFUExfQVBJX0tFWTtcclxuXHJcbi8qKlxyXG4gKiDoqIDoqp7jgrPjg7zjg4njgpLmraPopo/ljJbjgZnjgovvvIhEZWVwTOOBq+mBqeOBl+OBn+W9ouW8j+OBq+WkieaPm+OBmeOCi++8iVxyXG4gKiBAcGFyYW0ge3N0cmluZ30gbGFuZ0NvZGUgLSDoqIDoqp7jgrPjg7zjg4nvvIhqYSwgZW4sIEpBLCBFTiDjgarjganvvIlcclxuICogQHJldHVybnMge3N0cmluZ30g5q2j6KaP5YyW44GV44KM44Gf6KiA6Kqe44Kz44O844OJ77yISkEsIEVO44Gq44Gp77yJXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZW5zdXJlTGFuZ0NvZGVGb3JtYXQobGFuZ0NvZGUgPSAnJykge1xyXG4gIGlmICghbGFuZ0NvZGUpIHJldHVybiAnSkEnOyAvLyDjg4fjg5Xjgqnjg6vjg4jlgKRcclxuICBcclxuICAvLyDjgZnjgafjgavmraPjgZfjgYTlvaLlvI/vvIhKQSwgRU7vvInjgafjgYLjgozjgbDjgIHjgZ3jga7jgb7jgb7ov5TjgZlcclxuICBpZiAobGFuZ0NvZGUgPT09ICdKQScgfHwgbGFuZ0NvZGUgPT09ICdFTicpIHtcclxuICAgIHJldHVybiBsYW5nQ29kZTtcclxuICB9XHJcbiAgXHJcbiAgLy8g5bCP5paH5a2X44KS5aSn5paH5a2X44Gr5aSJ5o+bXHJcbiAgcmV0dXJuIGxhbmdDb2RlLnRvTG93ZXJDYXNlKCkuc3RhcnRzV2l0aCgnamEnKSA/ICdKQSdcclxuICAgIDogbGFuZ0NvZGUudG9Mb3dlckNhc2UoKS5zdGFydHNXaXRoKCdlbicpID8gJ0VOJ1xyXG4gICAgOiBsYW5nQ29kZS50b1VwcGVyQ2FzZSgpOyAvLyDjgZ3jga7ku5bjga7oqIDoqp7jgrPjg7zjg4njga/jgZ3jga7jgb7jgb7lpKfmloflrZfjgatcclxufVxyXG5cclxuLyoqXHJcbiAqIERlZXBMIEFQSeOCkuS9v+eUqOOBl+OBpuODhuOCreOCueODiOOCkue/u+ios+OBmeOCi1xyXG4gKiBAcGFyYW0ge29iamVjdH0gcGFyYW1zIC0g44OR44Op44Oh44O844K/XHJcbiAqIEBwYXJhbSB7c3RyaW5nfHN0cmluZ1tdfSBwYXJhbXMudGV4dCAtIOe/u+ios+OBmeOCi+ODhuOCreOCueODiOOBvuOBn+OBr+ODhuOCreOCueODiOOBrumFjeWIl1xyXG4gKiBAcGFyYW0ge3N0cmluZ30gcGFyYW1zLnRhcmdldExhbmcgLSDjgr/jg7zjgrLjg4Pjg4joqIDoqp7jgrPjg7zjg4nvvIgnRU4n44G+44Gf44GvJ0pBJ++8iVxyXG4gKiBAcmV0dXJucyB7UHJvbWlzZTxzdHJpbmc+fSAtIOe/u+ios+OBleOCjOOBn+ODhuOCreOCueODiFxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHRyYW5zbGF0ZVdpdGhEZWVwTCh7IHRleHQsIHRhcmdldExhbmcgfSkge1xyXG4gIGlmICghdGV4dCkgcmV0dXJuICcnO1xyXG4gIGlmICghREVFUExfQVBJX0tFWSkge1xyXG4gICAgY29uc29sZS5lcnJvcignRGVlcEwgQVBJIOOCreODvOOBjOioreWumuOBleOCjOOBpuOBhOOBvuOBm+OCk+OAgicpO1xyXG4gICAgcmV0dXJuIEFycmF5LmlzQXJyYXkodGV4dCkgPyB0ZXh0WzBdIHx8ICcnIDogdGV4dDsgLy8gQVBJ44Kt44O844GM44Gq44GE5aC05ZCI44Gv5Y6f5paH44KS6L+U44GZXHJcbiAgfVxyXG5cclxuICAvLyDoqIDoqp7jgrPjg7zjg4njga7mraPopo/ljJZcclxuICBjb25zdCBub3JtYWxpemVkVGFyZ2V0TGFuZyA9IG1hcExhbmcodGFyZ2V0TGFuZyk7XHJcbiAgXHJcbiAgLy8g4pGgIOWJjeWHpueQhiDigJUg5pS56KGM4oaS56m655m944O744OI44Oq44Og44O76YCj57aa44OU44Oq44Kq44OJ5pW055CGXHJcbiAgY29uc3QgY2xlYW5lZCA9IEFycmF5LmlzQXJyYXkodGV4dCkgPyB0ZXh0WzBdIDogdGV4dDtcclxuICBjb25zdCBjbGVhbmVkVGV4dCA9IGNsZWFuZWRcclxuICAgIC5yZXBsYWNlKC9cXHI/XFxuKy9nLCAnICcpICAgICAgLy8g5pS56KGM44KS5Y2K6KeS44K544Oa44O844K544GrXHJcbiAgICAucmVwbGFjZSgvXFwuezMsfS9nLCAnLi4uJykgICAgLy8g44OU44Oq44Kq44OJIDMg5YCL44KS6LaF44GI44KL6YOo5YiG44GvIDMg5YCL44GrXHJcbiAgICAudHJpbSgpO1xyXG5cclxuICBpZiAoIWNsZWFuZWRUZXh0KSByZXR1cm4gJyc7XHJcblxyXG4gIC8vIOefreOBhOODhuOCreOCueODiOOBruWgtOWQiOOBr+i+nuabuOOCkuS9v+OBo+OBn+ebtOaOpee/u+ios+OCkuippuOBv+OCi1xyXG4gIGlmIChjbGVhbmVkVGV4dC5sZW5ndGggPCAxMCkge1xyXG4gICAgY29uc3Qgc2ltcGxlRGljdCA9IHtcclxuICAgICAgJ+eKrCc6IHsgZW46ICdkb2cnLCBqYTogJ+eKrCcgfSxcclxuICAgICAgJ+eMqyc6IHsgZW46ICdjYXQnLCBqYTogJ+eMqycgfSxcclxuICAgICAgJ2RvZyc6IHsgZW46ICdkb2cnLCBqYTogJ+eKrCcgfSxcclxuICAgICAgJ2NhdCc6IHsgZW46ICdjYXQnLCBqYTogJ+eMqycgfSxcclxuICAgICAgJ2hlbGxvJzogeyBlbjogJ2hlbGxvJywgamE6ICfjgZPjgpPjgavjgaHjga8nIH0sXHJcbiAgICAgICd5ZXMnOiB7IGVuOiAneWVzJywgamE6ICfjga/jgYQnIH0sXHJcbiAgICAgICdubyc6IHsgZW46ICdubycsIGphOiAn44GE44GE44GIJyB9XHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICBjb25zdCBkaWN0S2V5ID0gY2xlYW5lZFRleHQudG9Mb3dlckNhc2UoKS50cmltKCk7XHJcbiAgICBjb25zdCBkaWN0RW50cnkgPSBzaW1wbGVEaWN0W2RpY3RLZXldO1xyXG4gICAgaWYgKGRpY3RFbnRyeSkge1xyXG4gICAgICBjb25zdCB0YXJnZXRMYW5nQ29kZSA9IG5vcm1hbGl6ZWRUYXJnZXRMYW5nLnRvTG93ZXJDYXNlKCkgPT09ICdlbicgPyAnZW4nIDogJ2phJztcclxuICAgICAgY29uc3QgdHJhbnNsYXRlZCA9IGRpY3RFbnRyeVt0YXJnZXRMYW5nQ29kZV07XHJcbiAgICAgIGlmICh0cmFuc2xhdGVkICYmIHRyYW5zbGF0ZWQgIT09IGNsZWFuZWRUZXh0KSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coYOi+nuabuOe/u+ioszogXCIke2NsZWFuZWRUZXh0fVwiIOKGkiBcIiR7dHJhbnNsYXRlZH1cImApO1xyXG4gICAgICAgIHJldHVybiB0cmFuc2xhdGVkO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICB0cnkge1xyXG4gICAgLy8g44K944O844K56KiA6Kqe44KS5qSc5Ye677yI5pel5pys6Kqe5paH5a2X44GM5ZCr44G+44KM44KL44GL44Gp44GG44GL77yJXHJcbiAgICBjb25zdCBkZXRlY3RlZFNvdXJjZUxhbmcgPSBkZXRlY3RTb3VyY2VMYW5nKGNsZWFuZWRUZXh0KTtcclxuICAgIFxyXG4gICAgLy8g5ZCM44GY6KiA6Kqe44G444Gu57+76Kiz44Gv6YG/44GR44KLXHJcbiAgICBpZiAoZGV0ZWN0ZWRTb3VyY2VMYW5nLnRvTG93ZXJDYXNlKCkgPT09IG5vcm1hbGl6ZWRUYXJnZXRMYW5nLnRvTG93ZXJDYXNlKCkpIHtcclxuICAgICAgY29uc29sZS5sb2coYOWQjOOBmOiogOiqnuOBuOOBrue/u+ios+OCkuOCueOCreODg+ODlzogJHtkZXRlY3RlZFNvdXJjZUxhbmd9YCk7XHJcbiAgICAgIHJldHVybiBjbGVhbmVkVGV4dDtcclxuICAgIH1cclxuICAgIFxyXG4gICAgY29uc29sZS5sb2coYERlZXBM57+76Kiz44Oq44Kv44Ko44K544OIOiBcIiR7Y2xlYW5lZFRleHQuc2xpY2UoMCwgMjApfS4uLlwiICgke2RldGVjdGVkU291cmNlTGFuZ30g4oaSICR7bm9ybWFsaXplZFRhcmdldExhbmd9KWApO1xyXG5cclxuICAgIC8vIERlZXBMIEFQSeWRvOOBs+WHuuOBl+mWouaVsO+8iOWGhemDqOeUqO+8iVxyXG4gICAgYXN5bmMgZnVuY3Rpb24gY2FsbERlZXBsQXBpKHJlcVRleHQsIGtlZXBGb3JtYXR0aW5nID0gdHJ1ZSkge1xyXG4gICAgICB0cnkge1xyXG4gICAgICAgIC8vIERlZXBsIOmWouaVsOOCkuebtOaOpeWRvOOBs+WHuuOBl1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdHMgPSBhd2FpdCBkZWVwbChcclxuICAgICAgICAgIHJlcVRleHQsXHJcbiAgICAgICAgICBub3JtYWxpemVkVGFyZ2V0TGFuZyxcclxuICAgICAgICAgIGRldGVjdGVkU291cmNlTGFuZyAvLyDjgr3jg7zjgrnoqIDoqp7jgpLmmI7npLrnmoTjgavmjIflrppcclxuICAgICAgICApO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIOaWh+Wtl+WIl+OBqOOBl+OBpue1kOaenOOCkui/lOOBmVxyXG4gICAgICAgIHJldHVybiByZXN1bHRzIHx8IHJlcVRleHQ7XHJcbiAgICAgIH0gY2F0Y2ggKGVycikge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0RlZXBMIEFQSSDlkbzjgbPlh7rjgZfjgqjjg6njg7w6JywgZXJyLm1lc3NhZ2UpO1xyXG4gICAgICAgIHJldHVybiByZXFUZXh0OyAvLyDjgqjjg6njg7zmmYLjga/ljp/mlofjgpLov5TjgZlcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIOKRoCDvvJHlm57nm67jga7nv7voqLPoqabooYxcclxuICAgIGNvbnN0IGZpcnN0ID0gYXdhaXQgY2FsbERlZXBsQXBpKGNsZWFuZWRUZXh0LCB0cnVlKTtcclxuXHJcbiAgICAvLyDikaEg57+76Kiz57WQ5p6c44GM5Y6f5paH44Go5ZCM44GY44GL44OB44Kn44OD44KvXHJcbiAgICBpZiAoZmlyc3QudHJpbSgpID09PSBjbGVhbmVkVGV4dC50cmltKCkpIHtcclxuICAgICAgY29uc29sZS5sb2coJ+e/u+ios+e1kOaenOOBjOWOn+aWh+OBqOWQjOOBmOOBp+OBmeOAguWIpeOBruaWueazleOBp+WGjeippuihjOOBl+OBvuOBmeOAgicpO1xyXG4gICAgICBcclxuICAgICAgLy8g5Y2Y6Kqe6L6e5pu444Gn5YaN56K66KqNXHJcbiAgICAgIGNvbnN0IGRpY3RXb3JkcyA9IHtcclxuICAgICAgICAn54qsJzogJ2RvZycsXHJcbiAgICAgICAgJ+eMqyc6ICdjYXQnLFxyXG4gICAgICAgICfjgZPjgpPjgavjgaHjga8nOiAnaGVsbG8nLFxyXG4gICAgICAgICfjgYrjga/jgojjgYYnOiAnZ29vZCBtb3JuaW5nJyxcclxuICAgICAgICAn44GC44KK44GM44Go44GGJzogJ3RoYW5rIHlvdScsXHJcbiAgICAgICAgJ2RvZyc6ICfniqwnLFxyXG4gICAgICAgICdjYXQnOiAn54yrJyxcclxuICAgICAgICAnaGVsbG8nOiAn44GT44KT44Gr44Gh44GvJyxcclxuICAgICAgICAnZ29vZCBtb3JuaW5nJzogJ+OBiuOBr+OCiOOBhicsXHJcbiAgICAgICAgJ3RoYW5rIHlvdSc6ICfjgYLjgorjgYzjgajjgYYnXHJcbiAgICAgIH07XHJcbiAgICAgIFxyXG4gICAgICBpZiAoZGljdFdvcmRzW2NsZWFuZWRUZXh0XSkge1xyXG4gICAgICAgIGNvbnN0IGRpY3RSZXN1bHQgPSBkaWN0V29yZHNbY2xlYW5lZFRleHRdO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGDovp7mm7jjgavjgojjgovlho3nv7voqLM6IFwiJHtjbGVhbmVkVGV4dH1cIiDihpIgXCIke2RpY3RSZXN1bHR9XCJgKTtcclxuICAgICAgICByZXR1cm4gZGljdFJlc3VsdDtcclxuICAgICAgfVxyXG4gICAgICBcclxuICAgICAgLy8g44OV44Kp44O844Oe44OD44OI57at5oyB44Gq44GX44Gn5YaN6Kmm6KGMXHJcbiAgICAgIGNvbnN0IHJldHJ5ID0gYXdhaXQgY2FsbERlZXBsQXBpKGNsZWFuZWRUZXh0LCBmYWxzZSk7XHJcbiAgICAgIFxyXG4gICAgICBpZiAocmV0cnkudHJpbSgpICE9PSBjbGVhbmVkVGV4dC50cmltKCkpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhg44OV44Kp44O844Oe44OD44OI57at5oyB44Gq44GX44Gn57+76Kiz5oiQ5YqfOiBcIiR7Y2xlYW5lZFRleHR9XCIg4oaSIFwiJHtyZXRyeX1cImApO1xyXG4gICAgICAgIHJldHVybiByZXRyeTtcclxuICAgICAgfVxyXG4gICAgICBcclxuICAgICAgLy8g44Gd44KM44Gn44KC5ZCM44GY44Gq44KJ44K944O844K56KiA6Kqe44KS5aSJ44GI44Gm6Kmm44GZ5pyA5b6M44Gu5omL5q61XHJcbiAgICAgIGNvbnN0IGZvcmNlZFNvdXJjZUxhbmcgPSBkZXRlY3RlZFNvdXJjZUxhbmcgPT09ICdKQScgPyAnRU4nIDogJ0pBJztcclxuICAgICAgY29uc29sZS5sb2coYOacgOe1guippuihjDog44K944O844K56KiA6Kqe44KS5by35Yi255qE44GrICR7Zm9yY2VkU291cmNlTGFuZ30g44Gr6Kit5a6aYCk7XHJcbiAgICAgIFxyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdHMgPSBhd2FpdCBkZWVwbChjbGVhbmVkVGV4dCwgbm9ybWFsaXplZFRhcmdldExhbmcsIGZvcmNlZFNvdXJjZUxhbmcpO1xyXG4gICAgICAgIGNvbnN0IGZpbmFsID0gcmVzdWx0cyB8fCBjbGVhbmVkVGV4dDtcclxuICAgICAgICBcclxuICAgICAgICBpZiAoZmluYWwudHJpbSgpICE9PSBjbGVhbmVkVGV4dC50cmltKCkpIHtcclxuICAgICAgICAgIGNvbnNvbGUubG9nKGDmnIDntYLoqabooYzmiJDlip86IFwiJHtjbGVhbmVkVGV4dH1cIiDihpIgXCIke2ZpbmFsfVwiYCk7XHJcbiAgICAgICAgICByZXR1cm4gZmluYWw7XHJcbiAgICAgICAgfVxyXG4gICAgICB9IGNhdGNoIChmaW5hbEVycm9yKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcign5pyA57WC57+76Kiz6Kmm6KGM44Ko44Op44O8OicsIGZpbmFsRXJyb3IpO1xyXG4gICAgICB9XHJcbiAgICAgIFxyXG4gICAgICBjb25zb2xlLmxvZygn5YWo44Gm44Gu57+76Kiz6Kmm6KGM44GM5aSx5pWX44GX44G+44GX44Gf44CC5Y6f5paH44KS6L+U44GX44G+44GZ44CCJyk7XHJcbiAgICAgIHJldHVybiBjbGVhbmVkVGV4dDtcclxuICAgIH1cclxuXHJcbiAgICBjb25zb2xlLmxvZyhg57+76Kiz5oiQ5YqfOiBcIiR7Y2xlYW5lZFRleHQuc2xpY2UoMCwgMjApfS4uLlwiIOKGkiBcIiR7Zmlyc3Quc2xpY2UoMCwgMjApfS4uLlwiYCk7XHJcbiAgICByZXR1cm4gZmlyc3Q7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ3RyYW5zbGF0ZVdpdGhEZWVwTCDjgqjjg6njg7w6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIGNsZWFuZWRUZXh0OyAvLyDjgqjjg6njg7zmmYLjga/ljp/mlofjgpLov5TjgZlcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBEZWVwTCDjgafnv7voqLPjgZfjgIHnv7voqLPjg4bjgq3jgrnjg4jjgpLov5TjgZlcclxuICogY2xlYW5lZDog5pyr5bC+44Gu44CMLi4u44CN44Gq44Gp44KS6Zmk5Y6744GX44Gf5pys5paHXHJcbiAqIEBwYXJhbSB7c3RyaW5nfSBjbGVhbmVkIC0g57+76Kiz44GZ44KL44OG44Kt44K544OIXHJcbiAqIEBwYXJhbSB7c3RyaW5nfSB0YXJnZXRMYW5nIC0g57+76Kiz5YWI6KiA6Kqe44Kz44O844OJXHJcbiAqIEBwYXJhbSB7c3RyaW5nfG51bGx9IHNvdXJjZUxhbmcgLSDnv7voqLPlhYPoqIDoqp7jgrPjg7zjg4nvvIjjgqrjg5fjgrfjg6fjg7PvvIlcclxuICogQHJldHVybnMge1Byb21pc2U8c3RyaW5nPn0gLSDnv7voqLPjgZXjgozjgZ/jg4bjgq3jgrnjg4jvvIjmloflrZfliJfvvIlcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB0cmFuc2xhdGVUZXh0KGNsZWFuZWQsIHRhcmdldExhbmcsIHNvdXJjZUxhbmcgPSBudWxsKSB7XHJcbiAgaWYgKCFjbGVhbmVkKSByZXR1cm4gJyc7XHJcbiAgaWYgKCFERUVQTF9BUElfS0VZKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdEZWVwTCBBUEkg44Kt44O844GM6Kit5a6a44GV44KM44Gm44GE44G+44Gb44KT44CCJyk7XHJcbiAgICByZXR1cm4gY2xlYW5lZDsgLy8gQVBJ44Kt44O844GM44Gq44GE5aC05ZCI44Gv5Y6f5paH44KS6L+U44GZXHJcbiAgfVxyXG5cclxuICB0cnkge1xyXG4gICAgLy8g6KiA6Kqe44Kz44O844OJ44Gu5q2j6KaP5YyWXHJcbiAgICBjb25zdCBub3JtYWxpemVkVGFyZ2V0TGFuZyA9IG1hcExhbmcodGFyZ2V0TGFuZyk7XHJcbiAgICBcclxuICAgIC8vICAgMDog5YWo5L2TLCAxOiDmnKzkvZMsIDI6IOacq+WwvuiomOWPt1xyXG4gICAgY29uc3QgWywgY29yZSA9ICcnLCB0cmFpbGVyID0gJyddID0gY2xlYW5lZC5tYXRjaCgvXiguKj8pKFtcXHUwMDIxLVxcdTAwMkVcXHUzMDAxLVxcdTMwM0ZcXHVGRjAxLVxcdUZGMEZcXHUyMDI2XSspPyQvdSkgfHwgW107XHJcbiAgICBjb25zdCB0ZXh0ID0gY29yZSB8fCBjbGVhbmVkLnRyaW0oKTtcclxuXHJcbiAgICBpZiAoIXRleHQpIHJldHVybiBjbGVhbmVkO1xyXG5cclxuICAgIC8vIOOCveODvOOCueiogOiqnuOCkuaknOWHulxyXG4gICAgY29uc3QgZWZmZWN0aXZlU291cmNlTGFuZyA9IHNvdXJjZUxhbmcgPyBtYXBMYW5nKHNvdXJjZUxhbmcpIDogZGV0ZWN0U291cmNlTGFuZyh0ZXh0KTtcclxuICAgIFxyXG4gICAgLy8g5ZCM44GY6KiA6Kqe44G444Gu57+76Kiz44Gv6YG/44GR44KLXHJcbiAgICBpZiAoZWZmZWN0aXZlU291cmNlTGFuZy50b0xvd2VyQ2FzZSgpID09PSBub3JtYWxpemVkVGFyZ2V0TGFuZy50b0xvd2VyQ2FzZSgpKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGDlkIzjgZjoqIDoqp7jgbjjga7nv7voqLPjgpLjgrnjgq3jg4Pjg5c6ICR7ZWZmZWN0aXZlU291cmNlTGFuZ31gKTtcclxuICAgICAgcmV0dXJuIGNsZWFuZWQ7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIOOBvuOBmui+nuabuOaknOe0ouOCkuippuOBmVxyXG4gICAgY29uc3QgZGljdFJlc3VsdCA9IHRyYW5zbGF0ZVdpdGhEaWN0aW9uYXJ5KHRleHQsIG5vcm1hbGl6ZWRUYXJnZXRMYW5nKTtcclxuICAgIGlmIChkaWN0UmVzdWx0KSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGDovp7mm7jnv7voqLPmiJDlip86IFwiJHt0ZXh0LnNsaWNlKDAsIDIwKX0uLi5cIiDihpIgXCIke2RpY3RSZXN1bHQuc2xpY2UoMCwgMjApfS4uLlwiYCk7XHJcbiAgICAgIHJldHVybiBkaWN0UmVzdWx0ICsgdHJhaWxlcjtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gRGVlcEwgQVBJ5ZG844Gz5Ye644GXXHJcbiAgICBjb25zb2xlLmxvZyhg57+76Kiz44Oq44Kv44Ko44K544OIOiAke2VmZmVjdGl2ZVNvdXJjZUxhbmd9IOKGkiAke25vcm1hbGl6ZWRUYXJnZXRMYW5nfWAsIHRleHQuc2xpY2UoMCwgMjApKTtcclxuICAgIFxyXG4gICAgY29uc3QgdHJhbnNsYXRlZFJlc3VsdHMgPSBhd2FpdCBkZWVwbChcclxuICAgICAgdGV4dCxcclxuICAgICAgbm9ybWFsaXplZFRhcmdldExhbmcsXHJcbiAgICAgIGVmZmVjdGl2ZVNvdXJjZUxhbmdcclxuICAgICk7XHJcbiAgICBcclxuICAgIC8vIGRlZXBs6Zai5pWw44Gv6YWN5YiX44Gn44Gv44Gq44GP5paH5a2X5YiX44KS6L+U44GZ44KI44GG44Gr44Gq44Gj44Gf44Gu44Gn44CB44Gd44Gu44G+44G+5L2/55SoXHJcbiAgICBjb25zdCB0cmFuc2xhdGVkVGV4dCA9IHRyYW5zbGF0ZWRSZXN1bHRzIHx8IHRleHQ7XHJcbiAgICBcclxuICAgIC8vIOe/u+ios+e1kOaenCArIOWFg+OBruacq+WwvuiomOWPt+OCkue1kOWQiFxyXG4gICAgY29uc3QgcmVzdWx0ID0gKHRyYW5zbGF0ZWRUZXh0ICsgdHJhaWxlcikudHJpbSgpO1xyXG4gICAgXHJcbiAgICAvLyDnv7voqLPntZDmnpzjgYzljp/mlofjgajlkIzjgZjloLTlkIjjga/ovp7mm7jjgpLlho3norroqo1cclxuICAgIGlmIChyZXN1bHQudHJpbSgpID09PSB0ZXh0LnRyaW0oKSArIHRyYWlsZXIudHJpbSgpKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKCfnv7voqLPntZDmnpzjgYzljp/mlofjgajlkIzjgZjjgafjgZnjgILlvLfliLbnmoTjgavnv7voqLPjgpLoqabjgb/jgb7jgZnjgIInKTtcclxuICAgICAgXHJcbiAgICAgIC8vIOW8t+WItueahOOBq+WPjeWvvuiogOiqnuOBq+ioreWumuOBl+OBpuWGjeippuihjFxyXG4gICAgICBjb25zdCBmb3JjZWRTb3VyY2VMYW5nID0gZWZmZWN0aXZlU291cmNlTGFuZyA9PT0gJ0pBJyA/ICdFTicgOiAnSkEnO1xyXG4gICAgICBjb25zdCBmb3JjZWRSZXN1bHRzID0gYXdhaXQgZGVlcGwodGV4dCwgbm9ybWFsaXplZFRhcmdldExhbmcsIGZvcmNlZFNvdXJjZUxhbmcpO1xyXG4gICAgICBcclxuICAgICAgLy8g6YWN5YiX44Gn44Gv44Gq44GP5paH5a2X5YiX44KS5L2/55SoXHJcbiAgICAgIGNvbnN0IGZvcmNlZFJlc3VsdCA9IGZvcmNlZFJlc3VsdHMgfHwgdGV4dDtcclxuICAgICAgXHJcbiAgICAgIGlmIChmb3JjZWRSZXN1bHQudHJpbSgpICE9PSB0ZXh0LnRyaW0oKSkge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGDlvLfliLbnv7voqLPmiJDlip86IFwiJHt0ZXh0LnNsaWNlKDAsIDIwKX0uLi5cIiDihpIgXCIke2ZvcmNlZFJlc3VsdC5zbGljZSgwLCAyMCl9Li4uXCJgKTtcclxuICAgICAgICByZXR1cm4gKGZvcmNlZFJlc3VsdCArIHRyYWlsZXIpLnRyaW0oKTtcclxuICAgICAgfVxyXG4gICAgICBcclxuICAgICAgcmV0dXJuIHJlc3VsdDsgLy8g5aSx5pWX44GX44Gf5aC05ZCI44GvRGVlcEzjga7ntZDmnpzjgpLjgZ3jga7jgb7jgb7ov5TjgZlcclxuICAgIH1cclxuICAgIFxyXG4gICAgcmV0dXJuIHJlc3VsdDtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcigndHJhbnNsYXRlVGV4dCDjgqjjg6njg7w6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIGNsZWFuZWQ7IC8vIOOCqOODqeODvOaZguOBr+WOn+aWh+OCkui/lOOBmVxyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIOewoeaYk+i+nuabuOOCkuS9v+OBo+OBn+e/u+ios1xyXG4gKiBAcGFyYW0ge3N0cmluZ30gdGV4dCAtIOe/u+ios+OBmeOCi+ODhuOCreOCueODiFxyXG4gKiBAcGFyYW0ge3N0cmluZ30gdGFyZ2V0TGFuZyAtIOWvvuixoeiogOiqnlxyXG4gKiBAcmV0dXJucyB7c3RyaW5nfG51bGx9IC0g57+76Kiz57WQ5p6c44CB6L6e5pu444Gr44Gq44GE5aC05ZCI44GvbnVsbFxyXG4gKi9cclxuZnVuY3Rpb24gdHJhbnNsYXRlV2l0aERpY3Rpb25hcnkodGV4dCwgdGFyZ2V0TGFuZykge1xyXG4gIGNvbnN0IHNpbXBsZURpY3Rpb25hcnkgPSB7XHJcbiAgICAvLyDml6XmnKzoqp7ihpLoi7Hoqp5cclxuICAgICfniqwnOiAnZG9nJyxcclxuICAgICfnjKsnOiAnY2F0JyxcclxuICAgICfjgZPjgpPjgavjgaHjga8nOiAnaGVsbG8nLFxyXG4gICAgJ+OBiuOBr+OCiOOBhic6ICdnb29kIG1vcm5pbmcnLFxyXG4gICAgJ+OBguOCiuOBjOOBqOOBhic6ICd0aGFuayB5b3UnLFxyXG4gICAgJ+OBr+OBhCc6ICd5ZXMnLFxyXG4gICAgJ+OBhOOBhOOBiCc6ICdubycsXHJcbiAgICBcclxuICAgIC8vIOiLseiqnuKGkuaXpeacrOiqnlxyXG4gICAgJ2RvZyc6ICfniqwnLFxyXG4gICAgJ2NhdCc6ICfnjKsnLFxyXG4gICAgJ2hlbGxvJzogJ+OBk+OCk+OBq+OBoeOBrycsXHJcbiAgICAnZ29vZCBtb3JuaW5nJzogJ+OBiuOBr+OCiOOBhicsXHJcbiAgICAndGhhbmsgeW91JzogJ+OBguOCiuOBjOOBqOOBhicsXHJcbiAgICAneWVzJzogJ+OBr+OBhCcsXHJcbiAgICAnbm8nOiAn44GE44GE44GIJ1xyXG4gIH07XHJcbiAgXHJcbiAgY29uc3Qgbm9ybWFsaXplZFRleHQgPSB0ZXh0LnRyaW0oKS50b0xvd2VyQ2FzZSgpO1xyXG4gIFxyXG4gIGlmIChzaW1wbGVEaWN0aW9uYXJ5W25vcm1hbGl6ZWRUZXh0XSkge1xyXG4gICAgY29uc3QgaXNFTlRhcmdldCA9IHRhcmdldExhbmcudG9VcHBlckNhc2UoKSA9PT0gJ0VOJztcclxuICAgIGNvbnN0IGlzSkFUZXh0ID0gL1tcXHUzMDQwLVxcdTMwRkZcXHU0RTAwLVxcdTlGRkZdLy50ZXN0KG5vcm1hbGl6ZWRUZXh0KTtcclxuICAgIFxyXG4gICAgLy8g5pel5pys6Kqe4oaS6Iux6KqeIOOBvuOBn+OBryDoi7Hoqp7ihpLml6XmnKzoqp7jga7mlrnlkJHjgYzlkIjjgaPjgabjgYTjgovloLTlkIjjga7jgb/nv7voqLNcclxuICAgIGlmICgoaXNFTlRhcmdldCAmJiBpc0pBVGV4dCkgfHwgKCFpc0VOVGFyZ2V0ICYmICFpc0pBVGV4dCkpIHtcclxuICAgICAgcmV0dXJuIHNpbXBsZURpY3Rpb25hcnlbbm9ybWFsaXplZFRleHRdO1xyXG4gICAgfVxyXG4gIH1cclxuICBcclxuICByZXR1cm4gbnVsbDtcclxufVxyXG5cclxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAqIOKYhSDph43opoE6IHNhdmVUcmFuc2xhdGlvbiDjga8gXCJzb3VyY2VJZCDjgpLlv4XpoIhcIiDjgavkuIDmnKzljJbjgZnjgotcclxuICogICAtIHRocmVhZCDjgafjgoIgcG9zdCDjgafjgoIgSUQg44KS44Gd44Gu44G+44G+IHNvdXJjZUlkIOOBq+a4oeOBmVxyXG4gKiAgIC0g5ZG844Gz5Ye644GX5YG044Ot44K444OD44Kv44KS5Y2Y57SU5YyWXHJcbiAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc2F2ZVRyYW5zbGF0aW9uKHsgc291cmNlSWQsIGZpZWxkLCBsYW5nLCB0ZXh0IH0pIHtcclxuICBpZiAoIXNvdXJjZUlkIHx8ICFmaWVsZCB8fCAhbGFuZyB8fCAhdGV4dCkge1xyXG4gICAgY29uc29sZS5lcnJvcignc2F2ZVRyYW5zbGF0aW9uOiDlvJXmlbDjgYzkuI3otrPjgZfjgabjgYTjgb7jgZknLCB7IHNvdXJjZUlkLCBmaWVsZCwgbGFuZywgdGV4dCB9KTtcclxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ+W8leaVsOOBjOS4jei2s+OBl+OBpuOBhOOBvuOBmScgfTtcclxuICB9XHJcblxyXG4gIHRyeSB7XHJcbiAgICAvLyDoqIDoqp7jgrPjg7zjg4njga7mraPopo/ljJZcclxuICAgIGNvbnN0IG5vcm1hbGl6ZWRMYW5nID0gbGFuZy50b0xvd2VyQ2FzZSgpO1xyXG4gICAgXHJcbiAgICBjb25zdCByb3cgPSB7XHJcbiAgICAgIHNvdXJjZV9pZDogc291cmNlSWQsXHJcbiAgICAgIGZpZWxkLFxyXG4gICAgICBsYW5ndWFnZTogbm9ybWFsaXplZExhbmcsXHJcbiAgICAgIHRyYW5zbGF0ZWRfY29udGVudDogdGV4dCxcclxuICAgICAgY3JlYXRlZF9hdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxyXG4gICAgfTtcclxuXHJcbiAgICAvLyBTdXBhYmFzZSDjgYwgbnVsbCDjgarjgonjg6Hjg6Ljg6rjgaDjgZHjgafli5XjgYvjgZlcclxuICAgIGlmICghc3VwYWJhc2UpIHtcclxuICAgICAgY29uc29sZS5sb2coJ+e/u+ios+S/neWtmCBbbW9ja106Jywgc291cmNlSWQsIGZpZWxkLCBub3JtYWxpemVkTGFuZywgdGV4dC5zbGljZSgwLCAyMCkpO1xyXG4gICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGNvbnN0IHsgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlLmZyb20oJ3RyYW5zbGF0aW9ucycpXHJcbiAgICAgIC51cHNlcnQocm93LCB7IG9uQ29uZmxpY3Q6ICdzb3VyY2VfaWQsZmllbGQsbGFuZ3VhZ2UnIH0pO1xyXG4gICAgICBcclxuICAgIGlmIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCfnv7voqLPkv53lrZjjgqjjg6njg7w6JywgZXJyb3IpO1xyXG4gICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3IgfTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgY29uc29sZS5sb2coJ+e/u+ios+S/neWtmOaIkOWKnzonLCBzb3VyY2VJZCwgZmllbGQsIG5vcm1hbGl6ZWRMYW5nLCB0ZXh0LnNsaWNlKDAsIDIwKSk7XHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ3NhdmVUcmFuc2xhdGlvbiDjgqjjg6njg7w6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yIH07XHJcbiAgfVxyXG59XHJcblxyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0VHJhbnNsYXRpb24oc291cmNlSWQsIGZpZWxkLCBsYW5nKSB7XHJcbiAgaWYgKCFzb3VyY2VJZCB8fCAhZmllbGQgfHwgIWxhbmcpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ2dldFRyYW5zbGF0aW9uOiDlvJXmlbDjgYzkuI3otrPjgZfjgabjgYTjgb7jgZknLCB7IHNvdXJjZUlkLCBmaWVsZCwgbGFuZyB9KTtcclxuICAgIHJldHVybiBudWxsO1xyXG4gIH1cclxuXHJcbiAgdHJ5IHtcclxuICAgIC8vIOiogOiqnuOCs+ODvOODieOBruato+imj+WMllxyXG4gICAgY29uc3Qgbm9ybWFsaXplZExhbmcgPSBsYW5nLnRvTG93ZXJDYXNlKCk7XHJcbiAgICBcclxuICAgIGlmICghc3VwYWJhc2UpIHtcclxuICAgICAgY29uc29sZS5sb2coJ+e/u+ios+WPluW+lyBbbW9ja106Jywgc291cmNlSWQsIGZpZWxkLCBub3JtYWxpemVkTGFuZyk7XHJcbiAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAuZnJvbSgndHJhbnNsYXRpb25zJylcclxuICAgICAgLnNlbGVjdCgndHJhbnNsYXRlZF9jb250ZW50LCBjcmVhdGVkX2F0JylcclxuICAgICAgLmVxKCdzb3VyY2VfaWQnLCBzb3VyY2VJZClcclxuICAgICAgLmVxKCdmaWVsZCcsIGZpZWxkKVxyXG4gICAgICAuZXEoJ2xhbmd1YWdlJywgbm9ybWFsaXplZExhbmcpXHJcbiAgICAgIC5zaW5nbGUoKTtcclxuICAgICAgXHJcbiAgICBpZiAoZXJyb3IpIHtcclxuICAgICAgLy8g44OH44O844K/44GM6KaL44Gk44GL44KJ44Gq44GE5aC05ZCI44Gv44Ko44Op44O844Gr44GX44Gq44GEXHJcbiAgICAgIGlmIChlcnJvci5jb2RlID09PSAnUEdSU1QxMTYnKSB7XHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgIH1cclxuICAgICAgY29uc29sZS5lcnJvcign57+76Kiz5Y+W5b6X44Ko44Op44O8OicsIGVycm9yKTtcclxuICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGNvbnNvbGUubG9nKCfnv7voqLPlj5blvpfmiJDlip86Jywgc291cmNlSWQsIGZpZWxkLCBub3JtYWxpemVkTGFuZywgZGF0YS50cmFuc2xhdGVkX2NvbnRlbnQuc2xpY2UoMCwgMjApKTtcclxuICAgIHJldHVybiBkYXRhLnRyYW5zbGF0ZWRfY29udGVudDtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignZ2V0VHJhbnNsYXRpb24g44Ko44Op44O8OicsIGVycm9yKTtcclxuICAgIHJldHVybiBudWxsO1xyXG4gIH1cclxufSAiXSwibmFtZXMiOlsiZGVlcGwiLCJzdXBhYmFzZSIsImRldGVjdExhbmciLCJtYXBMYW5nIiwib3Bwb3NpdGVMYW5nIiwidGhyZWFkc1N0b3JlIiwicG9zdHNTdG9yZSIsImpwUmVnZXgiLCJkZXRlY3RTb3VyY2VMYW5nIiwidCIsInRlc3QiLCJERUVQTF9BUElfS0VZIiwicHJvY2VzcyIsImVudiIsImVuc3VyZUxhbmdDb2RlRm9ybWF0IiwibGFuZ0NvZGUiLCJ0b0xvd2VyQ2FzZSIsInN0YXJ0c1dpdGgiLCJ0b1VwcGVyQ2FzZSIsInRyYW5zbGF0ZVdpdGhEZWVwTCIsInRleHQiLCJ0YXJnZXRMYW5nIiwiY29uc29sZSIsImVycm9yIiwiQXJyYXkiLCJpc0FycmF5Iiwibm9ybWFsaXplZFRhcmdldExhbmciLCJjbGVhbmVkIiwiY2xlYW5lZFRleHQiLCJyZXBsYWNlIiwidHJpbSIsImxlbmd0aCIsInNpbXBsZURpY3QiLCJlbiIsImphIiwiZGljdEtleSIsImRpY3RFbnRyeSIsInRhcmdldExhbmdDb2RlIiwidHJhbnNsYXRlZCIsImxvZyIsImRldGVjdGVkU291cmNlTGFuZyIsInNsaWNlIiwiY2FsbERlZXBsQXBpIiwicmVxVGV4dCIsImtlZXBGb3JtYXR0aW5nIiwicmVzdWx0cyIsImVyciIsIm1lc3NhZ2UiLCJmaXJzdCIsImRpY3RXb3JkcyIsImRpY3RSZXN1bHQiLCJyZXRyeSIsImZvcmNlZFNvdXJjZUxhbmciLCJmaW5hbCIsImZpbmFsRXJyb3IiLCJ0cmFuc2xhdGVUZXh0Iiwic291cmNlTGFuZyIsImNvcmUiLCJ0cmFpbGVyIiwibWF0Y2giLCJlZmZlY3RpdmVTb3VyY2VMYW5nIiwidHJhbnNsYXRlV2l0aERpY3Rpb25hcnkiLCJ0cmFuc2xhdGVkUmVzdWx0cyIsInRyYW5zbGF0ZWRUZXh0IiwicmVzdWx0IiwiZm9yY2VkUmVzdWx0cyIsImZvcmNlZFJlc3VsdCIsInNpbXBsZURpY3Rpb25hcnkiLCJub3JtYWxpemVkVGV4dCIsImlzRU5UYXJnZXQiLCJpc0pBVGV4dCIsInNhdmVUcmFuc2xhdGlvbiIsInNvdXJjZUlkIiwiZmllbGQiLCJsYW5nIiwic3VjY2VzcyIsIm5vcm1hbGl6ZWRMYW5nIiwicm93Iiwic291cmNlX2lkIiwibGFuZ3VhZ2UiLCJ0cmFuc2xhdGVkX2NvbnRlbnQiLCJjcmVhdGVkX2F0IiwiRGF0ZSIsInRvSVNPU3RyaW5nIiwiZnJvbSIsInVwc2VydCIsIm9uQ29uZmxpY3QiLCJnZXRUcmFuc2xhdGlvbiIsImRhdGEiLCJzZWxlY3QiLCJlcSIsInNpbmdsZSIsImNvZGUiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./lib/translation.js\n");

/***/ }),

/***/ "(api)/./pages/api/threads/[id].js":
/*!***********************************!*\
  !*** ./pages/api/threads/[id].js ***!
  \***********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var _lib_supabaseClient_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/supabaseClient.js */ \"(api)/./lib/supabaseClient.js\");\n/* harmony import */ var _lib_translation_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../lib/translation.js */ \"(api)/./lib/translation.js\");\n/* harmony import */ var _lib_dataStore_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../lib/dataStore.js */ \"(api)/./lib/dataStore.js\");\n/* harmony import */ var _lib_cache_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../lib/cache.js */ \"(api)/./lib/cache.js\");\n\n\n\n\n// APIルートハンドラー実行時にデータストアの内容を確認\ntry {\n    (0,_lib_dataStore_js__WEBPACK_IMPORTED_MODULE_2__.debugDataStore)();\n} catch (error) {\n    console.error(\"データストア初期化エラー:\", error);\n}\n// 翻訳とキャッシュを扱うヘルパー関数\nasync function translateContent(text, targetLang, sourceLang, contentId, field) {\n    if (!text) {\n        console.log(`テキストが空のため翻訳スキップ (${field} ${contentId})`);\n        return text;\n    }\n    const normalizedSourceLang = sourceLang ? (0,_lib_translation_js__WEBPACK_IMPORTED_MODULE_1__.ensureLangCodeFormat)(sourceLang) : null;\n    const normalizedTargetLang = (0,_lib_translation_js__WEBPACK_IMPORTED_MODULE_1__.ensureLangCodeFormat)(targetLang);\n    if (normalizedSourceLang && normalizedSourceLang === normalizedTargetLang) {\n        // text が文字列であることを確認してから substring を使用\n        const logText = typeof text === \"string\" ? text.substring(0, 50) : \"[non-string_text]\";\n        console.log(`同じ言語への翻訳をスキップ (${field} ${contentId}): ${normalizedSourceLang} -> ${normalizedTargetLang}. Text: \"${logText}...\"`);\n        return text;\n    }\n    const cacheKeyContentId = contentId || \"unknown_content_id\";\n    const cacheKey = `${cacheKeyContentId}_${field}_${normalizedTargetLang}`;\n    const cached = (0,_lib_cache_js__WEBPACK_IMPORTED_MODULE_3__.getCachedTranslation)(cacheKeyContentId, field, normalizedTargetLang);\n    if (cached) {\n        // cached が文字列であることを確認してから substring を使用\n        const logCached = typeof cached === \"string\" ? cached.substring(0, 50) : \"[non-string_cached_value]\";\n        console.log(`キャッシュされた翻訳を使用 (${field} ${cacheKeyContentId}, Key: ${cacheKey}): ${normalizedTargetLang} -> \"${logCached}...\"`);\n        return cached;\n    }\n    const effectiveSourceLang = normalizedSourceLang;\n    // text が文字列であることを確認してから substring を使用\n    const logTextForRequest = typeof text === \"string\" ? text.substring(0, 50) : \"[non-string_text]\";\n    console.log(`DeepL翻訳リクエスト (${field} ${cacheKeyContentId}, Key: ${cacheKey}): \"${logTextForRequest}...\" (${effectiveSourceLang || \"auto\"} → ${normalizedTargetLang})`);\n    const translatedText = await (0,_lib_translation_js__WEBPACK_IMPORTED_MODULE_1__.translateText)(text, normalizedTargetLang, effectiveSourceLang);\n    if (translatedText && typeof translatedText === \"string\" && translatedText !== text) {\n        // translatedText と text が文字列であることを確認してから substring を使用\n        const logOriginalText = typeof text === \"string\" ? text.substring(0, 50) : \"[non-string_original_text]\";\n        const logTranslated = translatedText.substring(0, 50); // translatedText は文字列であることが確認済み\n        console.log(`翻訳成功・キャッシュ保存 (${field} ${cacheKeyContentId}, Key: ${cacheKey}): \"${logOriginalText}...\" → \"${logTranslated}...\"`);\n        (0,_lib_cache_js__WEBPACK_IMPORTED_MODULE_3__.setCachedTranslation)(cacheKeyContentId, field, normalizedTargetLang, translatedText);\n    } else if (translatedText && typeof translatedText === \"string\" && translatedText === text) {\n        console.log(`翻訳結果が元テキストと同じ (${field} ${cacheKeyContentId}, Key: ${cacheKey}): ${normalizedTargetLang}. API呼び出しは行われた可能性があります。`);\n        (0,_lib_cache_js__WEBPACK_IMPORTED_MODULE_3__.setCachedTranslation)(cacheKeyContentId, field, normalizedTargetLang, translatedText);\n    } else if (!translatedText || typeof translatedText !== \"string\") {\n        console.error(`翻訳失敗または結果が文字列でない (${field} ${cacheKeyContentId}, Key: ${cacheKey}): Target: ${normalizedTargetLang}, Result:`, translatedText, `. 元のテキストを返します。\"`);\n        return text;\n    } else {\n        console.error(`予期せぬ翻訳結果 (${field} ${cacheKeyContentId}, Key: ${cacheKey}): Target: ${normalizedTargetLang}. 元のテキストを返します。\"`);\n        return text;\n    }\n    return translatedText;\n}\nasync function handler(req, res) {\n    const { id } = req.query;\n    const uiLangParam = req.query.lang || \"ja\"; // フロントエンドから渡される言語パラメータ\n    const uiLang = (0,_lib_translation_js__WEBPACK_IMPORTED_MODULE_1__.ensureLangCodeFormat)(uiLangParam); // DeepLが期待する形式 (JA, ENなど) に正規化\n    if (req.method === \"GET\") {\n        try {\n            console.log(`API HANDLER: Looking for thread with ID: ${id}, Requested UI language: ${uiLang} (param: ${uiLangParam})`);\n            let threadData = await (0,_lib_dataStore_js__WEBPACK_IMPORTED_MODULE_2__.getThreadWithPosts)(id);\n            if (!threadData) {\n                console.log(`API HANDLER: Thread not found for ID: ${id}`);\n                return res.status(404).json({\n                    error: \"Thread not found\"\n                });\n            }\n            // スレッド自体の元の言語。なければ'ja'をフォールバックとするか、エラーとするかは仕様次第。\n            // ここでは'ja'をフォールバックとします。\n            const threadOriginalLangStored = threadData.lang || \"ja\";\n            const threadOriginalLang = (0,_lib_translation_js__WEBPACK_IMPORTED_MODULE_1__.ensureLangCodeFormat)(threadOriginalLangStored);\n            console.log(`API HANDLER: Thread ${id} original language: ${threadOriginalLang} (stored as ${threadOriginalLangStored})`);\n            // スレッドタイトルの翻訳\n            if (threadData.thread.title) {\n                console.log(`API HANDLER: Processing title for thread ${id}. Original: \"${threadData.thread.title.substring(0, 50)}...\", Original lang: ${threadOriginalLang}, Target UI lang: ${uiLang}`);\n                threadData.thread.title = await translateContent(threadData.thread.title, uiLang, threadOriginalLang, `thread_${id}`, \"title\");\n            } else {\n                console.log(`API HANDLER: Thread ${id} has no title to translate.`);\n            }\n            // 各投稿の本文を翻訳\n            if (threadData.posts && threadData.posts.length > 0) {\n                console.log(`API HANDLER: Processing ${threadData.posts.length} posts for thread ${id}.`);\n                threadData.posts = await Promise.all(threadData.posts.map(async (post)=>{\n                    if (!post || !post.id) {\n                        console.warn(`API HANDLER: Invalid post object found in thread ${id}, skipping.`, post);\n                        return post; // or filter it out earlier\n                    }\n                    if (!post.body) {\n                        console.log(`API HANDLER: Post ${post.id} has no body to translate.`);\n                        return post; // 本文がなければ翻訳不要\n                    }\n                    // 各投稿の元の言語 (post.original_lang がDBに保存されていることを期待)\n                    let postOriginalLangStored = post.original_lang;\n                    let postOriginalLang = null;\n                    if (postOriginalLangStored) {\n                        postOriginalLang = (0,_lib_translation_js__WEBPACK_IMPORTED_MODULE_1__.ensureLangCodeFormat)(postOriginalLangStored);\n                        console.log(`API HANDLER: Post ${post.id} original language from DB: ${postOriginalLang} (stored as ${postOriginalLangStored}) for body: \"${post.body.substring(0, 20)}...\"`);\n                    } else {\n                        // original_lang がない場合、本文から言語を検出\n                        console.log(`API HANDLER: Post ${post.id} original_lang not found in DB. Detecting from body: \"${post.body.substring(0, 20)}...\"`);\n                        try {\n                            const detected = await (0,_lib_translation_js__WEBPACK_IMPORTED_MODULE_1__.detectLang)(post.body); // detectLangはDeepL形式の言語コードを返すと期待\n                            if (detected) {\n                                postOriginalLang = (0,_lib_translation_js__WEBPACK_IMPORTED_MODULE_1__.ensureLangCodeFormat)(detected);\n                                console.log(`API HANDLER: Post ${post.id} language detected as: ${postOriginalLang}`);\n                            // ここで検出した言語をDBの post.original_lang に保存する更新処理を入れても良い (オプション)\n                            // await savePostOriginalLang(post.id, postOriginalLang);\n                            } else {\n                                // 検出失敗時はスレッドの言語にフォールバック\n                                postOriginalLang = threadOriginalLang;\n                                console.log(`API HANDLER: Post ${post.id} language detection failed, falling back to thread lang: ${postOriginalLang}`);\n                            }\n                        } catch (e) {\n                            console.error(`API HANDLER: Error detecting language for post ${post.id}, falling back to thread lang ${threadOriginalLang}. Error:`, e);\n                            postOriginalLang = threadOriginalLang;\n                        }\n                    }\n                    const translatedBody = await translateContent(post.body, uiLang, postOriginalLang, post.id, \"body\");\n                    return {\n                        ...post,\n                        body: translatedBody,\n                        original_lang: postOriginalLang,\n                        translated_to: uiLang\n                    };\n                }));\n            } else {\n                console.log(`API HANDLER: Thread ${id} has no posts to translate.`);\n            }\n            console.log(`API HANDLER: Returning thread ${id} with ${threadData.posts ? threadData.posts.length : 0} posts, processed for UI language ${uiLang}.`);\n            return res.status(200).json(threadData);\n        } catch (error) {\n            console.error(`API HANDLER: Error fetching or processing thread ${id} (UI lang: ${uiLang}). Error:`, error);\n            // エラーオブジェクト全体やスタックトレースをログに出力するとデバッグに役立つ\n            console.error(\"Error details:\", error.message, error.stack);\n            return res.status(500).json({\n                error: \"Failed to fetch or process thread data\",\n                details: error.message\n            });\n        }\n    } else {\n        console.log(`API HANDLER: Method ${req.method} not allowed for /api/threads/[id]`);\n        res.setHeader(\"Allow\", [\n            \"GET\"\n        ]); // このエンドポイントがGETのみを想定する場合\n        return res.status(405).json({\n            error: `Method ${req.method} Not Allowed`\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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UUFBUUQsS0FBSyxDQUFDLGtCQUFrQkEsTUFBTXFELE9BQU8sRUFBRXJELE1BQU1zRCxLQUFLO1lBQzFELE9BQU85QixJQUFJUSxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO2dCQUFFakMsT0FBTztnQkFBMEN1RCxTQUFTdkQsTUFBTXFELE9BQU87WUFBQztRQUN4RztJQUNGLE9BQU87UUFDTHBELFFBQVFPLEdBQUcsQ0FBQyxDQUFDLG9CQUFvQixFQUFFZSxJQUFJTyxNQUFNLENBQUMsa0NBQWtDLENBQUM7UUFDakZOLElBQUlnQyxTQUFTLENBQUMsU0FBUztZQUFDO1NBQU0sR0FBRyx5QkFBeUI7UUFDMUQsT0FBT2hDLElBQUlRLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7WUFBRWpDLE9BQU8sQ0FBQyxPQUFPLEVBQUV1QixJQUFJTyxNQUFNLENBQUMsWUFBWSxDQUFDO1FBQUM7SUFDMUU7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovLzVjaC8uL3BhZ2VzL2FwaS90aHJlYWRzL1tpZF0uanM/YWU4ZiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBzdXBhYmFzZSB9IGZyb20gJy4uLy4uLy4uL2xpYi9zdXBhYmFzZUNsaWVudC5qcyc7XHJcbmltcG9ydCB7IHRyYW5zbGF0ZVdpdGhEZWVwTCwgZ2V0VHJhbnNsYXRpb24sIHNhdmVUcmFuc2xhdGlvbiwgdHJhbnNsYXRlVGV4dCwgZGV0ZWN0TGFuZywgZW5zdXJlTGFuZ0NvZGVGb3JtYXQgfSBmcm9tICcuLi8uLi8uLi9saWIvdHJhbnNsYXRpb24uanMnO1xyXG5pbXBvcnQgeyB0aHJlYWRzU3RvcmUsIHBvc3RzU3RvcmUsIGFkZFRocmVhZCwgYWRkUG9zdCwgZGVidWdEYXRhU3RvcmUsIGdldFRocmVhZFdpdGhQb3N0cyB9IGZyb20gJy4uLy4uLy4uL2xpYi9kYXRhU3RvcmUuanMnO1xyXG5pbXBvcnQgeyBnZXRDYWNoZWRUcmFuc2xhdGlvbiwgc2V0Q2FjaGVkVHJhbnNsYXRpb24gfSBmcm9tICcuLi8uLi8uLi9saWIvY2FjaGUuanMnO1xyXG5cclxuLy8gQVBJ44Or44O844OI44OP44Oz44OJ44Op44O85a6f6KGM5pmC44Gr44OH44O844K/44K544OI44Ki44Gu5YaF5a6544KS56K66KqNXHJcbnRyeSB7XHJcbiAgZGVidWdEYXRhU3RvcmUoKTtcclxufSBjYXRjaCAoZXJyb3IpIHtcclxuICBjb25zb2xlLmVycm9yKCfjg4fjg7zjgr/jgrnjg4jjgqLliJ3mnJ/ljJbjgqjjg6njg7w6JywgZXJyb3IpO1xyXG59XHJcblxyXG4vLyDnv7voqLPjgajjgq3jg6Pjg4Pjgrfjg6XjgpLmibHjgYbjg5jjg6vjg5Hjg7zplqLmlbBcclxuYXN5bmMgZnVuY3Rpb24gdHJhbnNsYXRlQ29udGVudCh0ZXh0LCB0YXJnZXRMYW5nLCBzb3VyY2VMYW5nLCBjb250ZW50SWQsIGZpZWxkKSB7XHJcbiAgaWYgKCF0ZXh0KSB7XHJcbiAgICBjb25zb2xlLmxvZyhg44OG44Kt44K544OI44GM56m644Gu44Gf44KB57+76Kiz44K544Kt44OD44OXICgke2ZpZWxkfSAke2NvbnRlbnRJZH0pYCk7XHJcbiAgICByZXR1cm4gdGV4dDtcclxuICB9XHJcblxyXG4gIGNvbnN0IG5vcm1hbGl6ZWRTb3VyY2VMYW5nID0gc291cmNlTGFuZyA/IGVuc3VyZUxhbmdDb2RlRm9ybWF0KHNvdXJjZUxhbmcpIDogbnVsbDtcclxuICBjb25zdCBub3JtYWxpemVkVGFyZ2V0TGFuZyA9IGVuc3VyZUxhbmdDb2RlRm9ybWF0KHRhcmdldExhbmcpO1xyXG5cclxuICBpZiAobm9ybWFsaXplZFNvdXJjZUxhbmcgJiYgbm9ybWFsaXplZFNvdXJjZUxhbmcgPT09IG5vcm1hbGl6ZWRUYXJnZXRMYW5nKSB7XHJcbiAgICAvLyB0ZXh0IOOBjOaWh+Wtl+WIl+OBp+OBguOCi+OBk+OBqOOCkueiuuiqjeOBl+OBpuOBi+OCiSBzdWJzdHJpbmcg44KS5L2/55SoXHJcbiAgICBjb25zdCBsb2dUZXh0ID0gdHlwZW9mIHRleHQgPT09ICdzdHJpbmcnID8gdGV4dC5zdWJzdHJpbmcoMCwgNTApIDogJ1tub24tc3RyaW5nX3RleHRdJztcclxuICAgIGNvbnNvbGUubG9nKGDlkIzjgZjoqIDoqp7jgbjjga7nv7voqLPjgpLjgrnjgq3jg4Pjg5cgKCR7ZmllbGR9ICR7Y29udGVudElkfSk6ICR7bm9ybWFsaXplZFNvdXJjZUxhbmd9IC0+ICR7bm9ybWFsaXplZFRhcmdldExhbmd9LiBUZXh0OiBcIiR7bG9nVGV4dH0uLi5cImApO1xyXG4gICAgcmV0dXJuIHRleHQ7XHJcbiAgfVxyXG5cclxuICBjb25zdCBjYWNoZUtleUNvbnRlbnRJZCA9IGNvbnRlbnRJZCB8fCAndW5rbm93bl9jb250ZW50X2lkJztcclxuICBjb25zdCBjYWNoZUtleSA9IGAke2NhY2hlS2V5Q29udGVudElkfV8ke2ZpZWxkfV8ke25vcm1hbGl6ZWRUYXJnZXRMYW5nfWA7XHJcblxyXG4gIGNvbnN0IGNhY2hlZCA9IGdldENhY2hlZFRyYW5zbGF0aW9uKGNhY2hlS2V5Q29udGVudElkLCBmaWVsZCwgbm9ybWFsaXplZFRhcmdldExhbmcpO1xyXG4gIGlmIChjYWNoZWQpIHtcclxuICAgIC8vIGNhY2hlZCDjgYzmloflrZfliJfjgafjgYLjgovjgZPjgajjgpLnorroqo3jgZfjgabjgYvjgokgc3Vic3RyaW5nIOOCkuS9v+eUqFxyXG4gICAgY29uc3QgbG9nQ2FjaGVkID0gdHlwZW9mIGNhY2hlZCA9PT0gJ3N0cmluZycgPyBjYWNoZWQuc3Vic3RyaW5nKDAsIDUwKSA6ICdbbm9uLXN0cmluZ19jYWNoZWRfdmFsdWVdJztcclxuICAgIGNvbnNvbGUubG9nKGDjgq3jg6Pjg4Pjgrfjg6XjgZXjgozjgZ/nv7voqLPjgpLkvb/nlKggKCR7ZmllbGR9ICR7Y2FjaGVLZXlDb250ZW50SWR9LCBLZXk6ICR7Y2FjaGVLZXl9KTogJHtub3JtYWxpemVkVGFyZ2V0TGFuZ30gLT4gXCIke2xvZ0NhY2hlZH0uLi5cImApO1xyXG4gICAgcmV0dXJuIGNhY2hlZDtcclxuICB9XHJcblxyXG4gIGNvbnN0IGVmZmVjdGl2ZVNvdXJjZUxhbmcgPSBub3JtYWxpemVkU291cmNlTGFuZztcclxuXHJcbiAgLy8gdGV4dCDjgYzmloflrZfliJfjgafjgYLjgovjgZPjgajjgpLnorroqo3jgZfjgabjgYvjgokgc3Vic3RyaW5nIOOCkuS9v+eUqFxyXG4gIGNvbnN0IGxvZ1RleHRGb3JSZXF1ZXN0ID0gdHlwZW9mIHRleHQgPT09ICdzdHJpbmcnID8gdGV4dC5zdWJzdHJpbmcoMCwgNTApIDogJ1tub24tc3RyaW5nX3RleHRdJztcclxuICBjb25zb2xlLmxvZyhgRGVlcEznv7voqLPjg6rjgq/jgqjjgrnjg4ggKCR7ZmllbGR9ICR7Y2FjaGVLZXlDb250ZW50SWR9LCBLZXk6ICR7Y2FjaGVLZXl9KTogXCIke2xvZ1RleHRGb3JSZXF1ZXN0fS4uLlwiICgke2VmZmVjdGl2ZVNvdXJjZUxhbmcgfHwgJ2F1dG8nfSDihpIgJHtub3JtYWxpemVkVGFyZ2V0TGFuZ30pYCk7XHJcbiAgY29uc3QgdHJhbnNsYXRlZFRleHQgPSBhd2FpdCB0cmFuc2xhdGVUZXh0KHRleHQsIG5vcm1hbGl6ZWRUYXJnZXRMYW5nLCBlZmZlY3RpdmVTb3VyY2VMYW5nKTtcclxuXHJcbiAgaWYgKHRyYW5zbGF0ZWRUZXh0ICYmIHR5cGVvZiB0cmFuc2xhdGVkVGV4dCA9PT0gJ3N0cmluZycgJiYgdHJhbnNsYXRlZFRleHQgIT09IHRleHQpIHtcclxuICAgIC8vIHRyYW5zbGF0ZWRUZXh0IOOBqCB0ZXh0IOOBjOaWh+Wtl+WIl+OBp+OBguOCi+OBk+OBqOOCkueiuuiqjeOBl+OBpuOBi+OCiSBzdWJzdHJpbmcg44KS5L2/55SoXHJcbiAgICBjb25zdCBsb2dPcmlnaW5hbFRleHQgPSB0eXBlb2YgdGV4dCA9PT0gJ3N0cmluZycgPyB0ZXh0LnN1YnN0cmluZygwLCA1MCkgOiAnW25vbi1zdHJpbmdfb3JpZ2luYWxfdGV4dF0nO1xyXG4gICAgY29uc3QgbG9nVHJhbnNsYXRlZCA9IHRyYW5zbGF0ZWRUZXh0LnN1YnN0cmluZygwLCA1MCk7IC8vIHRyYW5zbGF0ZWRUZXh0IOOBr+aWh+Wtl+WIl+OBp+OBguOCi+OBk+OBqOOBjOeiuuiqjea4iOOBv1xyXG4gICAgY29uc29sZS5sb2coYOe/u+ios+aIkOWKn+ODu+OCreODo+ODg+OCt+ODpeS/neWtmCAoJHtmaWVsZH0gJHtjYWNoZUtleUNvbnRlbnRJZH0sIEtleTogJHtjYWNoZUtleX0pOiBcIiR7bG9nT3JpZ2luYWxUZXh0fS4uLlwiIOKGkiBcIiR7bG9nVHJhbnNsYXRlZH0uLi5cImApO1xyXG4gICAgc2V0Q2FjaGVkVHJhbnNsYXRpb24oY2FjaGVLZXlDb250ZW50SWQsIGZpZWxkLCBub3JtYWxpemVkVGFyZ2V0TGFuZywgdHJhbnNsYXRlZFRleHQpO1xyXG4gIH0gZWxzZSBpZiAodHJhbnNsYXRlZFRleHQgJiYgdHlwZW9mIHRyYW5zbGF0ZWRUZXh0ID09PSAnc3RyaW5nJyAmJiB0cmFuc2xhdGVkVGV4dCA9PT0gdGV4dCkge1xyXG4gICAgY29uc29sZS5sb2coYOe/u+ios+e1kOaenOOBjOWFg+ODhuOCreOCueODiOOBqOWQjOOBmCAoJHtmaWVsZH0gJHtjYWNoZUtleUNvbnRlbnRJZH0sIEtleTogJHtjYWNoZUtleX0pOiAke25vcm1hbGl6ZWRUYXJnZXRMYW5nfS4gQVBJ5ZG844Gz5Ye644GX44Gv6KGM44KP44KM44Gf5Y+v6IO95oCn44GM44GC44KK44G+44GZ44CCYCk7XHJcbiAgICBzZXRDYWNoZWRUcmFuc2xhdGlvbihjYWNoZUtleUNvbnRlbnRJZCwgZmllbGQsIG5vcm1hbGl6ZWRUYXJnZXRMYW5nLCB0cmFuc2xhdGVkVGV4dCk7XHJcbiAgfSBlbHNlIGlmICghdHJhbnNsYXRlZFRleHQgfHwgdHlwZW9mIHRyYW5zbGF0ZWRUZXh0ICE9PSAnc3RyaW5nJykge1xyXG4gICAgY29uc29sZS5lcnJvcihg57+76Kiz5aSx5pWX44G+44Gf44Gv57WQ5p6c44GM5paH5a2X5YiX44Gn44Gq44GEICgke2ZpZWxkfSAke2NhY2hlS2V5Q29udGVudElkfSwgS2V5OiAke2NhY2hlS2V5fSk6IFRhcmdldDogJHtub3JtYWxpemVkVGFyZ2V0TGFuZ30sIFJlc3VsdDpgLCB0cmFuc2xhdGVkVGV4dCwgYC4g5YWD44Gu44OG44Kt44K544OI44KS6L+U44GX44G+44GZ44CCXCJgKTtcclxuICAgIHJldHVybiB0ZXh0O1xyXG4gIH0gZWxzZSB7IC8vIOOBk+OBrmVsc2Xjga/pgJrluLjliLDpgZTjgZfjgarjgYTjga/jgZrjgaDjgYzjgIHlv7Xjga7jgZ/jgoFcclxuICAgIGNvbnNvbGUuZXJyb3IoYOS6iOacn+OBm+OBrOe/u+ios+e1kOaenCAoJHtmaWVsZH0gJHtjYWNoZUtleUNvbnRlbnRJZH0sIEtleTogJHtjYWNoZUtleX0pOiBUYXJnZXQ6ICR7bm9ybWFsaXplZFRhcmdldExhbmd9LiDlhYPjga7jg4bjgq3jgrnjg4jjgpLov5TjgZfjgb7jgZnjgIJcImApO1xyXG4gICAgcmV0dXJuIHRleHQ7XHJcbiAgfVxyXG4gIHJldHVybiB0cmFuc2xhdGVkVGV4dDtcclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgYXN5bmMgZnVuY3Rpb24gaGFuZGxlcihyZXEsIHJlcykge1xyXG4gIGNvbnN0IHsgaWQgfSA9IHJlcS5xdWVyeTtcclxuICBjb25zdCB1aUxhbmdQYXJhbSA9IHJlcS5xdWVyeS5sYW5nIHx8ICdqYSc7IC8vIOODleODreODs+ODiOOCqOODs+ODieOBi+OCiea4oeOBleOCjOOCi+iogOiqnuODkeODqeODoeODvOOCv1xyXG4gIGNvbnN0IHVpTGFuZyA9IGVuc3VyZUxhbmdDb2RlRm9ybWF0KHVpTGFuZ1BhcmFtKTsgLy8gRGVlcEzjgYzmnJ/lvoXjgZnjgovlvaLlvI8gKEpBLCBFTuOBquOBqSkg44Gr5q2j6KaP5YyWXHJcblxyXG4gIGlmIChyZXEubWV0aG9kID09PSAnR0VUJykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc29sZS5sb2coYEFQSSBIQU5ETEVSOiBMb29raW5nIGZvciB0aHJlYWQgd2l0aCBJRDogJHtpZH0sIFJlcXVlc3RlZCBVSSBsYW5ndWFnZTogJHt1aUxhbmd9IChwYXJhbTogJHt1aUxhbmdQYXJhbX0pYCk7XHJcbiAgICAgIGxldCB0aHJlYWREYXRhID0gYXdhaXQgZ2V0VGhyZWFkV2l0aFBvc3RzKGlkKTtcclxuXHJcbiAgICAgIGlmICghdGhyZWFkRGF0YSkge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGBBUEkgSEFORExFUjogVGhyZWFkIG5vdCBmb3VuZCBmb3IgSUQ6ICR7aWR9YCk7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA0KS5qc29uKHsgZXJyb3I6ICdUaHJlYWQgbm90IGZvdW5kJyB9KTtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8g44K544Os44OD44OJ6Ieq5L2T44Gu5YWD44Gu6KiA6Kqe44CC44Gq44GR44KM44GwJ2phJ+OCkuODleOCqeODvOODq+ODkOODg+OCr+OBqOOBmeOCi+OBi+OAgeOCqOODqeODvOOBqOOBmeOCi+OBi+OBr+S7leanmOasoeesrOOAglxyXG4gICAgICAvLyDjgZPjgZPjgafjga8namEn44KS44OV44Kp44O844Or44OQ44OD44Kv44Go44GX44G+44GZ44CCXHJcbiAgICAgIGNvbnN0IHRocmVhZE9yaWdpbmFsTGFuZ1N0b3JlZCA9IHRocmVhZERhdGEubGFuZyB8fCAnamEnO1xyXG4gICAgICBjb25zdCB0aHJlYWRPcmlnaW5hbExhbmcgPSBlbnN1cmVMYW5nQ29kZUZvcm1hdCh0aHJlYWRPcmlnaW5hbExhbmdTdG9yZWQpO1xyXG4gICAgICBjb25zb2xlLmxvZyhgQVBJIEhBTkRMRVI6IFRocmVhZCAke2lkfSBvcmlnaW5hbCBsYW5ndWFnZTogJHt0aHJlYWRPcmlnaW5hbExhbmd9IChzdG9yZWQgYXMgJHt0aHJlYWRPcmlnaW5hbExhbmdTdG9yZWR9KWApO1xyXG5cclxuICAgICAgLy8g44K544Os44OD44OJ44K/44Kk44OI44Or44Gu57+76KizXHJcbiAgICAgIGlmICh0aHJlYWREYXRhLnRocmVhZC50aXRsZSkge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGBBUEkgSEFORExFUjogUHJvY2Vzc2luZyB0aXRsZSBmb3IgdGhyZWFkICR7aWR9LiBPcmlnaW5hbDogXCIke3RocmVhZERhdGEudGhyZWFkLnRpdGxlLnN1YnN0cmluZygwLDUwKX0uLi5cIiwgT3JpZ2luYWwgbGFuZzogJHt0aHJlYWRPcmlnaW5hbExhbmd9LCBUYXJnZXQgVUkgbGFuZzogJHt1aUxhbmd9YCk7XHJcbiAgICAgICAgdGhyZWFkRGF0YS50aHJlYWQudGl0bGUgPSBhd2FpdCB0cmFuc2xhdGVDb250ZW50KHRocmVhZERhdGEudGhyZWFkLnRpdGxlLCB1aUxhbmcsIHRocmVhZE9yaWdpbmFsTGFuZywgYHRocmVhZF8ke2lkfWAsICd0aXRsZScpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGBBUEkgSEFORExFUjogVGhyZWFkICR7aWR9IGhhcyBubyB0aXRsZSB0byB0cmFuc2xhdGUuYCk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIOWQhOaKleeov+OBruacrOaWh+OCkue/u+ios1xyXG4gICAgICBpZiAodGhyZWFkRGF0YS5wb3N0cyAmJiB0aHJlYWREYXRhLnBvc3RzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhgQVBJIEhBTkRMRVI6IFByb2Nlc3NpbmcgJHt0aHJlYWREYXRhLnBvc3RzLmxlbmd0aH0gcG9zdHMgZm9yIHRocmVhZCAke2lkfS5gKTtcclxuICAgICAgICB0aHJlYWREYXRhLnBvc3RzID0gYXdhaXQgUHJvbWlzZS5hbGwoXHJcbiAgICAgICAgICB0aHJlYWREYXRhLnBvc3RzLm1hcChhc3luYyAocG9zdCkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoIXBvc3QgfHwgIXBvc3QuaWQpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybihgQVBJIEhBTkRMRVI6IEludmFsaWQgcG9zdCBvYmplY3QgZm91bmQgaW4gdGhyZWFkICR7aWR9LCBza2lwcGluZy5gLCBwb3N0KTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBwb3N0OyAvLyBvciBmaWx0ZXIgaXQgb3V0IGVhcmxpZXJcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoIXBvc3QuYm9keSkge1xyXG4gICAgICAgICAgICAgIGNvbnNvbGUubG9nKGBBUEkgSEFORExFUjogUG9zdCAke3Bvc3QuaWR9IGhhcyBubyBib2R5IHRvIHRyYW5zbGF0ZS5gKTtcclxuICAgICAgICAgICAgICByZXR1cm4gcG9zdDsgLy8g5pys5paH44GM44Gq44GR44KM44Gw57+76Kiz5LiN6KaBXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIOWQhOaKleeov+OBruWFg+OBruiogOiqniAocG9zdC5vcmlnaW5hbF9sYW5nIOOBjERC44Gr5L+d5a2Y44GV44KM44Gm44GE44KL44GT44Go44KS5pyf5b6FKVxyXG4gICAgICAgICAgICBsZXQgcG9zdE9yaWdpbmFsTGFuZ1N0b3JlZCA9IHBvc3Qub3JpZ2luYWxfbGFuZztcclxuICAgICAgICAgICAgbGV0IHBvc3RPcmlnaW5hbExhbmcgPSBudWxsO1xyXG5cclxuICAgICAgICAgICAgaWYgKHBvc3RPcmlnaW5hbExhbmdTdG9yZWQpIHtcclxuICAgICAgICAgICAgICBwb3N0T3JpZ2luYWxMYW5nID0gZW5zdXJlTGFuZ0NvZGVGb3JtYXQocG9zdE9yaWdpbmFsTGFuZ1N0b3JlZCk7XHJcbiAgICAgICAgICAgICAgY29uc29sZS5sb2coYEFQSSBIQU5ETEVSOiBQb3N0ICR7cG9zdC5pZH0gb3JpZ2luYWwgbGFuZ3VhZ2UgZnJvbSBEQjogJHtwb3N0T3JpZ2luYWxMYW5nfSAoc3RvcmVkIGFzICR7cG9zdE9yaWdpbmFsTGFuZ1N0b3JlZH0pIGZvciBib2R5OiBcIiR7cG9zdC5ib2R5LnN1YnN0cmluZygwLDIwKX0uLi5cImApO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgIC8vIG9yaWdpbmFsX2xhbmcg44GM44Gq44GE5aC05ZCI44CB5pys5paH44GL44KJ6KiA6Kqe44KS5qSc5Ye6XHJcbiAgICAgICAgICAgICAgY29uc29sZS5sb2coYEFQSSBIQU5ETEVSOiBQb3N0ICR7cG9zdC5pZH0gb3JpZ2luYWxfbGFuZyBub3QgZm91bmQgaW4gREIuIERldGVjdGluZyBmcm9tIGJvZHk6IFwiJHtwb3N0LmJvZHkuc3Vic3RyaW5nKDAsMjApfS4uLlwiYCk7XHJcbiAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGRldGVjdGVkID0gYXdhaXQgZGV0ZWN0TGFuZyhwb3N0LmJvZHkpOyAvLyBkZXRlY3RMYW5n44GvRGVlcEzlvaLlvI/jga7oqIDoqp7jgrPjg7zjg4njgpLov5TjgZnjgajmnJ/lvoVcclxuICAgICAgICAgICAgICAgIGlmIChkZXRlY3RlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHBvc3RPcmlnaW5hbExhbmcgPSBlbnN1cmVMYW5nQ29kZUZvcm1hdChkZXRlY3RlZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coYEFQSSBIQU5ETEVSOiBQb3N0ICR7cG9zdC5pZH0gbGFuZ3VhZ2UgZGV0ZWN0ZWQgYXM6ICR7cG9zdE9yaWdpbmFsTGFuZ31gKTtcclxuICAgICAgICAgICAgICAgICAgICAvLyDjgZPjgZPjgafmpJzlh7rjgZfjgZ/oqIDoqp7jgpJEQuOBriBwb3N0Lm9yaWdpbmFsX2xhbmcg44Gr5L+d5a2Y44GZ44KL5pu05paw5Yem55CG44KS5YWl44KM44Gm44KC6Imv44GEICjjgqrjg5fjgrfjg6fjg7MpXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gYXdhaXQgc2F2ZVBvc3RPcmlnaW5hbExhbmcocG9zdC5pZCwgcG9zdE9yaWdpbmFsTGFuZyk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIOaknOWHuuWkseaVl+aZguOBr+OCueODrOODg+ODieOBruiogOiqnuOBq+ODleOCqeODvOODq+ODkOODg+OCr1xyXG4gICAgICAgICAgICAgICAgICAgIHBvc3RPcmlnaW5hbExhbmcgPSB0aHJlYWRPcmlnaW5hbExhbmc7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coYEFQSSBIQU5ETEVSOiBQb3N0ICR7cG9zdC5pZH0gbGFuZ3VhZ2UgZGV0ZWN0aW9uIGZhaWxlZCwgZmFsbGluZyBiYWNrIHRvIHRocmVhZCBsYW5nOiAke3Bvc3RPcmlnaW5hbExhbmd9YCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihgQVBJIEhBTkRMRVI6IEVycm9yIGRldGVjdGluZyBsYW5ndWFnZSBmb3IgcG9zdCAke3Bvc3QuaWR9LCBmYWxsaW5nIGJhY2sgdG8gdGhyZWFkIGxhbmcgJHt0aHJlYWRPcmlnaW5hbExhbmd9LiBFcnJvcjpgLCBlKTtcclxuICAgICAgICAgICAgICAgIHBvc3RPcmlnaW5hbExhbmcgPSB0aHJlYWRPcmlnaW5hbExhbmc7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjb25zdCB0cmFuc2xhdGVkQm9keSA9IGF3YWl0IHRyYW5zbGF0ZUNvbnRlbnQocG9zdC5ib2R5LCB1aUxhbmcsIHBvc3RPcmlnaW5hbExhbmcsIHBvc3QuaWQsICdib2R5Jyk7XHJcbiAgICAgICAgICAgIHJldHVybiB7IC4uLnBvc3QsIGJvZHk6IHRyYW5zbGF0ZWRCb2R5LCBvcmlnaW5hbF9sYW5nOiBwb3N0T3JpZ2luYWxMYW5nLCB0cmFuc2xhdGVkX3RvOiB1aUxhbmcgfTtcclxuICAgICAgICAgIH0pXHJcbiAgICAgICAgKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhgQVBJIEhBTkRMRVI6IFRocmVhZCAke2lkfSBoYXMgbm8gcG9zdHMgdG8gdHJhbnNsYXRlLmApO1xyXG4gICAgICB9XHJcbiAgICAgIGNvbnNvbGUubG9nKGBBUEkgSEFORExFUjogUmV0dXJuaW5nIHRocmVhZCAke2lkfSB3aXRoICR7dGhyZWFkRGF0YS5wb3N0cyA/IHRocmVhZERhdGEucG9zdHMubGVuZ3RoIDogMH0gcG9zdHMsIHByb2Nlc3NlZCBmb3IgVUkgbGFuZ3VhZ2UgJHt1aUxhbmd9LmApO1xyXG4gICAgICByZXR1cm4gcmVzLnN0YXR1cygyMDApLmpzb24odGhyZWFkRGF0YSk7XHJcblxyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcihgQVBJIEhBTkRMRVI6IEVycm9yIGZldGNoaW5nIG9yIHByb2Nlc3NpbmcgdGhyZWFkICR7aWR9IChVSSBsYW5nOiAke3VpTGFuZ30pLiBFcnJvcjpgLCBlcnJvcik7XHJcbiAgICAgIC8vIOOCqOODqeODvOOCquODluOCuOOCp+OCr+ODiOWFqOS9k+OChOOCueOCv+ODg+OCr+ODiOODrOODvOOCueOCkuODreOCsOOBq+WHuuWKm+OBmeOCi+OBqOODh+ODkOODg+OCsOOBq+W9ueeri+OBpFxyXG4gICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgZGV0YWlsczpcIiwgZXJyb3IubWVzc2FnZSwgZXJyb3Iuc3RhY2spO1xyXG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg1MDApLmpzb24oeyBlcnJvcjogJ0ZhaWxlZCB0byBmZXRjaCBvciBwcm9jZXNzIHRocmVhZCBkYXRhJywgZGV0YWlsczogZXJyb3IubWVzc2FnZSB9KTtcclxuICAgIH1cclxuICB9IGVsc2Uge1xyXG4gICAgY29uc29sZS5sb2coYEFQSSBIQU5ETEVSOiBNZXRob2QgJHtyZXEubWV0aG9kfSBub3QgYWxsb3dlZCBmb3IgL2FwaS90aHJlYWRzL1tpZF1gKTtcclxuICAgIHJlcy5zZXRIZWFkZXIoJ0FsbG93JywgWydHRVQnXSk7IC8vIOOBk+OBruOCqOODs+ODieODneOCpOODs+ODiOOBjEdFVOOBruOBv+OCkuaDs+WumuOBmeOCi+WgtOWQiFxyXG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA1KS5qc29uKHsgZXJyb3I6IGBNZXRob2QgJHtyZXEubWV0aG9kfSBOb3QgQWxsb3dlZGAgfSk7XHJcbiAgfVxyXG59ICJdLCJuYW1lcyI6WyJzdXBhYmFzZSIsInRyYW5zbGF0ZVdpdGhEZWVwTCIsImdldFRyYW5zbGF0aW9uIiwic2F2ZVRyYW5zbGF0aW9uIiwidHJhbnNsYXRlVGV4dCIsImRldGVjdExhbmciLCJlbnN1cmVMYW5nQ29kZUZvcm1hdCIsInRocmVhZHNTdG9yZSIsInBvc3RzU3RvcmUiLCJhZGRUaHJlYWQiLCJhZGRQb3N0IiwiZGVidWdEYXRhU3RvcmUiLCJnZXRUaHJlYWRXaXRoUG9zdHMiLCJnZXRDYWNoZWRUcmFuc2xhdGlvbiIsInNldENhY2hlZFRyYW5zbGF0aW9uIiwiZXJyb3IiLCJjb25zb2xlIiwidHJhbnNsYXRlQ29udGVudCIsInRleHQiLCJ0YXJnZXRMYW5nIiwic291cmNlTGFuZyIsImNvbnRlbnRJZCIsImZpZWxkIiwibG9nIiwibm9ybWFsaXplZFNvdXJjZUxhbmciLCJub3JtYWxpemVkVGFyZ2V0TGFuZyIsImxvZ1RleHQiLCJzdWJzdHJpbmciLCJjYWNoZUtleUNvbnRlbnRJZCIsImNhY2hlS2V5IiwiY2FjaGVkIiwibG9nQ2FjaGVkIiwiZWZmZWN0aXZlU291cmNlTGFuZyIsImxvZ1RleHRGb3JSZXF1ZXN0IiwidHJhbnNsYXRlZFRleHQiLCJsb2dPcmlnaW5hbFRleHQiLCJsb2dUcmFuc2xhdGVkIiwiaGFuZGxlciIsInJlcSIsInJlcyIsImlkIiwicXVlcnkiLCJ1aUxhbmdQYXJhbSIsImxhbmciLCJ1aUxhbmciLCJtZXRob2QiLCJ0aHJlYWREYXRhIiwic3RhdHVzIiwianNvbiIsInRocmVhZE9yaWdpbmFsTGFuZ1N0b3JlZCIsInRocmVhZE9yaWdpbmFsTGFuZyIsInRocmVhZCIsInRpdGxlIiwicG9zdHMiLCJsZW5ndGgiLCJQcm9taXNlIiwiYWxsIiwibWFwIiwicG9zdCIsIndhcm4iLCJib2R5IiwicG9zdE9yaWdpbmFsTGFuZ1N0b3JlZCIsIm9yaWdpbmFsX2xhbmciLCJwb3N0T3JpZ2luYWxMYW5nIiwiZGV0ZWN0ZWQiLCJlIiwidHJhbnNsYXRlZEJvZHkiLCJ0cmFuc2xhdGVkX3RvIiwibWVzc2FnZSIsInN0YWNrIiwiZGV0YWlscyIsInNldEhlYWRlciJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./pages/api/threads/[id].js\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fthreads%2F%5Bid%5D&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cthreads%5C%5Bid%5D.js&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();