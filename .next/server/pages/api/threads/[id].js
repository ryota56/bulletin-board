"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/threads/[id]";
exports.ids = ["pages/api/threads/[id]"];
exports.modules = {

/***/ "@supabase/supabase-js":
/*!****************************************!*\
  !*** external "@supabase/supabase-js" ***!
  \****************************************/
/***/ ((module) => {

module.exports = require("@supabase/supabase-js");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fthreads%2F%5Bid%5D&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cthreads%5C%5Bid%5D.js&middlewareConfigBase64=e30%3D!":
/*!******************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fthreads%2F%5Bid%5D&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cthreads%5C%5Bid%5D.js&middlewareConfigBase64=e30%3D! ***!
  \******************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_threads_id_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages\\api\\threads\\[id].js */ \"(api)/./pages/api/threads/[id].js\");\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_threads_id_js__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_threads_id_js__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/threads/[id]\",\n        pathname: \"/api/threads/[id]\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _pages_api_threads_id_js__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRnRocmVhZHMlMkYlNUJpZCU1RCZwcmVmZXJyZWRSZWdpb249JmFic29sdXRlUGFnZVBhdGg9LiUyRnBhZ2VzJTVDYXBpJTVDdGhyZWFkcyU1QyU1QmlkJTVELmpzJm1pZGRsZXdhcmVDb25maWdCYXNlNjQ9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNMO0FBQzFEO0FBQzJEO0FBQzNEO0FBQ0EsaUVBQWUsd0VBQUssQ0FBQyxxREFBUSxZQUFZLEVBQUM7QUFDMUM7QUFDTyxlQUFlLHdFQUFLLENBQUMscURBQVE7QUFDcEM7QUFDTyx3QkFBd0IsZ0hBQW1CO0FBQ2xEO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLFlBQVk7QUFDWixDQUFDOztBQUVEIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vNWNoLz81ZmVjIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFBhZ2VzQVBJUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9wYWdlcy1hcGkvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgaG9pc3QgfSBmcm9tIFwibmV4dC9kaXN0L2J1aWxkL3RlbXBsYXRlcy9oZWxwZXJzXCI7XG4vLyBJbXBvcnQgdGhlIHVzZXJsYW5kIGNvZGUuXG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiLi9wYWdlc1xcXFxhcGlcXFxcdGhyZWFkc1xcXFxbaWRdLmpzXCI7XG4vLyBSZS1leHBvcnQgdGhlIGhhbmRsZXIgKHNob3VsZCBiZSB0aGUgZGVmYXVsdCBleHBvcnQpLlxuZXhwb3J0IGRlZmF1bHQgaG9pc3QodXNlcmxhbmQsIFwiZGVmYXVsdFwiKTtcbi8vIFJlLWV4cG9ydCBjb25maWcuXG5leHBvcnQgY29uc3QgY29uZmlnID0gaG9pc3QodXNlcmxhbmQsIFwiY29uZmlnXCIpO1xuLy8gQ3JlYXRlIGFuZCBleHBvcnQgdGhlIHJvdXRlIG1vZHVsZSB0aGF0IHdpbGwgYmUgY29uc3VtZWQuXG5leHBvcnQgY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgUGFnZXNBUElSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuUEFHRVNfQVBJLFxuICAgICAgICBwYWdlOiBcIi9hcGkvdGhyZWFkcy9baWRdXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvdGhyZWFkcy9baWRdXCIsXG4gICAgICAgIC8vIFRoZSBmb2xsb3dpbmcgYXJlbid0IHVzZWQgaW4gcHJvZHVjdGlvbi5cbiAgICAgICAgYnVuZGxlUGF0aDogXCJcIixcbiAgICAgICAgZmlsZW5hbWU6IFwiXCJcbiAgICB9LFxuICAgIHVzZXJsYW5kXG59KTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cGFnZXMtYXBpLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fthreads%2F%5Bid%5D&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cthreads%5C%5Bid%5D.js&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./lib/cache.js":
/*!**********************!*\
  !*** ./lib/cache.js ***!
  \**********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   clearCachedTranslations: () => (/* binding */ clearCachedTranslations),\n/* harmony export */   getAllCachedTranslations: () => (/* binding */ getAllCachedTranslations),\n/* harmony export */   getCachedTranslation: () => (/* binding */ getCachedTranslation),\n/* harmony export */   setCachedTranslation: () => (/* binding */ setCachedTranslation)\n/* harmony export */ });\n// 翻訳キャッシュを管理するシンプルなユーティリティ\n// メモリ内キャッシュとしてシンプルに実装。必要に応じてRedisやSupabaseなどに置き換え可能\n// メモリ内キャッシュオブジェクト（サーバーリスタートでリセットされる）\nif (!global.translationCache) {\n    global.translationCache = {};\n}\nconst cache = global.translationCache;\n/**\r\n * キャッシュキーを生成\r\n * @param {string} sourceId - 翻訳元コンテンツのID\r\n * @param {string} field - 翻訳するフィールド名（title, bodyなど）\r\n * @param {string} targetLang - 翻訳先言語\r\n * @returns {string} キャッシュキー\r\n */ const generateCacheKey = (sourceId, field, targetLang)=>{\n    return `${sourceId}_${field}_${targetLang}`;\n};\n/**\r\n * 翻訳をキャッシュから取得\r\n * @param {string} sourceId - 翻訳元コンテンツのID\r\n * @param {string} field - 翻訳するフィールド名（title, bodyなど）\r\n * @param {string} targetLang - 翻訳先言語\r\n * @returns {string|null} キャッシュされた翻訳テキスト、なければnull\r\n */ function getCachedTranslation(sourceId, field, targetLang) {\n    const key = generateCacheKey(sourceId, field, targetLang);\n    const cached = cache[key];\n    if (cached) {\n        // キャッシュヒット数を記録（オプション）\n        cache[`${key}_hits`] = (cache[`${key}_hits`] || 0) + 1;\n    }\n    return cached || null;\n}\n/**\r\n * 翻訳をキャッシュに保存\r\n * @param {string} sourceId - 翻訳元コンテンツのID\r\n * @param {string} field - 翻訳するフィールド名（title, bodyなど）\r\n * @param {string} targetLang - 翻訳先言語\r\n * @param {string} text - 翻訳テキスト\r\n */ function setCachedTranslation(sourceId, field, targetLang, text) {\n    if (!text) return;\n    const key = generateCacheKey(sourceId, field, targetLang);\n    cache[key] = text;\n    // 最終更新時間を記録（オプション）\n    cache[`${key}_updated`] = Date.now();\n}\n/**\r\n * キャッシュ内のすべての翻訳を取得（デバッグ用）\r\n */ function getAllCachedTranslations() {\n    return {\n        ...cache\n    };\n}\n/**\r\n * 特定の条件に一致するキャッシュエントリをすべて削除\r\n * @param {object} filters - フィルター条件\r\n * @param {string} [filters.sourceId] - 特定のソースIDに関連するキャッシュのみ削除\r\n * @param {string} [filters.field] - 特定のフィールドに関連するキャッシュのみ削除\r\n * @param {string} [filters.targetLang] - 特定の言語に関連するキャッシュのみ削除\r\n */ function clearCachedTranslations(filters = {}) {\n    const { sourceId, field, targetLang } = filters;\n    Object.keys(cache).forEach((key)=>{\n        // メタデータキー（_hitsや_updatedで終わるもの）はスキップ\n        if (key.endsWith(\"_hits\") || key.endsWith(\"_updated\")) return;\n        const [keySourceId, keyField, keyLang] = key.split(\"_\");\n        // フィルター条件に基づいてキャッシュエントリを削除\n        if (sourceId && keySourceId !== sourceId || field && keyField !== field || targetLang && keyLang !== targetLang) {\n            return; // フィルター条件に一致しない場合はスキップ\n        }\n        // フィルター条件に一致する場合、キャッシュエントリとそのメタデータを削除\n        delete cache[key];\n        delete cache[`${key}_hits`];\n        delete cache[`${key}_updated`];\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9saWIvY2FjaGUuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBLDJCQUEyQjtBQUMzQixvREFBb0Q7QUFFcEQscUNBQXFDO0FBQ3JDLElBQUksQ0FBQ0EsT0FBT0MsZ0JBQWdCLEVBQUU7SUFDNUJELE9BQU9DLGdCQUFnQixHQUFHLENBQUM7QUFDN0I7QUFFQSxNQUFNQyxRQUFRRixPQUFPQyxnQkFBZ0I7QUFFckM7Ozs7OztDQU1DLEdBQ0QsTUFBTUUsbUJBQW1CLENBQUNDLFVBQVVDLE9BQU9DO0lBQ3pDLE9BQU8sQ0FBQyxFQUFFRixTQUFTLENBQUMsRUFBRUMsTUFBTSxDQUFDLEVBQUVDLFdBQVcsQ0FBQztBQUM3QztBQUVBOzs7Ozs7Q0FNQyxHQUNNLFNBQVNDLHFCQUFxQkgsUUFBUSxFQUFFQyxLQUFLLEVBQUVDLFVBQVU7SUFDOUQsTUFBTUUsTUFBTUwsaUJBQWlCQyxVQUFVQyxPQUFPQztJQUM5QyxNQUFNRyxTQUFTUCxLQUFLLENBQUNNLElBQUk7SUFFekIsSUFBSUMsUUFBUTtRQUNWLHNCQUFzQjtRQUN0QlAsS0FBSyxDQUFDLENBQUMsRUFBRU0sSUFBSSxLQUFLLENBQUMsQ0FBQyxHQUFHLENBQUNOLEtBQUssQ0FBQyxDQUFDLEVBQUVNLElBQUksS0FBSyxDQUFDLENBQUMsSUFBSSxLQUFLO0lBQ3ZEO0lBRUEsT0FBT0MsVUFBVTtBQUNuQjtBQUVBOzs7Ozs7Q0FNQyxHQUNNLFNBQVNDLHFCQUFxQk4sUUFBUSxFQUFFQyxLQUFLLEVBQUVDLFVBQVUsRUFBRUssSUFBSTtJQUNwRSxJQUFJLENBQUNBLE1BQU07SUFFWCxNQUFNSCxNQUFNTCxpQkFBaUJDLFVBQVVDLE9BQU9DO0lBQzlDSixLQUFLLENBQUNNLElBQUksR0FBR0c7SUFDYixtQkFBbUI7SUFDbkJULEtBQUssQ0FBQyxDQUFDLEVBQUVNLElBQUksUUFBUSxDQUFDLENBQUMsR0FBR0ksS0FBS0MsR0FBRztBQUNwQztBQUVBOztDQUVDLEdBQ00sU0FBU0M7SUFDZCxPQUFPO1FBQUUsR0FBR1osS0FBSztJQUFDO0FBQ3BCO0FBRUE7Ozs7OztDQU1DLEdBQ00sU0FBU2Esd0JBQXdCQyxVQUFVLENBQUMsQ0FBQztJQUNsRCxNQUFNLEVBQUVaLFFBQVEsRUFBRUMsS0FBSyxFQUFFQyxVQUFVLEVBQUUsR0FBR1U7SUFFeENDLE9BQU9DLElBQUksQ0FBQ2hCLE9BQU9pQixPQUFPLENBQUNYLENBQUFBO1FBQ3pCLHFDQUFxQztRQUNyQyxJQUFJQSxJQUFJWSxRQUFRLENBQUMsWUFBWVosSUFBSVksUUFBUSxDQUFDLGFBQWE7UUFFdkQsTUFBTSxDQUFDQyxhQUFhQyxVQUFVQyxRQUFRLEdBQUdmLElBQUlnQixLQUFLLENBQUM7UUFFbkQsMkJBQTJCO1FBQzNCLElBQ0UsWUFBYUgsZ0JBQWdCakIsWUFDNUJDLFNBQVNpQixhQUFhakIsU0FDdEJDLGNBQWNpQixZQUFZakIsWUFDM0I7WUFDQSxRQUFRLHVCQUF1QjtRQUNqQztRQUVBLHNDQUFzQztRQUN0QyxPQUFPSixLQUFLLENBQUNNLElBQUk7UUFDakIsT0FBT04sS0FBSyxDQUFDLENBQUMsRUFBRU0sSUFBSSxLQUFLLENBQUMsQ0FBQztRQUMzQixPQUFPTixLQUFLLENBQUMsQ0FBQyxFQUFFTSxJQUFJLFFBQVEsQ0FBQyxDQUFDO0lBQ2hDO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly81Y2gvLi9saWIvY2FjaGUuanM/ZjU0MyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyDnv7voqLPjgq3jg6Pjg4Pjgrfjg6XjgpLnrqHnkIbjgZnjgovjgrfjg7Pjg5fjg6vjgarjg6bjg7zjg4bjgqPjg6rjg4bjgqNcclxuLy8g44Oh44Oi44Oq5YaF44Kt44Oj44OD44K344Ol44Go44GX44Gm44K344Oz44OX44Or44Gr5a6f6KOF44CC5b+F6KaB44Gr5b+c44GY44GmUmVkaXPjgoRTdXBhYmFzZeOBquOBqeOBq+e9ruOBjeaPm+OBiOWPr+iDvVxyXG5cclxuLy8g44Oh44Oi44Oq5YaF44Kt44Oj44OD44K344Ol44Kq44OW44K444Kn44Kv44OI77yI44K144O844OQ44O844Oq44K544K/44O844OI44Gn44Oq44K744OD44OI44GV44KM44KL77yJXHJcbmlmICghZ2xvYmFsLnRyYW5zbGF0aW9uQ2FjaGUpIHtcclxuICBnbG9iYWwudHJhbnNsYXRpb25DYWNoZSA9IHt9O1xyXG59XHJcblxyXG5jb25zdCBjYWNoZSA9IGdsb2JhbC50cmFuc2xhdGlvbkNhY2hlO1xyXG5cclxuLyoqXHJcbiAqIOOCreODo+ODg+OCt+ODpeOCreODvOOCkueUn+aIkFxyXG4gKiBAcGFyYW0ge3N0cmluZ30gc291cmNlSWQgLSDnv7voqLPlhYPjgrPjg7Pjg4bjg7Pjg4Tjga5JRFxyXG4gKiBAcGFyYW0ge3N0cmluZ30gZmllbGQgLSDnv7voqLPjgZnjgovjg5XjgqPjg7zjg6vjg4nlkI3vvIh0aXRsZSwgYm9keeOBquOBqe+8iVxyXG4gKiBAcGFyYW0ge3N0cmluZ30gdGFyZ2V0TGFuZyAtIOe/u+ios+WFiOiogOiqnlxyXG4gKiBAcmV0dXJucyB7c3RyaW5nfSDjgq3jg6Pjg4Pjgrfjg6Xjgq3jg7xcclxuICovXHJcbmNvbnN0IGdlbmVyYXRlQ2FjaGVLZXkgPSAoc291cmNlSWQsIGZpZWxkLCB0YXJnZXRMYW5nKSA9PiB7XHJcbiAgcmV0dXJuIGAke3NvdXJjZUlkfV8ke2ZpZWxkfV8ke3RhcmdldExhbmd9YDtcclxufTtcclxuXHJcbi8qKlxyXG4gKiDnv7voqLPjgpLjgq3jg6Pjg4Pjgrfjg6XjgYvjgonlj5blvpdcclxuICogQHBhcmFtIHtzdHJpbmd9IHNvdXJjZUlkIC0g57+76Kiz5YWD44Kz44Oz44OG44Oz44OE44GuSURcclxuICogQHBhcmFtIHtzdHJpbmd9IGZpZWxkIC0g57+76Kiz44GZ44KL44OV44Kj44O844Or44OJ5ZCN77yIdGl0bGUsIGJvZHnjgarjganvvIlcclxuICogQHBhcmFtIHtzdHJpbmd9IHRhcmdldExhbmcgLSDnv7voqLPlhYjoqIDoqp5cclxuICogQHJldHVybnMge3N0cmluZ3xudWxsfSDjgq3jg6Pjg4Pjgrfjg6XjgZXjgozjgZ/nv7voqLPjg4bjgq3jgrnjg4jjgIHjgarjgZHjgozjgbBudWxsXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZ2V0Q2FjaGVkVHJhbnNsYXRpb24oc291cmNlSWQsIGZpZWxkLCB0YXJnZXRMYW5nKSB7XHJcbiAgY29uc3Qga2V5ID0gZ2VuZXJhdGVDYWNoZUtleShzb3VyY2VJZCwgZmllbGQsIHRhcmdldExhbmcpO1xyXG4gIGNvbnN0IGNhY2hlZCA9IGNhY2hlW2tleV07XHJcbiAgXHJcbiAgaWYgKGNhY2hlZCkge1xyXG4gICAgLy8g44Kt44Oj44OD44K344Ol44OS44OD44OI5pWw44KS6KiY6Yyy77yI44Kq44OX44K344On44Oz77yJXHJcbiAgICBjYWNoZVtgJHtrZXl9X2hpdHNgXSA9IChjYWNoZVtgJHtrZXl9X2hpdHNgXSB8fCAwKSArIDE7XHJcbiAgfVxyXG4gIFxyXG4gIHJldHVybiBjYWNoZWQgfHwgbnVsbDtcclxufVxyXG5cclxuLyoqXHJcbiAqIOe/u+ios+OCkuOCreODo+ODg+OCt+ODpeOBq+S/neWtmFxyXG4gKiBAcGFyYW0ge3N0cmluZ30gc291cmNlSWQgLSDnv7voqLPlhYPjgrPjg7Pjg4bjg7Pjg4Tjga5JRFxyXG4gKiBAcGFyYW0ge3N0cmluZ30gZmllbGQgLSDnv7voqLPjgZnjgovjg5XjgqPjg7zjg6vjg4nlkI3vvIh0aXRsZSwgYm9keeOBquOBqe+8iVxyXG4gKiBAcGFyYW0ge3N0cmluZ30gdGFyZ2V0TGFuZyAtIOe/u+ios+WFiOiogOiqnlxyXG4gKiBAcGFyYW0ge3N0cmluZ30gdGV4dCAtIOe/u+ios+ODhuOCreOCueODiFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHNldENhY2hlZFRyYW5zbGF0aW9uKHNvdXJjZUlkLCBmaWVsZCwgdGFyZ2V0TGFuZywgdGV4dCkge1xyXG4gIGlmICghdGV4dCkgcmV0dXJuO1xyXG4gIFxyXG4gIGNvbnN0IGtleSA9IGdlbmVyYXRlQ2FjaGVLZXkoc291cmNlSWQsIGZpZWxkLCB0YXJnZXRMYW5nKTtcclxuICBjYWNoZVtrZXldID0gdGV4dDtcclxuICAvLyDmnIDntYLmm7TmlrDmmYLplpPjgpLoqJjpjLLvvIjjgqrjg5fjgrfjg6fjg7PvvIlcclxuICBjYWNoZVtgJHtrZXl9X3VwZGF0ZWRgXSA9IERhdGUubm93KCk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiDjgq3jg6Pjg4Pjgrfjg6XlhoXjga7jgZnjgbnjgabjga7nv7voqLPjgpLlj5blvpfvvIjjg4fjg5Djg4PjgrDnlKjvvIlcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRBbGxDYWNoZWRUcmFuc2xhdGlvbnMoKSB7XHJcbiAgcmV0dXJuIHsgLi4uY2FjaGUgfTtcclxufVxyXG5cclxuLyoqXHJcbiAqIOeJueWumuOBruadoeS7tuOBq+S4gOiHtOOBmeOCi+OCreODo+ODg+OCt+ODpeOCqOODs+ODiOODquOCkuOBmeOBueOBpuWJiumZpFxyXG4gKiBAcGFyYW0ge29iamVjdH0gZmlsdGVycyAtIOODleOCo+ODq+OCv+ODvOadoeS7tlxyXG4gKiBAcGFyYW0ge3N0cmluZ30gW2ZpbHRlcnMuc291cmNlSWRdIC0g54m55a6a44Gu44K944O844K5SUTjgavplqLpgKPjgZnjgovjgq3jg6Pjg4Pjgrfjg6Xjga7jgb/liYrpmaRcclxuICogQHBhcmFtIHtzdHJpbmd9IFtmaWx0ZXJzLmZpZWxkXSAtIOeJueWumuOBruODleOCo+ODvOODq+ODieOBq+mWoumAo+OBmeOCi+OCreODo+ODg+OCt+ODpeOBruOBv+WJiumZpFxyXG4gKiBAcGFyYW0ge3N0cmluZ30gW2ZpbHRlcnMudGFyZ2V0TGFuZ10gLSDnibnlrprjga7oqIDoqp7jgavplqLpgKPjgZnjgovjgq3jg6Pjg4Pjgrfjg6Xjga7jgb/liYrpmaRcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBjbGVhckNhY2hlZFRyYW5zbGF0aW9ucyhmaWx0ZXJzID0ge30pIHtcclxuICBjb25zdCB7IHNvdXJjZUlkLCBmaWVsZCwgdGFyZ2V0TGFuZyB9ID0gZmlsdGVycztcclxuICBcclxuICBPYmplY3Qua2V5cyhjYWNoZSkuZm9yRWFjaChrZXkgPT4ge1xyXG4gICAgLy8g44Oh44K/44OH44O844K/44Kt44O877yIX2hpdHPjgoRfdXBkYXRlZOOBp+e1guOCj+OCi+OCguOBru+8ieOBr+OCueOCreODg+ODl1xyXG4gICAgaWYgKGtleS5lbmRzV2l0aCgnX2hpdHMnKSB8fCBrZXkuZW5kc1dpdGgoJ191cGRhdGVkJykpIHJldHVybjtcclxuICAgIFxyXG4gICAgY29uc3QgW2tleVNvdXJjZUlkLCBrZXlGaWVsZCwga2V5TGFuZ10gPSBrZXkuc3BsaXQoJ18nKTtcclxuICAgIFxyXG4gICAgLy8g44OV44Kj44Or44K/44O85p2h5Lu244Gr5Z+644Gl44GE44Gm44Kt44Oj44OD44K344Ol44Ko44Oz44OI44Oq44KS5YmK6ZmkXHJcbiAgICBpZiAoXHJcbiAgICAgIChzb3VyY2VJZCAmJiBrZXlTb3VyY2VJZCAhPT0gc291cmNlSWQpIHx8XHJcbiAgICAgIChmaWVsZCAmJiBrZXlGaWVsZCAhPT0gZmllbGQpIHx8XHJcbiAgICAgICh0YXJnZXRMYW5nICYmIGtleUxhbmcgIT09IHRhcmdldExhbmcpXHJcbiAgICApIHtcclxuICAgICAgcmV0dXJuOyAvLyDjg5XjgqPjg6vjgr/jg7zmnaHku7bjgavkuIDoh7TjgZfjgarjgYTloLTlkIjjga/jgrnjgq3jg4Pjg5dcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8g44OV44Kj44Or44K/44O85p2h5Lu244Gr5LiA6Ie044GZ44KL5aC05ZCI44CB44Kt44Oj44OD44K344Ol44Ko44Oz44OI44Oq44Go44Gd44Gu44Oh44K/44OH44O844K/44KS5YmK6ZmkXHJcbiAgICBkZWxldGUgY2FjaGVba2V5XTtcclxuICAgIGRlbGV0ZSBjYWNoZVtgJHtrZXl9X2hpdHNgXTtcclxuICAgIGRlbGV0ZSBjYWNoZVtgJHtrZXl9X3VwZGF0ZWRgXTtcclxuICB9KTtcclxufSAiXSwibmFtZXMiOlsiZ2xvYmFsIiwidHJhbnNsYXRpb25DYWNoZSIsImNhY2hlIiwiZ2VuZXJhdGVDYWNoZUtleSIsInNvdXJjZUlkIiwiZmllbGQiLCJ0YXJnZXRMYW5nIiwiZ2V0Q2FjaGVkVHJhbnNsYXRpb24iLCJrZXkiLCJjYWNoZWQiLCJzZXRDYWNoZWRUcmFuc2xhdGlvbiIsInRleHQiLCJEYXRlIiwibm93IiwiZ2V0QWxsQ2FjaGVkVHJhbnNsYXRpb25zIiwiY2xlYXJDYWNoZWRUcmFuc2xhdGlvbnMiLCJmaWx0ZXJzIiwiT2JqZWN0Iiwia2V5cyIsImZvckVhY2giLCJlbmRzV2l0aCIsImtleVNvdXJjZUlkIiwia2V5RmllbGQiLCJrZXlMYW5nIiwic3BsaXQiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./lib/cache.js\n");

/***/ }),

/***/ "(api)/./lib/dataStore.js":
/*!**************************!*\
  !*** ./lib/dataStore.js ***!
  \**************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   addPost: () => (/* binding */ addPost),\n/* harmony export */   addThread: () => (/* binding */ addThread),\n/* harmony export */   debugDataStore: () => (/* binding */ debugDataStore),\n/* harmony export */   getThreadWithPosts: () => (/* binding */ getThreadWithPosts),\n/* harmony export */   postsStore: () => (/* binding */ postsStore),\n/* harmony export */   threadsStore: () => (/* binding */ threadsStore)\n/* harmony export */ });\n/**\r\n * サーバーサイドで共有するデータストア\r\n * Next.jsの開発サーバーでAPIエンドポイント間でデータを共有するために使用\r\n */ // グローバル変数として保存するためのヘルパー\nif (!global.threadsStore) {\n    global.threadsStore = [\n        {\n            thread_id: \"1\",\n            title: \"サンプルスレッド1\",\n            description: \"このスレッドはサンプルです。自由に投稿してください。\",\n            created_at: new Date().toISOString(),\n            updated_at: new Date().toISOString(),\n            language: \"ja\"\n        },\n        {\n            thread_id: \"2\",\n            title: \"サンプルスレッド2\",\n            description: \"2つ目のサンプルスレッドです。質問や意見を投稿してください。\",\n            created_at: new Date(Date.now() - 86400000).toISOString(),\n            updated_at: new Date(Date.now() - 3600000).toISOString(),\n            language: \"ja\"\n        },\n        {\n            thread_id: \"3\",\n            title: \"プログラミングについての議論\",\n            description: \"プログラミングに関する質問や情報共有のためのスレッドです。コードの書き方や開発環境についての話題を投稿してください。\",\n            created_at: new Date(Date.now() - 172800000).toISOString(),\n            updated_at: new Date(Date.now() - 5400000).toISOString(),\n            language: \"ja\"\n        }\n    ];\n}\nif (!global.postsStore) {\n    global.postsStore = {\n        \"1\": [\n            {\n                post_id: \"1_1\",\n                thread_id: \"1\",\n                body: \"最初の投稿です\",\n                anonymous_id: \"匿名123\",\n                created_at: new Date(Date.now() - 3600000).toISOString(),\n                language: \"ja\"\n            },\n            {\n                post_id: \"1_2\",\n                thread_id: \"1\",\n                body: \"返信です\",\n                anonymous_id: \"匿名456\",\n                created_at: new Date().toISOString(),\n                language: \"ja\"\n            }\n        ],\n        \"2\": [\n            {\n                post_id: \"2_1\",\n                thread_id: \"2\",\n                body: \"別のスレッドの投稿です\",\n                anonymous_id: \"匿名789\",\n                created_at: new Date(Date.now() - 2400000).toISOString(),\n                language: \"ja\"\n            }\n        ],\n        \"3\": [\n            {\n                post_id: \"3_1\",\n                thread_id: \"3\",\n                body: \"プログラミングについて話しましょう\",\n                anonymous_id: \"匿名101\",\n                created_at: new Date(Date.now() - 172000000).toISOString(),\n                language: \"ja\"\n            }\n        ]\n    };\n}\n// スレッドデータ保存用配列をエクスポート\nconst threadsStore = global.threadsStore;\n// 投稿データ保存用オブジェクトをエクスポート\nconst postsStore = global.postsStore;\n// 新しいスレッドを追加するユーティリティ関数\nfunction addThread(thread) {\n    // 既存のスレッドを確認（重複追加防止）\n    const existingThread = threadsStore.find((t)=>t.thread_id === thread.thread_id);\n    if (!existingThread) {\n        threadsStore.push({\n            ...thread\n        }); // オブジェクトをコピーして追加\n        console.log(`スレッド追加: ID=${thread.thread_id}, タイトル=\"${thread.title}\"`);\n        console.log(\"現在のスレッド一覧:\", threadsStore.map((t)=>t.thread_id));\n    }\n}\n// 新しい投稿を追加するユーティリティ関数\nfunction addPost(threadId, post) {\n    if (!postsStore[threadId]) {\n        postsStore[threadId] = [];\n    }\n    postsStore[threadId].push({\n        id: post.post_id,\n        threadId,\n        body: post.body,\n        anonymous_id: post.anonymous_id,\n        language: post.language,\n        createdAt: post.created_at || new Date().toISOString()\n    });\n    console.log(`投稿追加: スレッドID=${threadId}, 投稿ID=${post.post_id}, 匿名ID=${post.anonymous_id}`);\n}\n// デバッグ用：データストアの内容を表示\nfunction debugDataStore() {\n    console.log(\"===== データストア内容 =====\");\n    console.log(\"スレッド数:\", threadsStore.length);\n    console.log(\"スレッドID一覧:\", threadsStore.map((t)=>t.thread_id));\n    console.log(\"投稿数:\", Object.keys(postsStore).length);\n    console.log(\"==========================\");\n}\n/**\r\n * スレッドと投稿を一度に取得\r\n * @param {string} threadId - スレッドID\r\n * @returns {object|null} スレッドと投稿の情報、見つからない場合はnull\r\n */ function getThreadWithPosts(threadId) {\n    // スレッドをメモリから取得\n    const thread = threadsStore.find((t)=>t.thread_id === threadId);\n    if (!thread) {\n        console.log(`スレッド未発見: ID=${threadId}`);\n        return null;\n    }\n    // 投稿をメモリから取得\n    const posts = postsStore[threadId] || [];\n    // 投稿データを整形\n    const formattedPosts = posts.map((post)=>({\n            id: post.post_id || post.id,\n            body: post.body,\n            anonymous_id: post.anonymous_id || \"匿名ユーザー\",\n            thread_id: post.thread_id,\n            created_at: post.created_at || post.createdAt,\n            original_lang: post.language,\n            translated_to: null // 翻訳先言語（後で設定）\n        }));\n    return {\n        thread: {\n            ...thread,\n            id: thread.thread_id\n        },\n        posts: formattedPosts,\n        lang: thread.language // スレッドの言語\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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S0FBS1osWUFBWSxJQUFJO1lBQ25DWixXQUFXd0IsS0FBS3hCLFNBQVM7WUFDekJHLFlBQVlxQixLQUFLckIsVUFBVSxJQUFJcUIsS0FBS0UsU0FBUztZQUM3Q1EsZUFBZVYsS0FBS2pCLFFBQVE7WUFDNUI0QixlQUFlLEtBQUssY0FBYztRQUNwQztJQUVBLE9BQU87UUFDTHJCLFFBQVE7WUFDTixHQUFHQSxNQUFNO1lBQ1RXLElBQUlYLE9BQU9kLFNBQVM7UUFDdEI7UUFDQWdDLE9BQU9DO1FBQ1BHLE1BQU10QixPQUFPUCxRQUFRLENBQUMsVUFBVTtJQUNsQztBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vNWNoLy4vbGliL2RhdGFTdG9yZS5qcz81ZDFmIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiDjgrXjg7zjg5Djg7zjgrXjgqTjg4njgaflhbHmnInjgZnjgovjg4fjg7zjgr/jgrnjg4jjgqJcclxuICogTmV4dC5qc+OBrumWi+eZuuOCteODvOODkOODvOOBp0FQSeOCqOODs+ODieODneOCpOODs+ODiOmWk+OBp+ODh+ODvOOCv+OCkuWFseacieOBmeOCi+OBn+OCgeOBq+S9v+eUqFxyXG4gKi9cclxuXHJcbi8vIOOCsOODreODvOODkOODq+WkieaVsOOBqOOBl+OBpuS/neWtmOOBmeOCi+OBn+OCgeOBruODmOODq+ODkeODvFxyXG5pZiAoIWdsb2JhbC50aHJlYWRzU3RvcmUpIHtcclxuICBnbG9iYWwudGhyZWFkc1N0b3JlID0gW1xyXG4gICAge1xyXG4gICAgICB0aHJlYWRfaWQ6ICcxJyxcclxuICAgICAgdGl0bGU6ICfjgrXjg7Pjg5fjg6vjgrnjg6zjg4Pjg4kxJyxcclxuICAgICAgZGVzY3JpcHRpb246ICfjgZPjga7jgrnjg6zjg4Pjg4njga/jgrXjg7Pjg5fjg6vjgafjgZnjgILoh6rnlLHjgavmipXnqL/jgZfjgabjgY/jgaDjgZXjgYTjgIInLFxyXG4gICAgICBjcmVhdGVkX2F0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXHJcbiAgICAgIHVwZGF0ZWRfYXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcclxuICAgICAgbGFuZ3VhZ2U6ICdqYSdcclxuICAgIH0sXHJcbiAgICB7XHJcbiAgICAgIHRocmVhZF9pZDogJzInLFxyXG4gICAgICB0aXRsZTogJ+OCteODs+ODl+ODq+OCueODrOODg+ODiTInLFxyXG4gICAgICBkZXNjcmlwdGlvbjogJzLjgaTnm67jga7jgrXjg7Pjg5fjg6vjgrnjg6zjg4Pjg4njgafjgZnjgILos6rllY/jgoTmhI/opovjgpLmipXnqL/jgZfjgabjgY/jgaDjgZXjgYTjgIInLFxyXG4gICAgICBjcmVhdGVkX2F0OiBuZXcgRGF0ZShEYXRlLm5vdygpIC0gODY0MDAwMDApLnRvSVNPU3RyaW5nKCksXHJcbiAgICAgIHVwZGF0ZWRfYXQ6IG5ldyBEYXRlKERhdGUubm93KCkgLSAzNjAwMDAwKS50b0lTT1N0cmluZygpLFxyXG4gICAgICBsYW5ndWFnZTogJ2phJ1xyXG4gICAgfSxcclxuICAgIHtcclxuICAgICAgdGhyZWFkX2lkOiAnMycsXHJcbiAgICAgIHRpdGxlOiAn44OX44Ot44Kw44Op44Of44Oz44Kw44Gr44Gk44GE44Gm44Gu6K2w6KuWJyxcclxuICAgICAgZGVzY3JpcHRpb246ICfjg5fjg63jgrDjg6njg5/jg7PjgrDjgavplqLjgZnjgovos6rllY/jgoTmg4XloLHlhbHmnInjga7jgZ/jgoHjga7jgrnjg6zjg4Pjg4njgafjgZnjgILjgrPjg7zjg4njga7mm7jjgY3mlrnjgoTplovnmbrnkrDlooPjgavjgaTjgYTjgabjga7oqbHpoYzjgpLmipXnqL/jgZfjgabjgY/jgaDjgZXjgYTjgIInLFxyXG4gICAgICBjcmVhdGVkX2F0OiBuZXcgRGF0ZShEYXRlLm5vdygpIC0gMTcyODAwMDAwKS50b0lTT1N0cmluZygpLFxyXG4gICAgICB1cGRhdGVkX2F0OiBuZXcgRGF0ZShEYXRlLm5vdygpIC0gNTQwMDAwMCkudG9JU09TdHJpbmcoKSxcclxuICAgICAgbGFuZ3VhZ2U6ICdqYSdcclxuICAgIH1cclxuICBdO1xyXG59XHJcblxyXG5pZiAoIWdsb2JhbC5wb3N0c1N0b3JlKSB7XHJcbiAgZ2xvYmFsLnBvc3RzU3RvcmUgPSB7XHJcbiAgICAnMSc6IFtcclxuICAgICAge1xyXG4gICAgICAgIHBvc3RfaWQ6ICcxXzEnLFxyXG4gICAgICAgIHRocmVhZF9pZDogJzEnLFxyXG4gICAgICAgIGJvZHk6ICfmnIDliJ3jga7mipXnqL/jgafjgZknLFxyXG4gICAgICAgIGFub255bW91c19pZDogJ+WMv+WQjTEyMycsXHJcbiAgICAgICAgY3JlYXRlZF9hdDogbmV3IERhdGUoRGF0ZS5ub3coKSAtIDM2MDAwMDApLnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgbGFuZ3VhZ2U6ICdqYSdcclxuICAgICAgfSxcclxuICAgICAge1xyXG4gICAgICAgIHBvc3RfaWQ6ICcxXzInLFxyXG4gICAgICAgIHRocmVhZF9pZDogJzEnLFxyXG4gICAgICAgIGJvZHk6ICfov5Tkv6HjgafjgZknLFxyXG4gICAgICAgIGFub255bW91c19pZDogJ+WMv+WQjTQ1NicsXHJcbiAgICAgICAgY3JlYXRlZF9hdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxyXG4gICAgICAgIGxhbmd1YWdlOiAnamEnXHJcbiAgICAgIH1cclxuICAgIF0sXHJcbiAgICAnMic6IFtcclxuICAgICAge1xyXG4gICAgICAgIHBvc3RfaWQ6ICcyXzEnLFxyXG4gICAgICAgIHRocmVhZF9pZDogJzInLFxyXG4gICAgICAgIGJvZHk6ICfliKXjga7jgrnjg6zjg4Pjg4njga7mipXnqL/jgafjgZknLFxyXG4gICAgICAgIGFub255bW91c19pZDogJ+WMv+WQjTc4OScsXHJcbiAgICAgICAgY3JlYXRlZF9hdDogbmV3IERhdGUoRGF0ZS5ub3coKSAtIDI0MDAwMDApLnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgbGFuZ3VhZ2U6ICdqYSdcclxuICAgICAgfVxyXG4gICAgXSxcclxuICAgICczJzogW1xyXG4gICAgICB7XHJcbiAgICAgICAgcG9zdF9pZDogJzNfMScsXHJcbiAgICAgICAgdGhyZWFkX2lkOiAnMycsXHJcbiAgICAgICAgYm9keTogJ+ODl+ODreOCsOODqeODn+ODs+OCsOOBq+OBpOOBhOOBpuipseOBl+OBvuOBl+OCh+OBhicsXHJcbiAgICAgICAgYW5vbnltb3VzX2lkOiAn5Yy/5ZCNMTAxJyxcclxuICAgICAgICBjcmVhdGVkX2F0OiBuZXcgRGF0ZShEYXRlLm5vdygpIC0gMTcyMDAwMDAwKS50b0lTT1N0cmluZygpLFxyXG4gICAgICAgIGxhbmd1YWdlOiAnamEnXHJcbiAgICAgIH1cclxuICAgIF1cclxuICB9O1xyXG59XHJcblxyXG4vLyDjgrnjg6zjg4Pjg4njg4fjg7zjgr/kv53lrZjnlKjphY3liJfjgpLjgqjjgq/jgrnjg53jg7zjg4hcclxuZXhwb3J0IGNvbnN0IHRocmVhZHNTdG9yZSA9IGdsb2JhbC50aHJlYWRzU3RvcmU7XHJcblxyXG4vLyDmipXnqL/jg4fjg7zjgr/kv53lrZjnlKjjgqrjg5bjgrjjgqfjgq/jg4jjgpLjgqjjgq/jgrnjg53jg7zjg4hcclxuZXhwb3J0IGNvbnN0IHBvc3RzU3RvcmUgPSBnbG9iYWwucG9zdHNTdG9yZTtcclxuXHJcbi8vIOaWsOOBl+OBhOOCueODrOODg+ODieOCkui/veWKoOOBmeOCi+ODpuODvOODhuOCo+ODquODhuOCo+mWouaVsFxyXG5leHBvcnQgZnVuY3Rpb24gYWRkVGhyZWFkKHRocmVhZCkge1xyXG4gIC8vIOaXouWtmOOBruOCueODrOODg+ODieOCkueiuuiqje+8iOmHjeikh+i/veWKoOmYsuatou+8iVxyXG4gIGNvbnN0IGV4aXN0aW5nVGhyZWFkID0gdGhyZWFkc1N0b3JlLmZpbmQodCA9PiB0LnRocmVhZF9pZCA9PT0gdGhyZWFkLnRocmVhZF9pZCk7XHJcbiAgaWYgKCFleGlzdGluZ1RocmVhZCkge1xyXG4gICAgdGhyZWFkc1N0b3JlLnB1c2goey4uLnRocmVhZH0pOyAvLyDjgqrjg5bjgrjjgqfjgq/jg4jjgpLjgrPjg5Tjg7zjgZfjgabov73liqBcclxuICAgIGNvbnNvbGUubG9nKGDjgrnjg6zjg4Pjg4nov73liqA6IElEPSR7dGhyZWFkLnRocmVhZF9pZH0sIOOCv+OCpOODiOODqz1cIiR7dGhyZWFkLnRpdGxlfVwiYCk7XHJcbiAgICBjb25zb2xlLmxvZygn54++5Zyo44Gu44K544Os44OD44OJ5LiA6KanOicsIHRocmVhZHNTdG9yZS5tYXAodCA9PiB0LnRocmVhZF9pZCkpO1xyXG4gIH1cclxufVxyXG5cclxuLy8g5paw44GX44GE5oqV56i/44KS6L+95Yqg44GZ44KL44Om44O844OG44Kj44Oq44OG44Kj6Zai5pWwXHJcbmV4cG9ydCBmdW5jdGlvbiBhZGRQb3N0KHRocmVhZElkLCBwb3N0KSB7XHJcbiAgaWYgKCFwb3N0c1N0b3JlW3RocmVhZElkXSkge1xyXG4gICAgcG9zdHNTdG9yZVt0aHJlYWRJZF0gPSBbXTtcclxuICB9XHJcbiAgcG9zdHNTdG9yZVt0aHJlYWRJZF0ucHVzaCh7XHJcbiAgICBpZDogcG9zdC5wb3N0X2lkLFxyXG4gICAgdGhyZWFkSWQsXHJcbiAgICBib2R5OiBwb3N0LmJvZHksIC8vIOaUueihjOOCkuWQq+OCgOODhuOCreOCueODiOOBjOOBneOBruOBvuOBvuS/neWtmOOBleOCjOOCi1xyXG4gICAgYW5vbnltb3VzX2lkOiBwb3N0LmFub255bW91c19pZCwgLy8g5Yy/5ZCNSUTjgpLnorrlrp/jgavkv53lrZhcclxuICAgIGxhbmd1YWdlOiBwb3N0Lmxhbmd1YWdlLFxyXG4gICAgY3JlYXRlZEF0OiBwb3N0LmNyZWF0ZWRfYXQgfHwgbmV3IERhdGUoKS50b0lTT1N0cmluZygpXHJcbiAgfSk7XHJcbiAgY29uc29sZS5sb2coYOaKleeov+i/veWKoDog44K544Os44OD44OJSUQ9JHt0aHJlYWRJZH0sIOaKleeov0lEPSR7cG9zdC5wb3N0X2lkfSwg5Yy/5ZCNSUQ9JHtwb3N0LmFub255bW91c19pZH1gKTtcclxufVxyXG5cclxuLy8g44OH44OQ44OD44Kw55So77ya44OH44O844K/44K544OI44Ki44Gu5YaF5a6544KS6KGo56S6XHJcbmV4cG9ydCBmdW5jdGlvbiBkZWJ1Z0RhdGFTdG9yZSgpIHtcclxuICBjb25zb2xlLmxvZygnPT09PT0g44OH44O844K/44K544OI44Ki5YaF5a65ID09PT09Jyk7XHJcbiAgY29uc29sZS5sb2coJ+OCueODrOODg+ODieaVsDonLCB0aHJlYWRzU3RvcmUubGVuZ3RoKTtcclxuICBjb25zb2xlLmxvZygn44K544Os44OD44OJSUTkuIDopqc6JywgdGhyZWFkc1N0b3JlLm1hcCh0ID0+IHQudGhyZWFkX2lkKSk7XHJcbiAgY29uc29sZS5sb2coJ+aKleeov+aVsDonLCBPYmplY3Qua2V5cyhwb3N0c1N0b3JlKS5sZW5ndGgpO1xyXG4gIGNvbnNvbGUubG9nKCc9PT09PT09PT09PT09PT09PT09PT09PT09PScpO1xyXG59XHJcblxyXG4vKipcclxuICog44K544Os44OD44OJ44Go5oqV56i/44KS5LiA5bqm44Gr5Y+W5b6XXHJcbiAqIEBwYXJhbSB7c3RyaW5nfSB0aHJlYWRJZCAtIOOCueODrOODg+ODiUlEXHJcbiAqIEByZXR1cm5zIHtvYmplY3R8bnVsbH0g44K544Os44OD44OJ44Go5oqV56i/44Gu5oOF5aCx44CB6KaL44Gk44GL44KJ44Gq44GE5aC05ZCI44GvbnVsbFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGdldFRocmVhZFdpdGhQb3N0cyh0aHJlYWRJZCkge1xyXG4gIC8vIOOCueODrOODg+ODieOCkuODoeODouODquOBi+OCieWPluW+l1xyXG4gIGNvbnN0IHRocmVhZCA9IHRocmVhZHNTdG9yZS5maW5kKHQgPT4gdC50aHJlYWRfaWQgPT09IHRocmVhZElkKTtcclxuICBcclxuICBpZiAoIXRocmVhZCkge1xyXG4gICAgY29uc29sZS5sb2coYOOCueODrOODg+ODieacqueZuuimizogSUQ9JHt0aHJlYWRJZH1gKTtcclxuICAgIHJldHVybiBudWxsO1xyXG4gIH1cclxuICBcclxuICAvLyDmipXnqL/jgpLjg6Hjg6Ljg6rjgYvjgonlj5blvpdcclxuICBjb25zdCBwb3N0cyA9IHBvc3RzU3RvcmVbdGhyZWFkSWRdIHx8IFtdO1xyXG4gIFxyXG4gIC8vIOaKleeov+ODh+ODvOOCv+OCkuaVtOW9olxyXG4gIGNvbnN0IGZvcm1hdHRlZFBvc3RzID0gcG9zdHMubWFwKHBvc3QgPT4gKHtcclxuICAgIGlkOiBwb3N0LnBvc3RfaWQgfHwgcG9zdC5pZCxcclxuICAgIGJvZHk6IHBvc3QuYm9keSxcclxuICAgIGFub255bW91c19pZDogcG9zdC5hbm9ueW1vdXNfaWQgfHwgJ+WMv+WQjeODpuODvOOCtuODvCcsIC8vIOWMv+WQjUlE44GM44Gq44GE5aC05ZCI44Gv44OH44OV44Kp44Or44OI5YCk44KS6Kit5a6aXHJcbiAgICB0aHJlYWRfaWQ6IHBvc3QudGhyZWFkX2lkLFxyXG4gICAgY3JlYXRlZF9hdDogcG9zdC5jcmVhdGVkX2F0IHx8IHBvc3QuY3JlYXRlZEF0LFxyXG4gICAgb3JpZ2luYWxfbGFuZzogcG9zdC5sYW5ndWFnZSwgLy8g5YWD44Gu6KiA6Kqe44KS5L+d5oyBXHJcbiAgICB0cmFuc2xhdGVkX3RvOiBudWxsIC8vIOe/u+ios+WFiOiogOiqnu+8iOW+jOOBp+ioreWumu+8iVxyXG4gIH0pKTtcclxuICBcclxuICByZXR1cm4ge1xyXG4gICAgdGhyZWFkOiB7XHJcbiAgICAgIC4uLnRocmVhZCxcclxuICAgICAgaWQ6IHRocmVhZC50aHJlYWRfaWRcclxuICAgIH0sXHJcbiAgICBwb3N0czogZm9ybWF0dGVkUG9zdHMsXHJcbiAgICBsYW5nOiB0aHJlYWQubGFuZ3VhZ2UgLy8g44K544Os44OD44OJ44Gu6KiA6KqeXHJcbiAgfTtcclxufSAiXSwibmFtZXMiOlsiZ2xvYmFsIiwidGhyZWFkc1N0b3JlIiwidGhyZWFkX2lkIiwidGl0bGUiLCJkZXNjcmlwdGlvbiIsImNyZWF0ZWRfYXQiLCJEYXRlIiwidG9JU09TdHJpbmciLCJ1cGRhdGVkX2F0IiwibGFuZ3VhZ2UiLCJub3ciLCJwb3N0c1N0b3JlIiwicG9zdF9pZCIsImJvZHkiLCJhbm9ueW1vdXNfaWQiLCJhZGRUaHJlYWQiLCJ0aHJlYWQiLCJleGlzdGluZ1RocmVhZCIsImZpbmQiLCJ0IiwicHVzaCIsImNvbnNvbGUiLCJsb2ciLCJtYXAiLCJhZGRQb3N0IiwidGhyZWFkSWQiLCJwb3N0IiwiaWQiLCJjcmVhdGVkQXQiLCJkZWJ1Z0RhdGFTdG9yZSIsImxlbmd0aCIsIk9iamVjdCIsImtleXMiLCJnZXRUaHJlYWRXaXRoUG9zdHMiLCJwb3N0cyIsImZvcm1hdHRlZFBvc3RzIiwib3JpZ2luYWxfbGFuZyIsInRyYW5zbGF0ZWRfdG8iLCJsYW5nIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./lib/dataStore.js\n");

/***/ }),

/***/ "(api)/./lib/deepl.js":
/*!**********************!*\
  !*** ./lib/deepl.js ***!
  \**********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ deepl)\n/* harmony export */ });\n/**\r\n * DeepL API を呼び出し、翻訳済みテキストを返します。\r\n * 必ず .env.local に DEEPL_API_KEY=xxxxxxxx を設定してください。\r\n * @param {string} text        翻訳したい原文\r\n * @param {string} targetLang  例: 'EN', 'JA' など（大文字2文字）\r\n * @param {string} sourceLang  任意：原文言語 例:'JA'（空なら自動判定）\r\n * @returns {Promise<string>}  翻訳後テキスト（失敗時は原文を返す）\r\n */ async function deepl(text, targetLang, sourceLang = \"\") {\n    try {\n        if (!text || text.trim() === \"\") {\n            console.log(\"空のテキストが渡されました。原文を返します。\");\n            return text;\n        }\n        const apiKey = \"3b6926d8-d7fe-0ab5-a139-58078d395af5:fx\";\n        if (!apiKey) {\n            console.error(\"DeepL API キーが設定されていません。環境変数 DEEPL_API_KEY を確認してください。\");\n            return text;\n        }\n        // 言語コードの正規化\n        const normalizedTargetLang = targetLang.toUpperCase();\n        const normalizedSourceLang = sourceLang ? sourceLang.toUpperCase() : \"\";\n        // 同じ言語の場合は翻訳せずに返す\n        if (normalizedSourceLang && normalizedSourceLang === normalizedTargetLang) {\n            console.log(`同じ言語 (${normalizedSourceLang}) なので翻訳をスキップします。`);\n            return text;\n        }\n        // 辞書による簡易翻訳チェック (短い単語の場合)\n        if (text.length < 10) {\n            const simpleDictionary = {\n                \"犬\": {\n                    EN: \"dog\",\n                    JA: \"犬\"\n                },\n                \"猫\": {\n                    EN: \"cat\",\n                    JA: \"猫\"\n                },\n                \"dog\": {\n                    EN: \"dog\",\n                    JA: \"犬\"\n                },\n                \"cat\": {\n                    EN: \"cat\",\n                    JA: \"猫\"\n                }\n            };\n            const dictEntry = simpleDictionary[text.trim()];\n            if (dictEntry && dictEntry[normalizedTargetLang]) {\n                console.log(`辞書による翻訳: ${text} → ${dictEntry[normalizedTargetLang]}`);\n                return dictEntry[normalizedTargetLang];\n            }\n        }\n        // リクエストパラメータ\n        const params = new URLSearchParams();\n        params.append(\"auth_key\", apiKey);\n        params.append(\"text\", text);\n        params.append(\"target_lang\", normalizedTargetLang);\n        // ソース言語が指定されている場合のみ追加\n        // 重要: 同じ言語間の翻訳を避けるため、ソース言語を明示的に設定\n        if (normalizedSourceLang) {\n            params.append(\"source_lang\", normalizedSourceLang);\n        }\n        // 翻訳文のフォーマット保持設定（日本語→英語の場合は保持しない）\n        const isJaToEn = normalizedSourceLang === \"JA\" && normalizedTargetLang === \"EN\" || !normalizedSourceLang && /[\\u3040-\\u30FF\\u4E00-\\u9FFF]/.test(text) && normalizedTargetLang === \"EN\";\n        if (!isJaToEn) {\n            params.append(\"preserve_formatting\", \"1\");\n        }\n        // リクエスト送信\n        console.log(`DeepL API リクエスト: ${normalizedSourceLang || \"自動検出\"} → ${normalizedTargetLang} \"${text.slice(0, 30)}...\"`);\n        const response = await fetch(\"https://api-free.deepl.com/v2/translate\", {\n            method: \"POST\",\n            headers: {\n                \"Content-Type\": \"application/x-www-form-urlencoded\",\n                \"User-Agent\": \"5ch-board/1.0\"\n            },\n            body: params\n        });\n        // レスポンスチェック\n        if (!response.ok) {\n            const errorText = await response.text().catch(()=>\"\");\n            throw new Error(`DeepL API エラー: ${response.status} ${response.statusText} ${errorText}`);\n        }\n        // レスポンス解析\n        const data = await response.json();\n        if (!data.translations || data.translations.length === 0) {\n            console.warn(\"DeepL API: 翻訳結果が空です。\", {\n                text,\n                targetLang\n            });\n            return text;\n        }\n        const translatedText = data.translations[0].text;\n        const detectedSourceLang = data.translations[0].detected_source_language;\n        // 翻訳結果の検証 - 入力と出力が同じで言語が異なる場合はおかしい\n        if (translatedText.trim() === text.trim() && detectedSourceLang && normalizedTargetLang !== detectedSourceLang) {\n            console.warn(\"翻訳結果が元のテキストと同じです。2回目の試行を行います。\", {\n                detected: detectedSourceLang,\n                target: normalizedTargetLang\n            });\n            // 2回目の試行 - ソース言語を明示的に設定して再試行\n            const retryParams = new URLSearchParams();\n            retryParams.append(\"auth_key\", apiKey);\n            retryParams.append(\"text\", text);\n            retryParams.append(\"target_lang\", normalizedTargetLang);\n            retryParams.append(\"source_lang\", detectedSourceLang);\n            retryParams.append(\"preserve_formatting\", \"0\"); // フォーマット保持しない\n            const retryResponse = await fetch(\"https://api-free.deepl.com/v2/translate\", {\n                method: \"POST\",\n                headers: {\n                    \"Content-Type\": \"application/x-www-form-urlencoded\"\n                },\n                body: retryParams\n            });\n            if (retryResponse.ok) {\n                const retryData = await retryResponse.json();\n                if (retryData.translations && retryData.translations.length > 0) {\n                    const retryText = retryData.translations[0].text;\n                    if (retryText.trim() !== text.trim()) {\n                        console.log(`再試行成功: \"${text.slice(0, 20)}...\" → \"${retryText.slice(0, 20)}...\"`);\n                        return retryText;\n                    }\n                }\n            }\n            // 万が一それでも同じなら、簡易翻訳を試す（特定の単語のみ）\n            if (/^[a-zA-Z\\s]+$/.test(text) && normalizedTargetLang === \"JA\") {\n                // 英語→日本語の簡易辞書\n                const enToJa = {\n                    \"dog\": \"犬\",\n                    \"cat\": \"猫\",\n                    \"hello\": \"こんにちは\",\n                    \"good morning\": \"おはようございます\",\n                    \"thank you\": \"ありがとう\",\n                    \"yes\": \"はい\",\n                    \"no\": \"いいえ\"\n                };\n                const lowerText = text.toLowerCase().trim();\n                if (enToJa[lowerText]) {\n                    console.log(`簡易辞書翻訳: ${text} → ${enToJa[lowerText]}`);\n                    return enToJa[lowerText];\n                }\n            } else if (/[\\u3040-\\u30FF\\u4E00-\\u9FFF]/.test(text) && normalizedTargetLang === \"EN\") {\n                // 日本語→英語の簡易辞書\n                const jaToEn = {\n                    \"犬\": \"dog\",\n                    \"猫\": \"cat\",\n                    \"こんにちは\": \"hello\",\n                    \"おはようございます\": \"good morning\",\n                    \"ありがとう\": \"thank you\",\n                    \"はい\": \"yes\",\n                    \"いいえ\": \"no\"\n                };\n                if (jaToEn[text.trim()]) {\n                    console.log(`簡易辞書翻訳: ${text} → ${jaToEn[text.trim()]}`);\n                    return jaToEn[text.trim()];\n                }\n            }\n        }\n        // デバッグログ\n        console.log(`DeepL翻訳: ${detectedSourceLang} → ${normalizedTargetLang}`, text.slice(0, 20), \"→\", translatedText.slice(0, 20));\n        return translatedText;\n    } catch (err) {\n        console.error(\"[deepl] 翻訳エラー:\", err.message, {\n            text: text.slice(0, 50),\n            targetLang\n        });\n        // ネットワークエラーの場合はフラグを立てて、後でリトライできるようにする\n        if (err.name === \"TypeError\" || err.name === \"NetworkError\" || err.message.includes(\"network\")) {\n            console.error(\"[deepl] ネットワークエラーが発生しました。後でリトライします。\");\n        }\n        return text; // 失敗した場合は原文を返す\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LEdBQUc7Z0JBQzVCO1lBQ0Y7UUFDRjtRQUVBLFNBQVM7UUFDVEMsUUFBUUMsR0FBRyxDQUFDLENBQUMsU0FBUyxFQUFFb0MsbUJBQW1CLEdBQUcsRUFBRTlCLHFCQUFxQixDQUFDLEVBQ3BFWCxLQUFLd0IsS0FBSyxDQUFDLEdBQUcsS0FBSyxLQUFLZ0IsZUFBZWhCLEtBQUssQ0FBQyxHQUFHO1FBRWxELE9BQU9nQjtJQUNULEVBQUUsT0FBT2EsS0FBSztRQUNaakQsUUFBUU0sS0FBSyxDQUFDLGtCQUFrQjJDLElBQUlDLE9BQU8sRUFBRTtZQUFFdEQsTUFBTUEsS0FBS3dCLEtBQUssQ0FBQyxHQUFHO1lBQUt2QjtRQUFXO1FBRW5GLHNDQUFzQztRQUN0QyxJQUFJb0QsSUFBSUUsSUFBSSxLQUFLLGVBQWVGLElBQUlFLElBQUksS0FBSyxrQkFBa0JGLElBQUlDLE9BQU8sQ0FBQ0UsUUFBUSxDQUFDLFlBQVk7WUFDOUZwRCxRQUFRTSxLQUFLLENBQUM7UUFDaEI7UUFFQSxPQUFPVixNQUFNLGVBQWU7SUFDOUI7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovLzVjaC8uL2xpYi9kZWVwbC5qcz9jNzc2Il0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBEZWVwTCBBUEkg44KS5ZG844Gz5Ye644GX44CB57+76Kiz5riI44G/44OG44Kt44K544OI44KS6L+U44GX44G+44GZ44CCXHJcbiAqIOW/heOBmiAuZW52LmxvY2FsIOOBqyBERUVQTF9BUElfS0VZPXh4eHh4eHh4IOOCkuioreWumuOBl+OBpuOBj+OBoOOBleOBhOOAglxyXG4gKiBAcGFyYW0ge3N0cmluZ30gdGV4dCAgICAgICAg57+76Kiz44GX44Gf44GE5Y6f5paHXHJcbiAqIEBwYXJhbSB7c3RyaW5nfSB0YXJnZXRMYW5nICDkvos6ICdFTicsICdKQScg44Gq44Gp77yI5aSn5paH5a2XMuaWh+Wtl++8iVxyXG4gKiBAcGFyYW0ge3N0cmluZ30gc291cmNlTGFuZyAg5Lu75oSP77ya5Y6f5paH6KiA6KqeIOS+izonSkEn77yI56m644Gq44KJ6Ieq5YuV5Yik5a6a77yJXHJcbiAqIEByZXR1cm5zIHtQcm9taXNlPHN0cmluZz59ICDnv7voqLPlvozjg4bjgq3jgrnjg4jvvIjlpLHmlZfmmYLjga/ljp/mlofjgpLov5TjgZnvvIlcclxuICovXHJcbmV4cG9ydCBkZWZhdWx0IGFzeW5jIGZ1bmN0aW9uIGRlZXBsKHRleHQsIHRhcmdldExhbmcsIHNvdXJjZUxhbmcgPSAnJykge1xyXG4gIHRyeSB7XHJcbiAgICBpZiAoIXRleHQgfHwgdGV4dC50cmltKCkgPT09ICcnKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKCfnqbrjga7jg4bjgq3jgrnjg4jjgYzmuKHjgZXjgozjgb7jgZfjgZ/jgILljp/mlofjgpLov5TjgZfjgb7jgZnjgIInKTtcclxuICAgICAgcmV0dXJuIHRleHQ7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgYXBpS2V5ID0gcHJvY2Vzcy5lbnYuREVFUExfQVBJX0tFWTtcclxuICAgIGlmICghYXBpS2V5KSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0RlZXBMIEFQSSDjgq3jg7zjgYzoqK3lrprjgZXjgozjgabjgYTjgb7jgZvjgpPjgILnkrDlooPlpInmlbAgREVFUExfQVBJX0tFWSDjgpLnorroqo3jgZfjgabjgY/jgaDjgZXjgYTjgIInKTtcclxuICAgICAgcmV0dXJuIHRleHQ7XHJcbiAgICB9XHJcblxyXG4gICAgLy8g6KiA6Kqe44Kz44O844OJ44Gu5q2j6KaP5YyWXHJcbiAgICBjb25zdCBub3JtYWxpemVkVGFyZ2V0TGFuZyA9IHRhcmdldExhbmcudG9VcHBlckNhc2UoKTtcclxuICAgIGNvbnN0IG5vcm1hbGl6ZWRTb3VyY2VMYW5nID0gc291cmNlTGFuZyA/IHNvdXJjZUxhbmcudG9VcHBlckNhc2UoKSA6ICcnO1xyXG5cclxuICAgIC8vIOWQjOOBmOiogOiqnuOBruWgtOWQiOOBr+e/u+ios+OBm+OBmuOBq+i/lOOBmVxyXG4gICAgaWYgKG5vcm1hbGl6ZWRTb3VyY2VMYW5nICYmIG5vcm1hbGl6ZWRTb3VyY2VMYW5nID09PSBub3JtYWxpemVkVGFyZ2V0TGFuZykge1xyXG4gICAgICBjb25zb2xlLmxvZyhg5ZCM44GY6KiA6KqeICgke25vcm1hbGl6ZWRTb3VyY2VMYW5nfSkg44Gq44Gu44Gn57+76Kiz44KS44K544Kt44OD44OX44GX44G+44GZ44CCYCk7XHJcbiAgICAgIHJldHVybiB0ZXh0O1xyXG4gICAgfVxyXG5cclxuICAgIC8vIOi+nuabuOOBq+OCiOOCi+ewoeaYk+e/u+ios+ODgeOCp+ODg+OCryAo55+t44GE5Y2Y6Kqe44Gu5aC05ZCIKVxyXG4gICAgaWYgKHRleHQubGVuZ3RoIDwgMTApIHtcclxuICAgICAgY29uc3Qgc2ltcGxlRGljdGlvbmFyeSA9IHtcclxuICAgICAgICAn54qsJzogeyBFTjogJ2RvZycsIEpBOiAn54qsJyB9LFxyXG4gICAgICAgICfnjKsnOiB7IEVOOiAnY2F0JywgSkE6ICfnjKsnIH0sXHJcbiAgICAgICAgJ2RvZyc6IHsgRU46ICdkb2cnLCBKQTogJ+eKrCcgfSxcclxuICAgICAgICAnY2F0JzogeyBFTjogJ2NhdCcsIEpBOiAn54yrJyB9LFxyXG4gICAgICB9O1xyXG4gICAgICBcclxuICAgICAgY29uc3QgZGljdEVudHJ5ID0gc2ltcGxlRGljdGlvbmFyeVt0ZXh0LnRyaW0oKV07XHJcbiAgICAgIGlmIChkaWN0RW50cnkgJiYgZGljdEVudHJ5W25vcm1hbGl6ZWRUYXJnZXRMYW5nXSkge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGDovp7mm7jjgavjgojjgovnv7voqLM6ICR7dGV4dH0g4oaSICR7ZGljdEVudHJ5W25vcm1hbGl6ZWRUYXJnZXRMYW5nXX1gKTtcclxuICAgICAgICByZXR1cm4gZGljdEVudHJ5W25vcm1hbGl6ZWRUYXJnZXRMYW5nXTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIOODquOCr+OCqOOCueODiOODkeODqeODoeODvOOCv1xyXG4gICAgY29uc3QgcGFyYW1zID0gbmV3IFVSTFNlYXJjaFBhcmFtcygpO1xyXG4gICAgcGFyYW1zLmFwcGVuZCgnYXV0aF9rZXknLCBhcGlLZXkpO1xyXG4gICAgcGFyYW1zLmFwcGVuZCgndGV4dCcsIHRleHQpO1xyXG4gICAgcGFyYW1zLmFwcGVuZCgndGFyZ2V0X2xhbmcnLCBub3JtYWxpemVkVGFyZ2V0TGFuZyk7XHJcbiAgICBcclxuICAgIC8vIOOCveODvOOCueiogOiqnuOBjOaMh+WumuOBleOCjOOBpuOBhOOCi+WgtOWQiOOBruOBv+i/veWKoFxyXG4gICAgLy8g6YeN6KaBOiDlkIzjgZjoqIDoqp7plpPjga7nv7voqLPjgpLpgb/jgZHjgovjgZ/jgoHjgIHjgr3jg7zjgrnoqIDoqp7jgpLmmI7npLrnmoTjgavoqK3lrppcclxuICAgIGlmIChub3JtYWxpemVkU291cmNlTGFuZykge1xyXG4gICAgICBwYXJhbXMuYXBwZW5kKCdzb3VyY2VfbGFuZycsIG5vcm1hbGl6ZWRTb3VyY2VMYW5nKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyDnv7voqLPmlofjga7jg5Xjgqnjg7zjg57jg4Pjg4jkv53mjIHoqK3lrprvvIjml6XmnKzoqp7ihpLoi7Hoqp7jga7loLTlkIjjga/kv53mjIHjgZfjgarjgYTvvIlcclxuICAgIGNvbnN0IGlzSmFUb0VuID0gKG5vcm1hbGl6ZWRTb3VyY2VMYW5nID09PSAnSkEnICYmIG5vcm1hbGl6ZWRUYXJnZXRMYW5nID09PSAnRU4nKSB8fCBcclxuICAgICAgICAgICAgICAgICAgICAgKCFub3JtYWxpemVkU291cmNlTGFuZyAmJiAvW1xcdTMwNDAtXFx1MzBGRlxcdTRFMDAtXFx1OUZGRl0vLnRlc3QodGV4dCkgJiYgbm9ybWFsaXplZFRhcmdldExhbmcgPT09ICdFTicpO1xyXG4gICAgXHJcbiAgICBpZiAoIWlzSmFUb0VuKSB7XHJcbiAgICAgIHBhcmFtcy5hcHBlbmQoJ3ByZXNlcnZlX2Zvcm1hdHRpbmcnLCAnMScpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIOODquOCr+OCqOOCueODiOmAgeS/oVxyXG4gICAgY29uc29sZS5sb2coYERlZXBMIEFQSSDjg6rjgq/jgqjjgrnjg4g6ICR7bm9ybWFsaXplZFNvdXJjZUxhbmcgfHwgJ+iHquWLleaknOWHuid9IOKGkiAke25vcm1hbGl6ZWRUYXJnZXRMYW5nfSBcIiR7dGV4dC5zbGljZSgwLCAzMCl9Li4uXCJgKTtcclxuICAgIFxyXG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCgnaHR0cHM6Ly9hcGktZnJlZS5kZWVwbC5jb20vdjIvdHJhbnNsYXRlJywge1xyXG4gICAgICBtZXRob2Q6ICdQT1NUJyxcclxuICAgICAgaGVhZGVyczogeyBcclxuICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCcsXHJcbiAgICAgICAgJ1VzZXItQWdlbnQnOiAnNWNoLWJvYXJkLzEuMCcsXHJcbiAgICAgIH0sXHJcbiAgICAgIGJvZHk6IHBhcmFtcyxcclxuICAgIH0pO1xyXG5cclxuICAgIC8vIOODrOOCueODneODs+OCueODgeOCp+ODg+OCr1xyXG4gICAgaWYgKCFyZXNwb25zZS5vaykge1xyXG4gICAgICBjb25zdCBlcnJvclRleHQgPSBhd2FpdCByZXNwb25zZS50ZXh0KCkuY2F0Y2goKCkgPT4gJycpO1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYERlZXBMIEFQSSDjgqjjg6njg7w6ICR7cmVzcG9uc2Uuc3RhdHVzfSAke3Jlc3BvbnNlLnN0YXR1c1RleHR9ICR7ZXJyb3JUZXh0fWApO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIOODrOOCueODneODs+OCueino+aekFxyXG4gICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcclxuICAgIFxyXG4gICAgaWYgKCFkYXRhLnRyYW5zbGF0aW9ucyB8fCBkYXRhLnRyYW5zbGF0aW9ucy5sZW5ndGggPT09IDApIHtcclxuICAgICAgY29uc29sZS53YXJuKCdEZWVwTCBBUEk6IOe/u+ios+e1kOaenOOBjOepuuOBp+OBmeOAgicsIHsgdGV4dCwgdGFyZ2V0TGFuZyB9KTtcclxuICAgICAgcmV0dXJuIHRleHQ7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGNvbnN0IHRyYW5zbGF0ZWRUZXh0ID0gZGF0YS50cmFuc2xhdGlvbnNbMF0udGV4dDtcclxuICAgIGNvbnN0IGRldGVjdGVkU291cmNlTGFuZyA9IGRhdGEudHJhbnNsYXRpb25zWzBdLmRldGVjdGVkX3NvdXJjZV9sYW5ndWFnZTtcclxuICAgIFxyXG4gICAgLy8g57+76Kiz57WQ5p6c44Gu5qSc6Ki8IC0g5YWl5Yqb44Go5Ye65Yqb44GM5ZCM44GY44Gn6KiA6Kqe44GM55Ww44Gq44KL5aC05ZCI44Gv44GK44GL44GX44GEXHJcbiAgICBpZiAodHJhbnNsYXRlZFRleHQudHJpbSgpID09PSB0ZXh0LnRyaW0oKSAmJiBcclxuICAgICAgICBkZXRlY3RlZFNvdXJjZUxhbmcgJiYgbm9ybWFsaXplZFRhcmdldExhbmcgIT09IGRldGVjdGVkU291cmNlTGFuZykge1xyXG4gICAgICBjb25zb2xlLndhcm4oJ+e/u+ios+e1kOaenOOBjOWFg+OBruODhuOCreOCueODiOOBqOWQjOOBmOOBp+OBmeOAgjLlm57nm67jga7oqabooYzjgpLooYzjgYTjgb7jgZnjgIInLCBcclxuICAgICAgICAgICAgICAgICAgeyBkZXRlY3RlZDogZGV0ZWN0ZWRTb3VyY2VMYW5nLCB0YXJnZXQ6IG5vcm1hbGl6ZWRUYXJnZXRMYW5nIH0pO1xyXG4gICAgICBcclxuICAgICAgLy8gMuWbnuebruOBruippuihjCAtIOOCveODvOOCueiogOiqnuOCkuaYjuekuueahOOBq+ioreWumuOBl+OBpuWGjeippuihjFxyXG4gICAgICBjb25zdCByZXRyeVBhcmFtcyA9IG5ldyBVUkxTZWFyY2hQYXJhbXMoKTtcclxuICAgICAgcmV0cnlQYXJhbXMuYXBwZW5kKCdhdXRoX2tleScsIGFwaUtleSk7XHJcbiAgICAgIHJldHJ5UGFyYW1zLmFwcGVuZCgndGV4dCcsIHRleHQpO1xyXG4gICAgICByZXRyeVBhcmFtcy5hcHBlbmQoJ3RhcmdldF9sYW5nJywgbm9ybWFsaXplZFRhcmdldExhbmcpO1xyXG4gICAgICByZXRyeVBhcmFtcy5hcHBlbmQoJ3NvdXJjZV9sYW5nJywgZGV0ZWN0ZWRTb3VyY2VMYW5nKTtcclxuICAgICAgcmV0cnlQYXJhbXMuYXBwZW5kKCdwcmVzZXJ2ZV9mb3JtYXR0aW5nJywgJzAnKTsgLy8g44OV44Kp44O844Oe44OD44OI5L+d5oyB44GX44Gq44GEXHJcbiAgICAgIFxyXG4gICAgICBjb25zdCByZXRyeVJlc3BvbnNlID0gYXdhaXQgZmV0Y2goJ2h0dHBzOi8vYXBpLWZyZWUuZGVlcGwuY29tL3YyL3RyYW5zbGF0ZScsIHtcclxuICAgICAgICBtZXRob2Q6ICdQT1NUJyxcclxuICAgICAgICBoZWFkZXJzOiB7ICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkJyB9LFxyXG4gICAgICAgIGJvZHk6IHJldHJ5UGFyYW1zLFxyXG4gICAgICB9KTtcclxuICAgICAgXHJcbiAgICAgIGlmIChyZXRyeVJlc3BvbnNlLm9rKSB7XHJcbiAgICAgICAgY29uc3QgcmV0cnlEYXRhID0gYXdhaXQgcmV0cnlSZXNwb25zZS5qc29uKCk7XHJcbiAgICAgICAgaWYgKHJldHJ5RGF0YS50cmFuc2xhdGlvbnMgJiYgcmV0cnlEYXRhLnRyYW5zbGF0aW9ucy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICBjb25zdCByZXRyeVRleHQgPSByZXRyeURhdGEudHJhbnNsYXRpb25zWzBdLnRleHQ7XHJcbiAgICAgICAgICBpZiAocmV0cnlUZXh0LnRyaW0oKSAhPT0gdGV4dC50cmltKCkpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coYOWGjeippuihjOaIkOWKnzogXCIke3RleHQuc2xpY2UoMCwgMjApfS4uLlwiIOKGkiBcIiR7cmV0cnlUZXh0LnNsaWNlKDAsIDIwKX0uLi5cImApO1xyXG4gICAgICAgICAgICByZXR1cm4gcmV0cnlUZXh0O1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICBcclxuICAgICAgLy8g5LiH44GM5LiA44Gd44KM44Gn44KC5ZCM44GY44Gq44KJ44CB57Ch5piT57+76Kiz44KS6Kmm44GZ77yI54m55a6a44Gu5Y2Y6Kqe44Gu44G/77yJXHJcbiAgICAgIGlmICgvXlthLXpBLVpcXHNdKyQvLnRlc3QodGV4dCkgJiYgbm9ybWFsaXplZFRhcmdldExhbmcgPT09ICdKQScpIHtcclxuICAgICAgICAvLyDoi7Hoqp7ihpLml6XmnKzoqp7jga7nsKHmmJPovp7mm7hcclxuICAgICAgICBjb25zdCBlblRvSmEgPSB7XHJcbiAgICAgICAgICAnZG9nJzogJ+eKrCcsXHJcbiAgICAgICAgICAnY2F0JzogJ+eMqycsXHJcbiAgICAgICAgICAnaGVsbG8nOiAn44GT44KT44Gr44Gh44GvJyxcclxuICAgICAgICAgICdnb29kIG1vcm5pbmcnOiAn44GK44Gv44KI44GG44GU44GW44GE44G+44GZJyxcclxuICAgICAgICAgICd0aGFuayB5b3UnOiAn44GC44KK44GM44Go44GGJyxcclxuICAgICAgICAgICd5ZXMnOiAn44Gv44GEJyxcclxuICAgICAgICAgICdubyc6ICfjgYTjgYTjgYgnXHJcbiAgICAgICAgfTtcclxuICAgICAgICBjb25zdCBsb3dlclRleHQgPSB0ZXh0LnRvTG93ZXJDYXNlKCkudHJpbSgpO1xyXG4gICAgICAgIGlmIChlblRvSmFbbG93ZXJUZXh0XSkge1xyXG4gICAgICAgICAgY29uc29sZS5sb2coYOewoeaYk+i+nuabuOe/u+ioszogJHt0ZXh0fSDihpIgJHtlblRvSmFbbG93ZXJUZXh0XX1gKTtcclxuICAgICAgICAgIHJldHVybiBlblRvSmFbbG93ZXJUZXh0XTtcclxuICAgICAgICB9XHJcbiAgICAgIH0gZWxzZSBpZiAoL1tcXHUzMDQwLVxcdTMwRkZcXHU0RTAwLVxcdTlGRkZdLy50ZXN0KHRleHQpICYmIG5vcm1hbGl6ZWRUYXJnZXRMYW5nID09PSAnRU4nKSB7XHJcbiAgICAgICAgLy8g5pel5pys6Kqe4oaS6Iux6Kqe44Gu57Ch5piT6L6e5pu4XHJcbiAgICAgICAgY29uc3QgamFUb0VuID0ge1xyXG4gICAgICAgICAgJ+eKrCc6ICdkb2cnLFxyXG4gICAgICAgICAgJ+eMqyc6ICdjYXQnLFxyXG4gICAgICAgICAgJ+OBk+OCk+OBq+OBoeOBryc6ICdoZWxsbycsXHJcbiAgICAgICAgICAn44GK44Gv44KI44GG44GU44GW44GE44G+44GZJzogJ2dvb2QgbW9ybmluZycsXHJcbiAgICAgICAgICAn44GC44KK44GM44Go44GGJzogJ3RoYW5rIHlvdScsXHJcbiAgICAgICAgICAn44Gv44GEJzogJ3llcycsXHJcbiAgICAgICAgICAn44GE44GE44GIJzogJ25vJ1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgaWYgKGphVG9Fblt0ZXh0LnRyaW0oKV0pIHtcclxuICAgICAgICAgIGNvbnNvbGUubG9nKGDnsKHmmJPovp7mm7jnv7voqLM6ICR7dGV4dH0g4oaSICR7amFUb0VuW3RleHQudHJpbSgpXX1gKTtcclxuICAgICAgICAgIHJldHVybiBqYVRvRW5bdGV4dC50cmltKCldO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyDjg4fjg5Djg4PjgrDjg63jgrBcclxuICAgIGNvbnNvbGUubG9nKGBEZWVwTOe/u+ioszogJHtkZXRlY3RlZFNvdXJjZUxhbmd9IOKGkiAke25vcm1hbGl6ZWRUYXJnZXRMYW5nfWAsIFxyXG4gICAgICB0ZXh0LnNsaWNlKDAsIDIwKSwgJ+KGkicsIHRyYW5zbGF0ZWRUZXh0LnNsaWNlKDAsIDIwKSk7XHJcbiAgICBcclxuICAgIHJldHVybiB0cmFuc2xhdGVkVGV4dDtcclxuICB9IGNhdGNoIChlcnIpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ1tkZWVwbF0g57+76Kiz44Ko44Op44O8OicsIGVyci5tZXNzYWdlLCB7IHRleHQ6IHRleHQuc2xpY2UoMCwgNTApLCB0YXJnZXRMYW5nIH0pO1xyXG4gICAgXHJcbiAgICAvLyDjg43jg4Pjg4jjg6/jg7zjgq/jgqjjg6njg7zjga7loLTlkIjjga/jg5Xjg6njgrDjgpLnq4vjgabjgabjgIHlvozjgafjg6rjg4jjg6njgqTjgafjgY3jgovjgojjgYbjgavjgZnjgotcclxuICAgIGlmIChlcnIubmFtZSA9PT0gJ1R5cGVFcnJvcicgfHwgZXJyLm5hbWUgPT09ICdOZXR3b3JrRXJyb3InIHx8IGVyci5tZXNzYWdlLmluY2x1ZGVzKCduZXR3b3JrJykpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignW2RlZXBsXSDjg43jg4Pjg4jjg6/jg7zjgq/jgqjjg6njg7zjgYznmbrnlJ/jgZfjgb7jgZfjgZ/jgILlvozjgafjg6rjg4jjg6njgqTjgZfjgb7jgZnjgIInKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgcmV0dXJuIHRleHQ7IC8vIOWkseaVl+OBl+OBn+WgtOWQiOOBr+WOn+aWh+OCkui/lOOBmVxyXG4gIH1cclxufSAiXSwibmFtZXMiOlsiZGVlcGwiLCJ0ZXh0IiwidGFyZ2V0TGFuZyIsInNvdXJjZUxhbmciLCJ0cmltIiwiY29uc29sZSIsImxvZyIsImFwaUtleSIsInByb2Nlc3MiLCJlbnYiLCJERUVQTF9BUElfS0VZIiwiZXJyb3IiLCJub3JtYWxpemVkVGFyZ2V0TGFuZyIsInRvVXBwZXJDYXNlIiwibm9ybWFsaXplZFNvdXJjZUxhbmciLCJsZW5ndGgiLCJzaW1wbGVEaWN0aW9uYXJ5IiwiRU4iLCJKQSIsImRpY3RFbnRyeSIsInBhcmFtcyIsIlVSTFNlYXJjaFBhcmFtcyIsImFwcGVuZCIsImlzSmFUb0VuIiwidGVzdCIsInNsaWNlIiwicmVzcG9uc2UiLCJmZXRjaCIsIm1ldGhvZCIsImhlYWRlcnMiLCJib2R5Iiwib2siLCJlcnJvclRleHQiLCJjYXRjaCIsIkVycm9yIiwic3RhdHVzIiwic3RhdHVzVGV4dCIsImRhdGEiLCJqc29uIiwidHJhbnNsYXRpb25zIiwid2FybiIsInRyYW5zbGF0ZWRUZXh0IiwiZGV0ZWN0ZWRTb3VyY2VMYW5nIiwiZGV0ZWN0ZWRfc291cmNlX2xhbmd1YWdlIiwiZGV0ZWN0ZWQiLCJ0YXJnZXQiLCJyZXRyeVBhcmFtcyIsInJldHJ5UmVzcG9uc2UiLCJyZXRyeURhdGEiLCJyZXRyeVRleHQiLCJlblRvSmEiLCJsb3dlclRleHQiLCJ0b0xvd2VyQ2FzZSIsImphVG9FbiIsImVyciIsIm1lc3NhZ2UiLCJuYW1lIiwiaW5jbHVkZXMiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./lib/deepl.js\n");

/***/ }),

/***/ "(api)/./lib/langUtil.js":
/*!*************************!*\
  !*** ./lib/langUtil.js ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   detectLang: () => (/* binding */ detectLang),\n/* harmony export */   dictionaryLookup: () => (/* binding */ dictionaryLookup),\n/* harmony export */   manualDict: () => (/* binding */ manualDict),\n/* harmony export */   mapLang: () => (/* binding */ mapLang),\n/* harmony export */   oppositeLang: () => (/* binding */ oppositeLang)\n/* harmony export */ });\n// ── 言語ユーティリティ ────────────────────────────────\nconst jaChar = /[\\u3000-\\u303F\\u3040-\\u309F\\u30A0-\\u30FF\\u4E00-\\u9FFF]/;\nconst detectLang = (t = \"\")=>jaChar.test(t) ? \"JA\" : \"EN\";\nconst oppositeLang = (l)=>l === \"JA\" ? \"EN\" : \"JA\";\nconst mapLang = (l = \"\")=>l.toLowerCase().startsWith(\"en\") ? \"EN\" : l.toLowerCase().startsWith(\"ja\") ? \"JA\" : l.toUpperCase();\nconst manualDict = {\n    \"犬\": \"dog\",\n    \"猫\": \"cat\",\n    \"dog\": \"犬\",\n    \"cat\": \"猫\"\n};\nconst dictionaryLookup = (text, target)=>{\n    const hit = manualDict[text.trim()];\n    if (!hit) return null;\n    return target === \"EN\" ? hit : Object.keys(manualDict).find((k)=>manualDict[k] === text.trim()) || null;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9saWIvbGFuZ1V0aWwuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBQSxnREFBZ0Q7QUFDaEQsTUFBTUEsU0FBUztBQUNSLE1BQU1DLGFBQWEsQ0FBQ0MsSUFBSSxFQUFFLEdBQU1GLE9BQU9HLElBQUksQ0FBQ0QsS0FBSyxPQUFPLEtBQU07QUFDOUQsTUFBTUUsZUFBZSxDQUFDQyxJQUFPQSxNQUFNLE9BQU8sT0FBTyxLQUFNO0FBQ3ZELE1BQU1DLFVBQVUsQ0FBQ0QsSUFBSSxFQUFFLEdBQzVCQSxFQUFFRSxXQUFXLEdBQUdDLFVBQVUsQ0FBQyxRQUFRLE9BQ2pDSCxFQUFFRSxXQUFXLEdBQUdDLFVBQVUsQ0FBQyxRQUFRLE9BQ25DSCxFQUFFSSxXQUFXLEdBQUc7QUFFYixNQUFNQyxhQUFhO0lBQ3hCLEtBQUs7SUFBUSxLQUFLO0lBQ2xCLE9BQU87SUFBTSxPQUFPO0FBQ3RCLEVBQUU7QUFFSyxNQUFNQyxtQkFBbUIsQ0FBQ0MsTUFBTUM7SUFDckMsTUFBTUMsTUFBTUosVUFBVSxDQUFDRSxLQUFLRyxJQUFJLEdBQUc7SUFDbkMsSUFBSSxDQUFDRCxLQUFLLE9BQU87SUFDakIsT0FBT0QsV0FBVyxPQUFPQyxNQUFNRSxPQUFPQyxJQUFJLENBQUNQLFlBQ3hDUSxJQUFJLENBQUNDLENBQUFBLElBQUtULFVBQVUsQ0FBQ1MsRUFBRSxLQUFLUCxLQUFLRyxJQUFJLE9BQU87QUFDakQsRUFBRSIsInNvdXJjZXMiOlsid2VicGFjazovLzVjaC8uL2xpYi9sYW5nVXRpbC5qcz9mMTM4Il0sInNvdXJjZXNDb250ZW50IjpbIi8vIOKUgOKUgCDoqIDoqp7jg6bjg7zjg4bjgqPjg6rjg4bjgqMg4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSAXHJcbmNvbnN0IGphQ2hhciA9IC9bXFx1MzAwMC1cXHUzMDNGXFx1MzA0MC1cXHUzMDlGXFx1MzBBMC1cXHUzMEZGXFx1NEUwMC1cXHU5RkZGXS87XHJcbmV4cG9ydCBjb25zdCBkZXRlY3RMYW5nID0gKHQgPSAnJykgPT4gKGphQ2hhci50ZXN0KHQpID8gJ0pBJyA6ICdFTicpO1xyXG5leHBvcnQgY29uc3Qgb3Bwb3NpdGVMYW5nID0gKGwpID0+IChsID09PSAnSkEnID8gJ0VOJyA6ICdKQScpO1xyXG5leHBvcnQgY29uc3QgbWFwTGFuZyA9IChsID0gJycpID0+XHJcbiAgbC50b0xvd2VyQ2FzZSgpLnN0YXJ0c1dpdGgoJ2VuJykgPyAnRU4nXHJcbiAgOiBsLnRvTG93ZXJDYXNlKCkuc3RhcnRzV2l0aCgnamEnKSA/ICdKQSdcclxuICA6IGwudG9VcHBlckNhc2UoKTtcclxuXHJcbmV4cG9ydCBjb25zdCBtYW51YWxEaWN0ID0ge1xyXG4gICfniqwnOiAnZG9nJywgICfnjKsnOiAnY2F0JyxcclxuICAnZG9nJzogJ+eKrCcsICAnY2F0JzogJ+eMqycsXHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgZGljdGlvbmFyeUxvb2t1cCA9ICh0ZXh0LCB0YXJnZXQpID0+IHtcclxuICBjb25zdCBoaXQgPSBtYW51YWxEaWN0W3RleHQudHJpbSgpXTtcclxuICBpZiAoIWhpdCkgcmV0dXJuIG51bGw7XHJcbiAgcmV0dXJuIHRhcmdldCA9PT0gJ0VOJyA/IGhpdCA6IE9iamVjdC5rZXlzKG1hbnVhbERpY3QpXHJcbiAgICAuZmluZChrID0+IG1hbnVhbERpY3Rba10gPT09IHRleHQudHJpbSgpKSB8fCBudWxsO1xyXG59OyAiXSwibmFtZXMiOlsiamFDaGFyIiwiZGV0ZWN0TGFuZyIsInQiLCJ0ZXN0Iiwib3Bwb3NpdGVMYW5nIiwibCIsIm1hcExhbmciLCJ0b0xvd2VyQ2FzZSIsInN0YXJ0c1dpdGgiLCJ0b1VwcGVyQ2FzZSIsIm1hbnVhbERpY3QiLCJkaWN0aW9uYXJ5TG9va3VwIiwidGV4dCIsInRhcmdldCIsImhpdCIsInRyaW0iLCJPYmplY3QiLCJrZXlzIiwiZmluZCIsImsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./lib/langUtil.js\n");

/***/ }),

/***/ "(api)/./lib/supabaseClient.js":
/*!*******************************!*\
  !*** ./lib/supabaseClient.js ***!
  \*******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   supabase: () => (/* binding */ supabase)\n/* harmony export */ });\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @supabase/supabase-js */ \"@supabase/supabase-js\");\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__);\n\nconst url = process.env.NEXT_PUBLIC_SUPABASE_URL;\nconst key = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY || process.env.SUPABASE_SERVICE_ROLE_KEY;\nconst supabase = url && key ? (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__.createClient)(url, key) // 本番・Preview では実接続\n : {\n    from: ()=>({\n            select: ()=>({\n                    eq: ()=>({\n                            single: async ()=>({\n                                    data: null,\n                                    error: null\n                                })\n                        })\n                }),\n            upsert: ()=>({\n                    select: ()=>({\n                            single: async ()=>({\n                                    data: null,\n                                    error: null\n                                })\n                        })\n                }),\n            insert: ()=>({\n                    select: ()=>({\n                            single: async ()=>({\n                                    data: null,\n                                    error: null\n                                })\n                        })\n                })\n        }),\n    channel: ()=>({\n            on: ()=>({\n                    subscribe: ()=>({\n                            unsubscribe: ()=>{}\n                        })\n                })\n        })\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9saWIvc3VwYWJhc2VDbGllbnQuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQXFEO0FBRXJELE1BQU1DLE1BQU1DLFFBQVFDLEdBQUcsQ0FBQ0Msd0JBQXdCO0FBQ2hELE1BQU1DLE1BQ0pILFFBQVFDLEdBQUcsQ0FBQ0csNkJBQTZCLElBQ3pDSixRQUFRQyxHQUFHLENBQUNJLHlCQUF5QjtBQUVoQyxNQUFNQyxXQUNYUCxPQUFPSSxNQUNITCxtRUFBWUEsQ0FBQ0MsS0FBS0ksS0FBWSxtQkFBbUI7R0FDakQ7SUFDRUksTUFBTSxJQUFPO1lBQ1hDLFFBQVEsSUFBTztvQkFBRUMsSUFBSSxJQUFPOzRCQUFFQyxRQUFRLFVBQWE7b0NBQUVDLE1BQU07b0NBQU1DLE9BQU87Z0NBQUs7d0JBQUc7Z0JBQUc7WUFDbkZDLFFBQVEsSUFBTztvQkFDYkwsUUFBUSxJQUFPOzRCQUFFRSxRQUFRLFVBQWE7b0NBQUVDLE1BQU07b0NBQU1DLE9BQU87Z0NBQUs7d0JBQUc7Z0JBQ3JFO1lBQ0FFLFFBQVEsSUFBTztvQkFBRU4sUUFBUSxJQUFPOzRCQUFFRSxRQUFRLFVBQWE7b0NBQUVDLE1BQU07b0NBQU1DLE9BQU87Z0NBQUs7d0JBQUc7Z0JBQUc7UUFDekY7SUFDQUcsU0FBUyxJQUFPO1lBQUVDLElBQUksSUFBTztvQkFBRUMsV0FBVyxJQUFPOzRCQUFFQyxhQUFhLEtBQU87d0JBQUU7Z0JBQUc7UUFBRztBQUNqRixFQUFFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vNWNoLy4vbGliL3N1cGFiYXNlQ2xpZW50LmpzPzVmMGQiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY3JlYXRlQ2xpZW50IH0gZnJvbSAnQHN1cGFiYXNlL3N1cGFiYXNlLWpzJztcclxuXHJcbmNvbnN0IHVybCA9IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTDtcclxuY29uc3Qga2V5ID1cclxuICBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19TVVBBQkFTRV9BTk9OX0tFWSB8fFxyXG4gIHByb2Nlc3MuZW52LlNVUEFCQVNFX1NFUlZJQ0VfUk9MRV9LRVk7XHJcblxyXG5leHBvcnQgY29uc3Qgc3VwYWJhc2UgPVxyXG4gIHVybCAmJiBrZXlcclxuICAgID8gY3JlYXRlQ2xpZW50KHVybCwga2V5KSAgICAgICAgLy8g5pys55Wq44O7UHJldmlldyDjgafjga/lrp/mjqXntppcclxuICAgIDogeyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g44Ot44O844Kr44Or6ZaL55m644Gn44Gv44Oi44OD44KvXHJcbiAgICAgICAgZnJvbTogKCkgPT4gKHtcclxuICAgICAgICAgIHNlbGVjdDogKCkgPT4gKHsgZXE6ICgpID0+ICh7IHNpbmdsZTogYXN5bmMgKCkgPT4gKHsgZGF0YTogbnVsbCwgZXJyb3I6IG51bGwgfSkgfSkgfSksXHJcbiAgICAgICAgICB1cHNlcnQ6ICgpID0+ICh7XHJcbiAgICAgICAgICAgIHNlbGVjdDogKCkgPT4gKHsgc2luZ2xlOiBhc3luYyAoKSA9PiAoeyBkYXRhOiBudWxsLCBlcnJvcjogbnVsbCB9KSB9KSxcclxuICAgICAgICAgIH0pLFxyXG4gICAgICAgICAgaW5zZXJ0OiAoKSA9PiAoeyBzZWxlY3Q6ICgpID0+ICh7IHNpbmdsZTogYXN5bmMgKCkgPT4gKHsgZGF0YTogbnVsbCwgZXJyb3I6IG51bGwgfSkgfSkgfSksXHJcbiAgICAgICAgfSksXHJcbiAgICAgICAgY2hhbm5lbDogKCkgPT4gKHsgb246ICgpID0+ICh7IHN1YnNjcmliZTogKCkgPT4gKHsgdW5zdWJzY3JpYmU6ICgpID0+IHt9IH0pIH0pIH0pLFxyXG4gICAgICB9OyAiXSwibmFtZXMiOlsiY3JlYXRlQ2xpZW50IiwidXJsIiwicHJvY2VzcyIsImVudiIsIk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTCIsImtleSIsIk5FWFRfUFVCTElDX1NVUEFCQVNFX0FOT05fS0VZIiwiU1VQQUJBU0VfU0VSVklDRV9ST0xFX0tFWSIsInN1cGFiYXNlIiwiZnJvbSIsInNlbGVjdCIsImVxIiwic2luZ2xlIiwiZGF0YSIsImVycm9yIiwidXBzZXJ0IiwiaW5zZXJ0IiwiY2hhbm5lbCIsIm9uIiwic3Vic2NyaWJlIiwidW5zdWJzY3JpYmUiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./lib/supabaseClient.js\n");

/***/ }),

/***/ "(api)/./lib/translation.js":
/*!****************************!*\
  !*** ./lib/translation.js ***!
  \****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ensureLangCodeFormat: () => (/* binding */ ensureLangCodeFormat),\n/* harmony export */   getTranslation: () => (/* binding */ getTranslation),\n/* harmony export */   saveTranslation: () => (/* binding */ saveTranslation),\n/* harmony export */   translateText: () => (/* binding */ translateText),\n/* harmony export */   translateWithDeepL: () => (/* binding */ translateWithDeepL)\n/* harmony export */ });\n/* harmony import */ var _deepl_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./deepl.js */ \"(api)/./lib/deepl.js\");\n/* harmony import */ var _supabaseClient_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./supabaseClient.js */ \"(api)/./lib/supabaseClient.js\");\n/* harmony import */ var _langUtil_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./langUtil.js */ \"(api)/./lib/langUtil.js\");\n/* harmony import */ var _dataStore_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./dataStore.js */ \"(api)/./lib/dataStore.js\");\n\n\n\n\n// 日本語文字を含むか簡易判定\nconst jpRegex = /[\\u3000-\\u303F\\u3040-\\u309F\\u30A0-\\u30FF\\u4E00-\\u9FFF]/;\nconst detectSourceLang = (t = \"\")=>jpRegex.test(t) ? \"JA\" : \"EN\";\n// DeepL API設定\nconst DEEPL_API_KEY = \"3b6926d8-d7fe-0ab5-a139-58078d395af5:fx\";\n/**\r\n * 言語コードを正規化する（DeepLに適した形式に変換する）\r\n * @param {string} langCode - 言語コード（ja, en, JA, EN など）\r\n * @returns {string} 正規化された言語コード（JA, ENなど）\r\n */ function ensureLangCodeFormat(langCode = \"\") {\n    if (!langCode) return \"JA\"; // デフォルト値\n    // すでに正しい形式（JA, EN）であれば、そのまま返す\n    if (langCode === \"JA\" || langCode === \"EN\") {\n        return langCode;\n    }\n    // 小文字を大文字に変換\n    return langCode.toLowerCase().startsWith(\"ja\") ? \"JA\" : langCode.toLowerCase().startsWith(\"en\") ? \"EN\" : langCode.toUpperCase(); // その他の言語コードはそのまま大文字に\n}\n/**\r\n * DeepL APIを使用してテキストを翻訳する\r\n * @param {object} params - パラメータ\r\n * @param {string|string[]} params.text - 翻訳するテキストまたはテキストの配列\r\n * @param {string} params.targetLang - ターゲット言語コード（'EN'または'JA'）\r\n * @returns {Promise<string>} - 翻訳されたテキスト\r\n */ async function translateWithDeepL({ text, targetLang }) {\n    if (!text) return \"\";\n    if (!DEEPL_API_KEY) {\n        console.error(\"DeepL API キーが設定されていません。\");\n        return Array.isArray(text) ? text[0] || \"\" : text; // APIキーがない場合は原文を返す\n    }\n    // 言語コードの正規化\n    const normalizedTargetLang = (0,_langUtil_js__WEBPACK_IMPORTED_MODULE_2__.mapLang)(targetLang);\n    // ① 前処理 ― トリム・連続ピリオド整理（改行は保持）\n    const cleaned = Array.isArray(text) ? text[0] : text;\n    const cleanedText = cleaned// .replace(/\\r?\\n+/g, ' ')   // 改行を半角スペースに変換する処理を削除\n    .replace(/\\.{3,}/g, \"...\") // ピリオド 3 個を超える部分は 3 個に\n    .trim();\n    if (!cleanedText) return \"\";\n    // 短いテキストの場合は辞書を使った直接翻訳を試みる\n    if (cleanedText.length < 10) {\n        const simpleDict = {\n            \"犬\": {\n                en: \"dog\",\n                ja: \"犬\"\n            },\n            \"猫\": {\n                en: \"cat\",\n                ja: \"猫\"\n            },\n            \"dog\": {\n                en: \"dog\",\n                ja: \"犬\"\n            },\n            \"cat\": {\n                en: \"cat\",\n                ja: \"猫\"\n            },\n            \"hello\": {\n                en: \"hello\",\n                ja: \"こんにちは\"\n            },\n            \"yes\": {\n                en: \"yes\",\n                ja: \"はい\"\n            },\n            \"no\": {\n                en: \"no\",\n                ja: \"いいえ\"\n            }\n        };\n        const dictKey = cleanedText.toLowerCase().trim();\n        const dictEntry = simpleDict[dictKey];\n        if (dictEntry) {\n            const targetLangCode = normalizedTargetLang.toLowerCase() === \"en\" ? \"en\" : \"ja\";\n            const translated = dictEntry[targetLangCode];\n            if (translated && translated !== cleanedText) {\n                console.log(`辞書翻訳: \"${cleanedText}\" → \"${translated}\"`);\n                return translated;\n            }\n        }\n    }\n    try {\n        // ソース言語を検出（日本語文字が含まれるかどうか）\n        const detectedSourceLang = detectSourceLang(cleanedText);\n        // 同じ言語への翻訳は避ける\n        if (detectedSourceLang.toLowerCase() === normalizedTargetLang.toLowerCase()) {\n            console.log(`同じ言語への翻訳をスキップ: ${detectedSourceLang}`);\n            return cleanedText;\n        }\n        console.log(`DeepL翻訳リクエスト: \"${cleanedText.slice(0, 20)}...\" (${detectedSourceLang} → ${normalizedTargetLang})`);\n        // DeepL API呼び出し関数（内部用）\n        async function callDeeplApi(reqText, keepFormatting = true) {\n            try {\n                // Deepl 関数を直接呼び出し\n                const results = await (0,_deepl_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(reqText, normalizedTargetLang, detectedSourceLang // ソース言語を明示的に指定\n                );\n                // 文字列として結果を返す\n                return results || reqText;\n            } catch (err) {\n                console.error(\"DeepL API 呼び出しエラー:\", err.message);\n                return reqText; // エラー時は原文を返す\n            }\n        }\n        // ① １回目の翻訳試行\n        const first = await callDeeplApi(cleanedText, true);\n        // ② 翻訳結果が原文と同じかチェック\n        if (first.trim() === cleanedText.trim()) {\n            console.log(\"翻訳結果が原文と同じです。別の方法で再試行します。\");\n            // 単語辞書で再確認\n            const dictWords = {\n                \"犬\": \"dog\",\n                \"猫\": \"cat\",\n                \"こんにちは\": \"hello\",\n                \"おはよう\": \"good morning\",\n                \"ありがとう\": \"thank you\",\n                \"dog\": \"犬\",\n                \"cat\": \"猫\",\n                \"hello\": \"こんにちは\",\n                \"good morning\": \"おはよう\",\n                \"thank you\": \"ありがとう\"\n            };\n            if (dictWords[cleanedText]) {\n                const dictResult = dictWords[cleanedText];\n                console.log(`辞書による再翻訳: \"${cleanedText}\" → \"${dictResult}\"`);\n                return dictResult;\n            }\n            // フォーマット維持なしで再試行\n            const retry = await callDeeplApi(cleanedText, false);\n            if (retry.trim() !== cleanedText.trim()) {\n                console.log(`フォーマット維持なしで翻訳成功: \"${cleanedText}\" → \"${retry}\"`);\n                return retry;\n            }\n            // それでも同じならソース言語を変えて試す最後の手段\n            const forcedSourceLang = detectedSourceLang === \"JA\" ? \"EN\" : \"JA\";\n            console.log(`最終試行: ソース言語を強制的に ${forcedSourceLang} に設定`);\n            try {\n                const results = await (0,_deepl_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(cleanedText, normalizedTargetLang, forcedSourceLang);\n                const final = results || cleanedText;\n                if (final.trim() !== cleanedText.trim()) {\n                    console.log(`最終試行成功: \"${cleanedText}\" → \"${final}\"`);\n                    return final;\n                }\n            } catch (finalError) {\n                console.error(\"最終翻訳試行エラー:\", finalError);\n            }\n            console.log(\"全ての翻訳試行が失敗しました。原文を返します。\");\n            return cleanedText;\n        }\n        console.log(`翻訳成功: \"${cleanedText.slice(0, 20)}...\" → \"${first.slice(0, 20)}...\"`);\n        return first;\n    } catch (error) {\n        console.error(\"translateWithDeepL エラー:\", error);\n        return cleanedText; // エラー時は原文を返す\n    }\n}\n/**\r\n * DeepL で翻訳し、翻訳テキストを返す\r\n * cleaned: 末尾の「...」などを除去した本文\r\n * @param {string} cleaned - 翻訳するテキスト\r\n * @param {string} targetLang - 翻訳先言語コード\r\n * @param {string|null} sourceLang - 翻訳元言語コード（オプション）\r\n * @returns {Promise<string>} - 翻訳されたテキスト（文字列）\r\n */ async function translateText(cleaned, targetLang, sourceLang = null) {\n    if (!cleaned) return \"\";\n    if (!DEEPL_API_KEY) {\n        console.error(\"DeepL API キーが設定されていません。\");\n        return cleaned; // APIキーがない場合は原文を返す\n    }\n    try {\n        // 言語コードの正規化\n        const normalizedTargetLang = (0,_langUtil_js__WEBPACK_IMPORTED_MODULE_2__.mapLang)(targetLang);\n        //   0: 全体, 1: 本体, 2: 末尾記号\n        const [, core = \"\", trailer = \"\"] = cleaned.match(/^(.*?)([\\u0021-\\u002E\\u3001-\\u303F\\uFF01-\\uFF0F\\u2026]+)?$/u) || [];\n        const text = core || cleaned.trim();\n        if (!text) return cleaned;\n        // ソース言語を検出\n        const effectiveSourceLang = sourceLang ? (0,_langUtil_js__WEBPACK_IMPORTED_MODULE_2__.mapLang)(sourceLang) : detectSourceLang(text);\n        // 同じ言語への翻訳は避ける\n        if (effectiveSourceLang.toLowerCase() === normalizedTargetLang.toLowerCase()) {\n            console.log(`同じ言語への翻訳をスキップ: ${effectiveSourceLang}`);\n            return cleaned;\n        }\n        // まず辞書検索を試す\n        const dictResult = translateWithDictionary(text, normalizedTargetLang);\n        if (dictResult) {\n            console.log(`辞書翻訳成功: \"${text.slice(0, 20)}...\" → \"${dictResult.slice(0, 20)}...\"`);\n            return dictResult + trailer;\n        }\n        // DeepL API呼び出し\n        console.log(`翻訳リクエスト: ${effectiveSourceLang} → ${normalizedTargetLang}`, text.slice(0, 20));\n        const translatedResults = await (0,_deepl_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(text, normalizedTargetLang, effectiveSourceLang);\n        // deepl関数は配列ではなく文字列を返すようになったので、そのまま使用\n        const translatedText = translatedResults || text;\n        // 翻訳結果 + 元の末尾記号を結合\n        const result = (translatedText + trailer).trim();\n        // 翻訳結果が原文と同じ場合は辞書を再確認\n        if (result.trim() === text.trim() + trailer.trim()) {\n            console.log(\"翻訳結果が原文と同じです。強制的に翻訳を試みます。\");\n            // 強制的に反対言語に設定して再試行\n            const forcedSourceLang = effectiveSourceLang === \"JA\" ? \"EN\" : \"JA\";\n            const forcedResults = await (0,_deepl_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(text, normalizedTargetLang, forcedSourceLang);\n            // 配列ではなく文字列を使用\n            const forcedResult = forcedResults || text;\n            if (forcedResult.trim() !== text.trim()) {\n                console.log(`強制翻訳成功: \"${text.slice(0, 20)}...\" → \"${forcedResult.slice(0, 20)}...\"`);\n                return (forcedResult + trailer).trim();\n            }\n            return result; // 失敗した場合はDeepLの結果をそのまま返す\n        }\n        return result;\n    } catch (error) {\n        console.error(\"translateText エラー:\", error);\n        return cleaned; // エラー時は原文を返す\n    }\n}\n/**\r\n * 簡易辞書を使った翻訳\r\n * @param {string} text - 翻訳するテキスト\r\n * @param {string} targetLang - 対象言語\r\n * @returns {string|null} - 翻訳結果、辞書にない場合はnull\r\n */ function translateWithDictionary(text, targetLang) {\n    const simpleDictionary = {\n        // 日本語→英語\n        \"犬\": \"dog\",\n        \"猫\": \"cat\",\n        \"こんにちは\": \"hello\",\n        \"おはよう\": \"good morning\",\n        \"ありがとう\": \"thank you\",\n        \"はい\": \"yes\",\n        \"いいえ\": \"no\",\n        // 英語→日本語\n        \"dog\": \"犬\",\n        \"cat\": \"猫\",\n        \"hello\": \"こんにちは\",\n        \"good morning\": \"おはよう\",\n        \"thank you\": \"ありがとう\",\n        \"yes\": \"はい\",\n        \"no\": \"いいえ\"\n    };\n    const normalizedText = text.trim().toLowerCase();\n    if (simpleDictionary[normalizedText]) {\n        const isENTarget = targetLang.toUpperCase() === \"EN\";\n        const isJAText = /[\\u3040-\\u30FF\\u4E00-\\u9FFF]/.test(normalizedText);\n        // 日本語→英語 または 英語→日本語の方向が合っている場合のみ翻訳\n        if (isENTarget && isJAText || !isENTarget && !isJAText) {\n            return simpleDictionary[normalizedText];\n        }\n    }\n    return null;\n}\n/* ------------------------------------------------------------------------\r\n * ★ 重要: saveTranslation は \"sourceId を必須\" に一本化する\r\n *   - thread でも post でも ID をそのまま sourceId に渡す\r\n *   - 呼び出し側ロジックを単純化\r\n * --------------------------------------------------------------------- */ async function saveTranslation({ sourceId, field, lang, text }) {\n    if (!sourceId || !field || !lang || !text) {\n        console.error(\"saveTranslation: 引数が不足しています\", {\n            sourceId,\n            field,\n            lang,\n            text\n        });\n        return {\n            success: false,\n            error: \"引数が不足しています\"\n        };\n    }\n    try {\n        // 言語コードの正規化\n        const normalizedLang = lang.toLowerCase();\n        const row = {\n            source_id: sourceId,\n            field,\n            language: normalizedLang,\n            translated_content: text,\n            created_at: new Date().toISOString()\n        };\n        // Supabase が null ならメモリだけで動かす\n        if (!_supabaseClient_js__WEBPACK_IMPORTED_MODULE_1__.supabase) {\n            console.log(\"翻訳保存 [mock]:\", sourceId, field, normalizedLang, text.slice(0, 20));\n            return {\n                success: true\n            };\n        }\n        const { error } = await _supabaseClient_js__WEBPACK_IMPORTED_MODULE_1__.supabase.from(\"translations\").upsert(row, {\n            onConflict: \"source_id,field,language\"\n        });\n        if (error) {\n            console.error(\"翻訳保存エラー:\", error);\n            return {\n                success: false,\n                error\n            };\n        }\n        console.log(\"翻訳保存成功:\", sourceId, field, normalizedLang, text.slice(0, 20));\n        return {\n            success: true\n        };\n    } catch (error) {\n        console.error(\"saveTranslation エラー:\", error);\n        return {\n            success: false,\n            error\n        };\n    }\n}\n/* -------------------------------------------------------------------- */ async function getTranslation(sourceId, field, lang) {\n    if (!sourceId || !field || !lang) {\n        console.error(\"getTranslation: 引数が不足しています\", {\n            sourceId,\n            field,\n            lang\n        });\n        return null;\n    }\n    try {\n        // 言語コードの正規化\n        const normalizedLang = lang.toLowerCase();\n        if (!_supabaseClient_js__WEBPACK_IMPORTED_MODULE_1__.supabase) {\n            console.log(\"翻訳取得 [mock]:\", sourceId, field, normalizedLang);\n            return null;\n        }\n        const { data, error } = await _supabaseClient_js__WEBPACK_IMPORTED_MODULE_1__.supabase.from(\"translations\").select(\"translated_content, created_at\").eq(\"source_id\", sourceId).eq(\"field\", field).eq(\"language\", normalizedLang).single();\n        if (error) {\n            // データが見つからない場合はエラーにしない\n            if (error.code === \"PGRST116\") {\n                return null;\n            }\n            console.error(\"翻訳取得エラー:\", error);\n            return null;\n        }\n        console.log(\"翻訳取得成功:\", sourceId, field, normalizedLang, data.translated_content.slice(0, 20));\n        return data.translated_content;\n    } catch (error) {\n        console.error(\"getTranslation エラー:\", error);\n        return null;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LENBQUMsR0FBRztRQUN6RixPQUFPK0MsS0FBS1Isa0JBQWtCO0lBQ2hDLEVBQUUsT0FBT3pELE9BQU87UUFDZEQsUUFBUUMsS0FBSyxDQUFDLHVCQUF1QkE7UUFDckMsT0FBTztJQUNUO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly81Y2gvLi9saWIvdHJhbnNsYXRpb24uanM/Y2QyOCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgZGVlcGwgZnJvbSAnLi9kZWVwbC5qcyc7XHJcbmltcG9ydCB7IHN1cGFiYXNlIH0gZnJvbSAnLi9zdXBhYmFzZUNsaWVudC5qcyc7XHJcbmltcG9ydCB7IGRldGVjdExhbmcsIG1hcExhbmcsIG9wcG9zaXRlTGFuZyB9IGZyb20gJy4vbGFuZ1V0aWwuanMnO1xyXG5pbXBvcnQgeyB0aHJlYWRzU3RvcmUsIHBvc3RzU3RvcmUgfSBmcm9tICcuL2RhdGFTdG9yZS5qcyc7XHJcblxyXG4vLyDml6XmnKzoqp7mloflrZfjgpLlkKvjgoDjgYvnsKHmmJPliKTlrppcclxuY29uc3QganBSZWdleCA9IC9bXFx1MzAwMC1cXHUzMDNGXFx1MzA0MC1cXHUzMDlGXFx1MzBBMC1cXHUzMEZGXFx1NEUwMC1cXHU5RkZGXS87XHJcbmNvbnN0IGRldGVjdFNvdXJjZUxhbmcgPSAodCA9ICcnKSA9PiAoanBSZWdleC50ZXN0KHQpID8gJ0pBJyA6ICdFTicpO1xyXG5cclxuLy8gRGVlcEwgQVBJ6Kit5a6aXHJcbmNvbnN0IERFRVBMX0FQSV9LRVkgPSBwcm9jZXNzLmVudi5ERUVQTF9BUElfS0VZO1xyXG5cclxuLyoqXHJcbiAqIOiogOiqnuOCs+ODvOODieOCkuato+imj+WMluOBmeOCi++8iERlZXBM44Gr6YGp44GX44Gf5b2i5byP44Gr5aSJ5o+b44GZ44KL77yJXHJcbiAqIEBwYXJhbSB7c3RyaW5nfSBsYW5nQ29kZSAtIOiogOiqnuOCs+ODvOODie+8iGphLCBlbiwgSkEsIEVOIOOBquOBqe+8iVxyXG4gKiBAcmV0dXJucyB7c3RyaW5nfSDmraPopo/ljJbjgZXjgozjgZ/oqIDoqp7jgrPjg7zjg4nvvIhKQSwgRU7jgarjganvvIlcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBlbnN1cmVMYW5nQ29kZUZvcm1hdChsYW5nQ29kZSA9ICcnKSB7XHJcbiAgaWYgKCFsYW5nQ29kZSkgcmV0dXJuICdKQSc7IC8vIOODh+ODleOCqeODq+ODiOWApFxyXG4gIFxyXG4gIC8vIOOBmeOBp+OBq+ato+OBl+OBhOW9ouW8j++8iEpBLCBFTu+8ieOBp+OBguOCjOOBsOOAgeOBneOBruOBvuOBvui/lOOBmVxyXG4gIGlmIChsYW5nQ29kZSA9PT0gJ0pBJyB8fCBsYW5nQ29kZSA9PT0gJ0VOJykge1xyXG4gICAgcmV0dXJuIGxhbmdDb2RlO1xyXG4gIH1cclxuICBcclxuICAvLyDlsI/mloflrZfjgpLlpKfmloflrZfjgavlpInmj5tcclxuICByZXR1cm4gbGFuZ0NvZGUudG9Mb3dlckNhc2UoKS5zdGFydHNXaXRoKCdqYScpID8gJ0pBJ1xyXG4gICAgOiBsYW5nQ29kZS50b0xvd2VyQ2FzZSgpLnN0YXJ0c1dpdGgoJ2VuJykgPyAnRU4nXHJcbiAgICA6IGxhbmdDb2RlLnRvVXBwZXJDYXNlKCk7IC8vIOOBneOBruS7luOBruiogOiqnuOCs+ODvOODieOBr+OBneOBruOBvuOBvuWkp+aWh+Wtl+OBq1xyXG59XHJcblxyXG4vKipcclxuICogRGVlcEwgQVBJ44KS5L2/55So44GX44Gm44OG44Kt44K544OI44KS57+76Kiz44GZ44KLXHJcbiAqIEBwYXJhbSB7b2JqZWN0fSBwYXJhbXMgLSDjg5Hjg6njg6Hjg7zjgr9cclxuICogQHBhcmFtIHtzdHJpbmd8c3RyaW5nW119IHBhcmFtcy50ZXh0IC0g57+76Kiz44GZ44KL44OG44Kt44K544OI44G+44Gf44Gv44OG44Kt44K544OI44Gu6YWN5YiXXHJcbiAqIEBwYXJhbSB7c3RyaW5nfSBwYXJhbXMudGFyZ2V0TGFuZyAtIOOCv+ODvOOCsuODg+ODiOiogOiqnuOCs+ODvOODie+8iCdFTifjgb7jgZ/jga8nSkEn77yJXHJcbiAqIEByZXR1cm5zIHtQcm9taXNlPHN0cmluZz59IC0g57+76Kiz44GV44KM44Gf44OG44Kt44K544OIXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdHJhbnNsYXRlV2l0aERlZXBMKHsgdGV4dCwgdGFyZ2V0TGFuZyB9KSB7XHJcbiAgaWYgKCF0ZXh0KSByZXR1cm4gJyc7XHJcbiAgaWYgKCFERUVQTF9BUElfS0VZKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdEZWVwTCBBUEkg44Kt44O844GM6Kit5a6a44GV44KM44Gm44GE44G+44Gb44KT44CCJyk7XHJcbiAgICByZXR1cm4gQXJyYXkuaXNBcnJheSh0ZXh0KSA/IHRleHRbMF0gfHwgJycgOiB0ZXh0OyAvLyBBUEnjgq3jg7zjgYzjgarjgYTloLTlkIjjga/ljp/mlofjgpLov5TjgZlcclxuICB9XHJcblxyXG4gIC8vIOiogOiqnuOCs+ODvOODieOBruato+imj+WMllxyXG4gIGNvbnN0IG5vcm1hbGl6ZWRUYXJnZXRMYW5nID0gbWFwTGFuZyh0YXJnZXRMYW5nKTtcclxuICBcclxuICAvLyDikaAg5YmN5Yem55CGIOKAlSDjg4jjg6rjg6Djg7vpgKPntprjg5Tjg6rjgqrjg4nmlbTnkIbvvIjmlLnooYzjga/kv53mjIHvvIlcclxuICBjb25zdCBjbGVhbmVkID0gQXJyYXkuaXNBcnJheSh0ZXh0KSA/IHRleHRbMF0gOiB0ZXh0O1xyXG4gIGNvbnN0IGNsZWFuZWRUZXh0ID0gY2xlYW5lZFxyXG4gICAgLy8gLnJlcGxhY2UoL1xccj9cXG4rL2csICcgJykgICAvLyDmlLnooYzjgpLljYrop5Ljgrnjg5rjg7zjgrnjgavlpInmj5vjgZnjgovlh6bnkIbjgpLliYrpmaRcclxuICAgIC5yZXBsYWNlKC9cXC57Myx9L2csICcuLi4nKSAgICAvLyDjg5Tjg6rjgqrjg4kgMyDlgIvjgpLotoXjgYjjgovpg6jliIbjga8gMyDlgIvjgatcclxuICAgIC50cmltKCk7XHJcblxyXG4gIGlmICghY2xlYW5lZFRleHQpIHJldHVybiAnJztcclxuXHJcbiAgLy8g55+t44GE44OG44Kt44K544OI44Gu5aC05ZCI44Gv6L6e5pu444KS5L2/44Gj44Gf55u05o6l57+76Kiz44KS6Kmm44G/44KLXHJcbiAgaWYgKGNsZWFuZWRUZXh0Lmxlbmd0aCA8IDEwKSB7XHJcbiAgICBjb25zdCBzaW1wbGVEaWN0ID0ge1xyXG4gICAgICAn54qsJzogeyBlbjogJ2RvZycsIGphOiAn54qsJyB9LFxyXG4gICAgICAn54yrJzogeyBlbjogJ2NhdCcsIGphOiAn54yrJyB9LFxyXG4gICAgICAnZG9nJzogeyBlbjogJ2RvZycsIGphOiAn54qsJyB9LFxyXG4gICAgICAnY2F0JzogeyBlbjogJ2NhdCcsIGphOiAn54yrJyB9LFxyXG4gICAgICAnaGVsbG8nOiB7IGVuOiAnaGVsbG8nLCBqYTogJ+OBk+OCk+OBq+OBoeOBrycgfSxcclxuICAgICAgJ3llcyc6IHsgZW46ICd5ZXMnLCBqYTogJ+OBr+OBhCcgfSxcclxuICAgICAgJ25vJzogeyBlbjogJ25vJywgamE6ICfjgYTjgYTjgYgnIH1cclxuICAgIH07XHJcbiAgICBcclxuICAgIGNvbnN0IGRpY3RLZXkgPSBjbGVhbmVkVGV4dC50b0xvd2VyQ2FzZSgpLnRyaW0oKTtcclxuICAgIGNvbnN0IGRpY3RFbnRyeSA9IHNpbXBsZURpY3RbZGljdEtleV07XHJcbiAgICBpZiAoZGljdEVudHJ5KSB7XHJcbiAgICAgIGNvbnN0IHRhcmdldExhbmdDb2RlID0gbm9ybWFsaXplZFRhcmdldExhbmcudG9Mb3dlckNhc2UoKSA9PT0gJ2VuJyA/ICdlbicgOiAnamEnO1xyXG4gICAgICBjb25zdCB0cmFuc2xhdGVkID0gZGljdEVudHJ5W3RhcmdldExhbmdDb2RlXTtcclxuICAgICAgaWYgKHRyYW5zbGF0ZWQgJiYgdHJhbnNsYXRlZCAhPT0gY2xlYW5lZFRleHQpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhg6L6e5pu457+76KizOiBcIiR7Y2xlYW5lZFRleHR9XCIg4oaSIFwiJHt0cmFuc2xhdGVkfVwiYCk7XHJcbiAgICAgICAgcmV0dXJuIHRyYW5zbGF0ZWQ7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIHRyeSB7XHJcbiAgICAvLyDjgr3jg7zjgrnoqIDoqp7jgpLmpJzlh7rvvIjml6XmnKzoqp7mloflrZfjgYzlkKvjgb7jgozjgovjgYvjganjgYbjgYvvvIlcclxuICAgIGNvbnN0IGRldGVjdGVkU291cmNlTGFuZyA9IGRldGVjdFNvdXJjZUxhbmcoY2xlYW5lZFRleHQpO1xyXG4gICAgXHJcbiAgICAvLyDlkIzjgZjoqIDoqp7jgbjjga7nv7voqLPjga/pgb/jgZHjgotcclxuICAgIGlmIChkZXRlY3RlZFNvdXJjZUxhbmcudG9Mb3dlckNhc2UoKSA9PT0gbm9ybWFsaXplZFRhcmdldExhbmcudG9Mb3dlckNhc2UoKSkge1xyXG4gICAgICBjb25zb2xlLmxvZyhg5ZCM44GY6KiA6Kqe44G444Gu57+76Kiz44KS44K544Kt44OD44OXOiAke2RldGVjdGVkU291cmNlTGFuZ31gKTtcclxuICAgICAgcmV0dXJuIGNsZWFuZWRUZXh0O1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBjb25zb2xlLmxvZyhgRGVlcEznv7voqLPjg6rjgq/jgqjjgrnjg4g6IFwiJHtjbGVhbmVkVGV4dC5zbGljZSgwLCAyMCl9Li4uXCIgKCR7ZGV0ZWN0ZWRTb3VyY2VMYW5nfSDihpIgJHtub3JtYWxpemVkVGFyZ2V0TGFuZ30pYCk7XHJcblxyXG4gICAgLy8gRGVlcEwgQVBJ5ZG844Gz5Ye644GX6Zai5pWw77yI5YaF6YOo55So77yJXHJcbiAgICBhc3luYyBmdW5jdGlvbiBjYWxsRGVlcGxBcGkocmVxVGV4dCwga2VlcEZvcm1hdHRpbmcgPSB0cnVlKSB7XHJcbiAgICAgIHRyeSB7XHJcbiAgICAgICAgLy8gRGVlcGwg6Zai5pWw44KS55u05o6l5ZG844Gz5Ye644GXXHJcbiAgICAgICAgY29uc3QgcmVzdWx0cyA9IGF3YWl0IGRlZXBsKFxyXG4gICAgICAgICAgcmVxVGV4dCxcclxuICAgICAgICAgIG5vcm1hbGl6ZWRUYXJnZXRMYW5nLFxyXG4gICAgICAgICAgZGV0ZWN0ZWRTb3VyY2VMYW5nIC8vIOOCveODvOOCueiogOiqnuOCkuaYjuekuueahOOBq+aMh+WumlxyXG4gICAgICAgICk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8g5paH5a2X5YiX44Go44GX44Gm57WQ5p6c44KS6L+U44GZXHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdHMgfHwgcmVxVGV4dDtcclxuICAgICAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRGVlcEwgQVBJIOWRvOOBs+WHuuOBl+OCqOODqeODvDonLCBlcnIubWVzc2FnZSk7XHJcbiAgICAgICAgcmV0dXJuIHJlcVRleHQ7IC8vIOOCqOODqeODvOaZguOBr+WOn+aWh+OCkui/lOOBmVxyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8g4pGgIO+8keWbnuebruOBrue/u+ios+ippuihjFxyXG4gICAgY29uc3QgZmlyc3QgPSBhd2FpdCBjYWxsRGVlcGxBcGkoY2xlYW5lZFRleHQsIHRydWUpO1xyXG5cclxuICAgIC8vIOKRoSDnv7voqLPntZDmnpzjgYzljp/mlofjgajlkIzjgZjjgYvjg4Hjgqfjg4Pjgq9cclxuICAgIGlmIChmaXJzdC50cmltKCkgPT09IGNsZWFuZWRUZXh0LnRyaW0oKSkge1xyXG4gICAgICBjb25zb2xlLmxvZygn57+76Kiz57WQ5p6c44GM5Y6f5paH44Go5ZCM44GY44Gn44GZ44CC5Yil44Gu5pa55rOV44Gn5YaN6Kmm6KGM44GX44G+44GZ44CCJyk7XHJcbiAgICAgIFxyXG4gICAgICAvLyDljZjoqp7ovp7mm7jjgaflho3norroqo1cclxuICAgICAgY29uc3QgZGljdFdvcmRzID0ge1xyXG4gICAgICAgICfniqwnOiAnZG9nJyxcclxuICAgICAgICAn54yrJzogJ2NhdCcsXHJcbiAgICAgICAgJ+OBk+OCk+OBq+OBoeOBryc6ICdoZWxsbycsXHJcbiAgICAgICAgJ+OBiuOBr+OCiOOBhic6ICdnb29kIG1vcm5pbmcnLFxyXG4gICAgICAgICfjgYLjgorjgYzjgajjgYYnOiAndGhhbmsgeW91JyxcclxuICAgICAgICAnZG9nJzogJ+eKrCcsXHJcbiAgICAgICAgJ2NhdCc6ICfnjKsnLFxyXG4gICAgICAgICdoZWxsbyc6ICfjgZPjgpPjgavjgaHjga8nLFxyXG4gICAgICAgICdnb29kIG1vcm5pbmcnOiAn44GK44Gv44KI44GGJyxcclxuICAgICAgICAndGhhbmsgeW91JzogJ+OBguOCiuOBjOOBqOOBhidcclxuICAgICAgfTtcclxuICAgICAgXHJcbiAgICAgIGlmIChkaWN0V29yZHNbY2xlYW5lZFRleHRdKSB7XHJcbiAgICAgICAgY29uc3QgZGljdFJlc3VsdCA9IGRpY3RXb3Jkc1tjbGVhbmVkVGV4dF07XHJcbiAgICAgICAgY29uc29sZS5sb2coYOi+nuabuOOBq+OCiOOCi+WGjee/u+ioszogXCIke2NsZWFuZWRUZXh0fVwiIOKGkiBcIiR7ZGljdFJlc3VsdH1cImApO1xyXG4gICAgICAgIHJldHVybiBkaWN0UmVzdWx0O1xyXG4gICAgICB9XHJcbiAgICAgIFxyXG4gICAgICAvLyDjg5Xjgqnjg7zjg57jg4Pjg4jntq3mjIHjgarjgZfjgaflho3oqabooYxcclxuICAgICAgY29uc3QgcmV0cnkgPSBhd2FpdCBjYWxsRGVlcGxBcGkoY2xlYW5lZFRleHQsIGZhbHNlKTtcclxuICAgICAgXHJcbiAgICAgIGlmIChyZXRyeS50cmltKCkgIT09IGNsZWFuZWRUZXh0LnRyaW0oKSkge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGDjg5Xjgqnjg7zjg57jg4Pjg4jntq3mjIHjgarjgZfjgafnv7voqLPmiJDlip86IFwiJHtjbGVhbmVkVGV4dH1cIiDihpIgXCIke3JldHJ5fVwiYCk7XHJcbiAgICAgICAgcmV0dXJuIHJldHJ5O1xyXG4gICAgICB9XHJcbiAgICAgIFxyXG4gICAgICAvLyDjgZ3jgozjgafjgoLlkIzjgZjjgarjgonjgr3jg7zjgrnoqIDoqp7jgpLlpInjgYjjgaboqabjgZnmnIDlvozjga7miYvmrrVcclxuICAgICAgY29uc3QgZm9yY2VkU291cmNlTGFuZyA9IGRldGVjdGVkU291cmNlTGFuZyA9PT0gJ0pBJyA/ICdFTicgOiAnSkEnO1xyXG4gICAgICBjb25zb2xlLmxvZyhg5pyA57WC6Kmm6KGMOiDjgr3jg7zjgrnoqIDoqp7jgpLlvLfliLbnmoTjgasgJHtmb3JjZWRTb3VyY2VMYW5nfSDjgavoqK3lrppgKTtcclxuICAgICAgXHJcbiAgICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0cyA9IGF3YWl0IGRlZXBsKGNsZWFuZWRUZXh0LCBub3JtYWxpemVkVGFyZ2V0TGFuZywgZm9yY2VkU291cmNlTGFuZyk7XHJcbiAgICAgICAgY29uc3QgZmluYWwgPSByZXN1bHRzIHx8IGNsZWFuZWRUZXh0O1xyXG4gICAgICAgIFxyXG4gICAgICAgIGlmIChmaW5hbC50cmltKCkgIT09IGNsZWFuZWRUZXh0LnRyaW0oKSkge1xyXG4gICAgICAgICAgY29uc29sZS5sb2coYOacgOe1guippuihjOaIkOWKnzogXCIke2NsZWFuZWRUZXh0fVwiIOKGkiBcIiR7ZmluYWx9XCJgKTtcclxuICAgICAgICAgIHJldHVybiBmaW5hbDtcclxuICAgICAgICB9XHJcbiAgICAgIH0gY2F0Y2ggKGZpbmFsRXJyb3IpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCfmnIDntYLnv7voqLPoqabooYzjgqjjg6njg7w6JywgZmluYWxFcnJvcik7XHJcbiAgICAgIH1cclxuICAgICAgXHJcbiAgICAgIGNvbnNvbGUubG9nKCflhajjgabjga7nv7voqLPoqabooYzjgYzlpLHmlZfjgZfjgb7jgZfjgZ/jgILljp/mlofjgpLov5TjgZfjgb7jgZnjgIInKTtcclxuICAgICAgcmV0dXJuIGNsZWFuZWRUZXh0O1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnNvbGUubG9nKGDnv7voqLPmiJDlip86IFwiJHtjbGVhbmVkVGV4dC5zbGljZSgwLCAyMCl9Li4uXCIg4oaSIFwiJHtmaXJzdC5zbGljZSgwLCAyMCl9Li4uXCJgKTtcclxuICAgIHJldHVybiBmaXJzdDtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcigndHJhbnNsYXRlV2l0aERlZXBMIOOCqOODqeODvDonLCBlcnJvcik7XHJcbiAgICByZXR1cm4gY2xlYW5lZFRleHQ7IC8vIOOCqOODqeODvOaZguOBr+WOn+aWh+OCkui/lOOBmVxyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIERlZXBMIOOBp+e/u+ios+OBl+OAgee/u+ios+ODhuOCreOCueODiOOCkui/lOOBmVxyXG4gKiBjbGVhbmVkOiDmnKvlsL7jga7jgIwuLi7jgI3jgarjganjgpLpmaTljrvjgZfjgZ/mnKzmlodcclxuICogQHBhcmFtIHtzdHJpbmd9IGNsZWFuZWQgLSDnv7voqLPjgZnjgovjg4bjgq3jgrnjg4hcclxuICogQHBhcmFtIHtzdHJpbmd9IHRhcmdldExhbmcgLSDnv7voqLPlhYjoqIDoqp7jgrPjg7zjg4lcclxuICogQHBhcmFtIHtzdHJpbmd8bnVsbH0gc291cmNlTGFuZyAtIOe/u+ios+WFg+iogOiqnuOCs+ODvOODie+8iOOCquODl+OCt+ODp+ODs++8iVxyXG4gKiBAcmV0dXJucyB7UHJvbWlzZTxzdHJpbmc+fSAtIOe/u+ios+OBleOCjOOBn+ODhuOCreOCueODiO+8iOaWh+Wtl+WIl++8iVxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHRyYW5zbGF0ZVRleHQoY2xlYW5lZCwgdGFyZ2V0TGFuZywgc291cmNlTGFuZyA9IG51bGwpIHtcclxuICBpZiAoIWNsZWFuZWQpIHJldHVybiAnJztcclxuICBpZiAoIURFRVBMX0FQSV9LRVkpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0RlZXBMIEFQSSDjgq3jg7zjgYzoqK3lrprjgZXjgozjgabjgYTjgb7jgZvjgpPjgIInKTtcclxuICAgIHJldHVybiBjbGVhbmVkOyAvLyBBUEnjgq3jg7zjgYzjgarjgYTloLTlkIjjga/ljp/mlofjgpLov5TjgZlcclxuICB9XHJcblxyXG4gIHRyeSB7XHJcbiAgICAvLyDoqIDoqp7jgrPjg7zjg4njga7mraPopo/ljJZcclxuICAgIGNvbnN0IG5vcm1hbGl6ZWRUYXJnZXRMYW5nID0gbWFwTGFuZyh0YXJnZXRMYW5nKTtcclxuICAgIFxyXG4gICAgLy8gICAwOiDlhajkvZMsIDE6IOacrOS9kywgMjog5pyr5bC+6KiY5Y+3XHJcbiAgICBjb25zdCBbLCBjb3JlID0gJycsIHRyYWlsZXIgPSAnJ10gPSBjbGVhbmVkLm1hdGNoKC9eKC4qPykoW1xcdTAwMjEtXFx1MDAyRVxcdTMwMDEtXFx1MzAzRlxcdUZGMDEtXFx1RkYwRlxcdTIwMjZdKyk/JC91KSB8fCBbXTtcclxuICAgIGNvbnN0IHRleHQgPSBjb3JlIHx8IGNsZWFuZWQudHJpbSgpO1xyXG5cclxuICAgIGlmICghdGV4dCkgcmV0dXJuIGNsZWFuZWQ7XHJcblxyXG4gICAgLy8g44K944O844K56KiA6Kqe44KS5qSc5Ye6XHJcbiAgICBjb25zdCBlZmZlY3RpdmVTb3VyY2VMYW5nID0gc291cmNlTGFuZyA/IG1hcExhbmcoc291cmNlTGFuZykgOiBkZXRlY3RTb3VyY2VMYW5nKHRleHQpO1xyXG4gICAgXHJcbiAgICAvLyDlkIzjgZjoqIDoqp7jgbjjga7nv7voqLPjga/pgb/jgZHjgotcclxuICAgIGlmIChlZmZlY3RpdmVTb3VyY2VMYW5nLnRvTG93ZXJDYXNlKCkgPT09IG5vcm1hbGl6ZWRUYXJnZXRMYW5nLnRvTG93ZXJDYXNlKCkpIHtcclxuICAgICAgY29uc29sZS5sb2coYOWQjOOBmOiogOiqnuOBuOOBrue/u+ios+OCkuOCueOCreODg+ODlzogJHtlZmZlY3RpdmVTb3VyY2VMYW5nfWApO1xyXG4gICAgICByZXR1cm4gY2xlYW5lZDtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8g44G+44Ga6L6e5pu45qSc57Si44KS6Kmm44GZXHJcbiAgICBjb25zdCBkaWN0UmVzdWx0ID0gdHJhbnNsYXRlV2l0aERpY3Rpb25hcnkodGV4dCwgbm9ybWFsaXplZFRhcmdldExhbmcpO1xyXG4gICAgaWYgKGRpY3RSZXN1bHQpIHtcclxuICAgICAgY29uc29sZS5sb2coYOi+nuabuOe/u+ios+aIkOWKnzogXCIke3RleHQuc2xpY2UoMCwgMjApfS4uLlwiIOKGkiBcIiR7ZGljdFJlc3VsdC5zbGljZSgwLCAyMCl9Li4uXCJgKTtcclxuICAgICAgcmV0dXJuIGRpY3RSZXN1bHQgKyB0cmFpbGVyO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBEZWVwTCBBUEnlkbzjgbPlh7rjgZdcclxuICAgIGNvbnNvbGUubG9nKGDnv7voqLPjg6rjgq/jgqjjgrnjg4g6ICR7ZWZmZWN0aXZlU291cmNlTGFuZ30g4oaSICR7bm9ybWFsaXplZFRhcmdldExhbmd9YCwgdGV4dC5zbGljZSgwLCAyMCkpO1xyXG4gICAgXHJcbiAgICBjb25zdCB0cmFuc2xhdGVkUmVzdWx0cyA9IGF3YWl0IGRlZXBsKFxyXG4gICAgICB0ZXh0LFxyXG4gICAgICBub3JtYWxpemVkVGFyZ2V0TGFuZyxcclxuICAgICAgZWZmZWN0aXZlU291cmNlTGFuZ1xyXG4gICAgKTtcclxuICAgIFxyXG4gICAgLy8gZGVlcGzplqLmlbDjga/phY3liJfjgafjga/jgarjgY/mloflrZfliJfjgpLov5TjgZnjgojjgYbjgavjgarjgaPjgZ/jga7jgafjgIHjgZ3jga7jgb7jgb7kvb/nlKhcclxuICAgIGNvbnN0IHRyYW5zbGF0ZWRUZXh0ID0gdHJhbnNsYXRlZFJlc3VsdHMgfHwgdGV4dDtcclxuICAgIFxyXG4gICAgLy8g57+76Kiz57WQ5p6cICsg5YWD44Gu5pyr5bC+6KiY5Y+344KS57WQ5ZCIXHJcbiAgICBjb25zdCByZXN1bHQgPSAodHJhbnNsYXRlZFRleHQgKyB0cmFpbGVyKS50cmltKCk7XHJcbiAgICBcclxuICAgIC8vIOe/u+ios+e1kOaenOOBjOWOn+aWh+OBqOWQjOOBmOWgtOWQiOOBr+i+nuabuOOCkuWGjeeiuuiqjVxyXG4gICAgaWYgKHJlc3VsdC50cmltKCkgPT09IHRleHQudHJpbSgpICsgdHJhaWxlci50cmltKCkpIHtcclxuICAgICAgY29uc29sZS5sb2coJ+e/u+ios+e1kOaenOOBjOWOn+aWh+OBqOWQjOOBmOOBp+OBmeOAguW8t+WItueahOOBq+e/u+ios+OCkuippuOBv+OBvuOBmeOAgicpO1xyXG4gICAgICBcclxuICAgICAgLy8g5by35Yi255qE44Gr5Y+N5a++6KiA6Kqe44Gr6Kit5a6a44GX44Gm5YaN6Kmm6KGMXHJcbiAgICAgIGNvbnN0IGZvcmNlZFNvdXJjZUxhbmcgPSBlZmZlY3RpdmVTb3VyY2VMYW5nID09PSAnSkEnID8gJ0VOJyA6ICdKQSc7XHJcbiAgICAgIGNvbnN0IGZvcmNlZFJlc3VsdHMgPSBhd2FpdCBkZWVwbCh0ZXh0LCBub3JtYWxpemVkVGFyZ2V0TGFuZywgZm9yY2VkU291cmNlTGFuZyk7XHJcbiAgICAgIFxyXG4gICAgICAvLyDphY3liJfjgafjga/jgarjgY/mloflrZfliJfjgpLkvb/nlKhcclxuICAgICAgY29uc3QgZm9yY2VkUmVzdWx0ID0gZm9yY2VkUmVzdWx0cyB8fCB0ZXh0O1xyXG4gICAgICBcclxuICAgICAgaWYgKGZvcmNlZFJlc3VsdC50cmltKCkgIT09IHRleHQudHJpbSgpKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coYOW8t+WItue/u+ios+aIkOWKnzogXCIke3RleHQuc2xpY2UoMCwgMjApfS4uLlwiIOKGkiBcIiR7Zm9yY2VkUmVzdWx0LnNsaWNlKDAsIDIwKX0uLi5cImApO1xyXG4gICAgICAgIHJldHVybiAoZm9yY2VkUmVzdWx0ICsgdHJhaWxlcikudHJpbSgpO1xyXG4gICAgICB9XHJcbiAgICAgIFxyXG4gICAgICByZXR1cm4gcmVzdWx0OyAvLyDlpLHmlZfjgZfjgZ/loLTlkIjjga9EZWVwTOOBrue1kOaenOOCkuOBneOBruOBvuOBvui/lOOBmVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCd0cmFuc2xhdGVUZXh0IOOCqOODqeODvDonLCBlcnJvcik7XHJcbiAgICByZXR1cm4gY2xlYW5lZDsgLy8g44Ko44Op44O85pmC44Gv5Y6f5paH44KS6L+U44GZXHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICog57Ch5piT6L6e5pu444KS5L2/44Gj44Gf57+76KizXHJcbiAqIEBwYXJhbSB7c3RyaW5nfSB0ZXh0IC0g57+76Kiz44GZ44KL44OG44Kt44K544OIXHJcbiAqIEBwYXJhbSB7c3RyaW5nfSB0YXJnZXRMYW5nIC0g5a++6LGh6KiA6KqeXHJcbiAqIEByZXR1cm5zIHtzdHJpbmd8bnVsbH0gLSDnv7voqLPntZDmnpzjgIHovp7mm7jjgavjgarjgYTloLTlkIjjga9udWxsXHJcbiAqL1xyXG5mdW5jdGlvbiB0cmFuc2xhdGVXaXRoRGljdGlvbmFyeSh0ZXh0LCB0YXJnZXRMYW5nKSB7XHJcbiAgY29uc3Qgc2ltcGxlRGljdGlvbmFyeSA9IHtcclxuICAgIC8vIOaXpeacrOiqnuKGkuiLseiqnlxyXG4gICAgJ+eKrCc6ICdkb2cnLFxyXG4gICAgJ+eMqyc6ICdjYXQnLFxyXG4gICAgJ+OBk+OCk+OBq+OBoeOBryc6ICdoZWxsbycsXHJcbiAgICAn44GK44Gv44KI44GGJzogJ2dvb2QgbW9ybmluZycsXHJcbiAgICAn44GC44KK44GM44Go44GGJzogJ3RoYW5rIHlvdScsXHJcbiAgICAn44Gv44GEJzogJ3llcycsXHJcbiAgICAn44GE44GE44GIJzogJ25vJyxcclxuICAgIFxyXG4gICAgLy8g6Iux6Kqe4oaS5pel5pys6KqeXHJcbiAgICAnZG9nJzogJ+eKrCcsXHJcbiAgICAnY2F0JzogJ+eMqycsXHJcbiAgICAnaGVsbG8nOiAn44GT44KT44Gr44Gh44GvJyxcclxuICAgICdnb29kIG1vcm5pbmcnOiAn44GK44Gv44KI44GGJyxcclxuICAgICd0aGFuayB5b3UnOiAn44GC44KK44GM44Go44GGJyxcclxuICAgICd5ZXMnOiAn44Gv44GEJyxcclxuICAgICdubyc6ICfjgYTjgYTjgYgnXHJcbiAgfTtcclxuICBcclxuICBjb25zdCBub3JtYWxpemVkVGV4dCA9IHRleHQudHJpbSgpLnRvTG93ZXJDYXNlKCk7XHJcbiAgXHJcbiAgaWYgKHNpbXBsZURpY3Rpb25hcnlbbm9ybWFsaXplZFRleHRdKSB7XHJcbiAgICBjb25zdCBpc0VOVGFyZ2V0ID0gdGFyZ2V0TGFuZy50b1VwcGVyQ2FzZSgpID09PSAnRU4nO1xyXG4gICAgY29uc3QgaXNKQVRleHQgPSAvW1xcdTMwNDAtXFx1MzBGRlxcdTRFMDAtXFx1OUZGRl0vLnRlc3Qobm9ybWFsaXplZFRleHQpO1xyXG4gICAgXHJcbiAgICAvLyDml6XmnKzoqp7ihpLoi7Hoqp4g44G+44Gf44GvIOiLseiqnuKGkuaXpeacrOiqnuOBruaWueWQkeOBjOWQiOOBo+OBpuOBhOOCi+WgtOWQiOOBruOBv+e/u+ios1xyXG4gICAgaWYgKChpc0VOVGFyZ2V0ICYmIGlzSkFUZXh0KSB8fCAoIWlzRU5UYXJnZXQgJiYgIWlzSkFUZXh0KSkge1xyXG4gICAgICByZXR1cm4gc2ltcGxlRGljdGlvbmFyeVtub3JtYWxpemVkVGV4dF07XHJcbiAgICB9XHJcbiAgfVxyXG4gIFxyXG4gIHJldHVybiBudWxsO1xyXG59XHJcblxyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICog4piFIOmHjeimgTogc2F2ZVRyYW5zbGF0aW9uIOOBryBcInNvdXJjZUlkIOOCkuW/hemgiFwiIOOBq+S4gOacrOWMluOBmeOCi1xyXG4gKiAgIC0gdGhyZWFkIOOBp+OCgiBwb3N0IOOBp+OCgiBJRCDjgpLjgZ3jga7jgb7jgb4gc291cmNlSWQg44Gr5rih44GZXHJcbiAqICAgLSDlkbzjgbPlh7rjgZflgbTjg63jgrjjg4Pjgq/jgpLljZjntJTljJZcclxuICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzYXZlVHJhbnNsYXRpb24oeyBzb3VyY2VJZCwgZmllbGQsIGxhbmcsIHRleHQgfSkge1xyXG4gIGlmICghc291cmNlSWQgfHwgIWZpZWxkIHx8ICFsYW5nIHx8ICF0ZXh0KSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdzYXZlVHJhbnNsYXRpb246IOW8leaVsOOBjOS4jei2s+OBl+OBpuOBhOOBvuOBmScsIHsgc291cmNlSWQsIGZpZWxkLCBsYW5nLCB0ZXh0IH0pO1xyXG4gICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAn5byV5pWw44GM5LiN6Laz44GX44Gm44GE44G+44GZJyB9O1xyXG4gIH1cclxuXHJcbiAgdHJ5IHtcclxuICAgIC8vIOiogOiqnuOCs+ODvOODieOBruato+imj+WMllxyXG4gICAgY29uc3Qgbm9ybWFsaXplZExhbmcgPSBsYW5nLnRvTG93ZXJDYXNlKCk7XHJcbiAgICBcclxuICAgIGNvbnN0IHJvdyA9IHtcclxuICAgICAgc291cmNlX2lkOiBzb3VyY2VJZCxcclxuICAgICAgZmllbGQsXHJcbiAgICAgIGxhbmd1YWdlOiBub3JtYWxpemVkTGFuZyxcclxuICAgICAgdHJhbnNsYXRlZF9jb250ZW50OiB0ZXh0LFxyXG4gICAgICBjcmVhdGVkX2F0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXHJcbiAgICB9O1xyXG5cclxuICAgIC8vIFN1cGFiYXNlIOOBjCBudWxsIOOBquOCieODoeODouODquOBoOOBkeOBp+WLleOBi+OBmVxyXG4gICAgaWYgKCFzdXBhYmFzZSkge1xyXG4gICAgICBjb25zb2xlLmxvZygn57+76Kiz5L+d5a2YIFttb2NrXTonLCBzb3VyY2VJZCwgZmllbGQsIG5vcm1hbGl6ZWRMYW5nLCB0ZXh0LnNsaWNlKDAsIDIwKSk7XHJcbiAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgY29uc3QgeyBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2UuZnJvbSgndHJhbnNsYXRpb25zJylcclxuICAgICAgLnVwc2VydChyb3csIHsgb25Db25mbGljdDogJ3NvdXJjZV9pZCxmaWVsZCxsYW5ndWFnZScgfSk7XHJcbiAgICAgIFxyXG4gICAgaWYgKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ+e/u+ios+S/neWtmOOCqOODqeODvDonLCBlcnJvcik7XHJcbiAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvciB9O1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBjb25zb2xlLmxvZygn57+76Kiz5L+d5a2Y5oiQ5YqfOicsIHNvdXJjZUlkLCBmaWVsZCwgbm9ybWFsaXplZExhbmcsIHRleHQuc2xpY2UoMCwgMjApKTtcclxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignc2F2ZVRyYW5zbGF0aW9uIOOCqOODqeODvDonLCBlcnJvcik7XHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3IgfTtcclxuICB9XHJcbn1cclxuXHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRUcmFuc2xhdGlvbihzb3VyY2VJZCwgZmllbGQsIGxhbmcpIHtcclxuICBpZiAoIXNvdXJjZUlkIHx8ICFmaWVsZCB8fCAhbGFuZykge1xyXG4gICAgY29uc29sZS5lcnJvcignZ2V0VHJhbnNsYXRpb246IOW8leaVsOOBjOS4jei2s+OBl+OBpuOBhOOBvuOBmScsIHsgc291cmNlSWQsIGZpZWxkLCBsYW5nIH0pO1xyXG4gICAgcmV0dXJuIG51bGw7XHJcbiAgfVxyXG5cclxuICB0cnkge1xyXG4gICAgLy8g6KiA6Kqe44Kz44O844OJ44Gu5q2j6KaP5YyWXHJcbiAgICBjb25zdCBub3JtYWxpemVkTGFuZyA9IGxhbmcudG9Mb3dlckNhc2UoKTtcclxuICAgIFxyXG4gICAgaWYgKCFzdXBhYmFzZSkge1xyXG4gICAgICBjb25zb2xlLmxvZygn57+76Kiz5Y+W5b6XIFttb2NrXTonLCBzb3VyY2VJZCwgZmllbGQsIG5vcm1hbGl6ZWRMYW5nKTtcclxuICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXHJcbiAgICAgIC5mcm9tKCd0cmFuc2xhdGlvbnMnKVxyXG4gICAgICAuc2VsZWN0KCd0cmFuc2xhdGVkX2NvbnRlbnQsIGNyZWF0ZWRfYXQnKVxyXG4gICAgICAuZXEoJ3NvdXJjZV9pZCcsIHNvdXJjZUlkKVxyXG4gICAgICAuZXEoJ2ZpZWxkJywgZmllbGQpXHJcbiAgICAgIC5lcSgnbGFuZ3VhZ2UnLCBub3JtYWxpemVkTGFuZylcclxuICAgICAgLnNpbmdsZSgpO1xyXG4gICAgICBcclxuICAgIGlmIChlcnJvcikge1xyXG4gICAgICAvLyDjg4fjg7zjgr/jgYzopovjgaTjgYvjgonjgarjgYTloLTlkIjjga/jgqjjg6njg7zjgavjgZfjgarjgYRcclxuICAgICAgaWYgKGVycm9yLmNvZGUgPT09ICdQR1JTVDExNicpIHtcclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgfVxyXG4gICAgICBjb25zb2xlLmVycm9yKCfnv7voqLPlj5blvpfjgqjjg6njg7w6JywgZXJyb3IpO1xyXG4gICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuICAgIFxyXG4gICAgY29uc29sZS5sb2coJ+e/u+ios+WPluW+l+aIkOWKnzonLCBzb3VyY2VJZCwgZmllbGQsIG5vcm1hbGl6ZWRMYW5nLCBkYXRhLnRyYW5zbGF0ZWRfY29udGVudC5zbGljZSgwLCAyMCkpO1xyXG4gICAgcmV0dXJuIGRhdGEudHJhbnNsYXRlZF9jb250ZW50O1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdnZXRUcmFuc2xhdGlvbiDjgqjjg6njg7w6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIG51bGw7XHJcbiAgfVxyXG59ICJdLCJuYW1lcyI6WyJkZWVwbCIsInN1cGFiYXNlIiwiZGV0ZWN0TGFuZyIsIm1hcExhbmciLCJvcHBvc2l0ZUxhbmciLCJ0aHJlYWRzU3RvcmUiLCJwb3N0c1N0b3JlIiwianBSZWdleCIsImRldGVjdFNvdXJjZUxhbmciLCJ0IiwidGVzdCIsIkRFRVBMX0FQSV9LRVkiLCJwcm9jZXNzIiwiZW52IiwiZW5zdXJlTGFuZ0NvZGVGb3JtYXQiLCJsYW5nQ29kZSIsInRvTG93ZXJDYXNlIiwic3RhcnRzV2l0aCIsInRvVXBwZXJDYXNlIiwidHJhbnNsYXRlV2l0aERlZXBMIiwidGV4dCIsInRhcmdldExhbmciLCJjb25zb2xlIiwiZXJyb3IiLCJBcnJheSIsImlzQXJyYXkiLCJub3JtYWxpemVkVGFyZ2V0TGFuZyIsImNsZWFuZWQiLCJjbGVhbmVkVGV4dCIsInJlcGxhY2UiLCJ0cmltIiwibGVuZ3RoIiwic2ltcGxlRGljdCIsImVuIiwiamEiLCJkaWN0S2V5IiwiZGljdEVudHJ5IiwidGFyZ2V0TGFuZ0NvZGUiLCJ0cmFuc2xhdGVkIiwibG9nIiwiZGV0ZWN0ZWRTb3VyY2VMYW5nIiwic2xpY2UiLCJjYWxsRGVlcGxBcGkiLCJyZXFUZXh0Iiwia2VlcEZvcm1hdHRpbmciLCJyZXN1bHRzIiwiZXJyIiwibWVzc2FnZSIsImZpcnN0IiwiZGljdFdvcmRzIiwiZGljdFJlc3VsdCIsInJldHJ5IiwiZm9yY2VkU291cmNlTGFuZyIsImZpbmFsIiwiZmluYWxFcnJvciIsInRyYW5zbGF0ZVRleHQiLCJzb3VyY2VMYW5nIiwiY29yZSIsInRyYWlsZXIiLCJtYXRjaCIsImVmZmVjdGl2ZVNvdXJjZUxhbmciLCJ0cmFuc2xhdGVXaXRoRGljdGlvbmFyeSIsInRyYW5zbGF0ZWRSZXN1bHRzIiwidHJhbnNsYXRlZFRleHQiLCJyZXN1bHQiLCJmb3JjZWRSZXN1bHRzIiwiZm9yY2VkUmVzdWx0Iiwic2ltcGxlRGljdGlvbmFyeSIsIm5vcm1hbGl6ZWRUZXh0IiwiaXNFTlRhcmdldCIsImlzSkFUZXh0Iiwic2F2ZVRyYW5zbGF0aW9uIiwic291cmNlSWQiLCJmaWVsZCIsImxhbmciLCJzdWNjZXNzIiwibm9ybWFsaXplZExhbmciLCJyb3ciLCJzb3VyY2VfaWQiLCJsYW5ndWFnZSIsInRyYW5zbGF0ZWRfY29udGVudCIsImNyZWF0ZWRfYXQiLCJEYXRlIiwidG9JU09TdHJpbmciLCJmcm9tIiwidXBzZXJ0Iiwib25Db25mbGljdCIsImdldFRyYW5zbGF0aW9uIiwiZGF0YSIsInNlbGVjdCIsImVxIiwic2luZ2xlIiwiY29kZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./lib/translation.js\n");

/***/ }),

/***/ "(api)/./pages/api/threads/[id].js":
/*!***********************************!*\
  !*** ./pages/api/threads/[id].js ***!
  \***********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var _lib_supabaseClient_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/supabaseClient.js */ \"(api)/./lib/supabaseClient.js\");\n/* harmony import */ var _lib_translation_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../lib/translation.js */ \"(api)/./lib/translation.js\");\n/* harmony import */ var _lib_dataStore_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../lib/dataStore.js */ \"(api)/./lib/dataStore.js\");\n/* harmony import */ var _lib_cache_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../lib/cache.js */ \"(api)/./lib/cache.js\");\n\n\n\n\n// APIルートハンドラー実行時にデータストアの内容を確認\ntry {\n    (0,_lib_dataStore_js__WEBPACK_IMPORTED_MODULE_2__.debugDataStore)();\n} catch (error) {\n    console.error(\"データストア初期化エラー:\", error);\n}\n// 翻訳とキャッシュを扱うヘルパー関数\nasync function translateContent(text, targetLang, sourceLang, contentId, field) {\n    if (!text) {\n        console.log(`テキストが空のため翻訳スキップ (${field} ${contentId})`);\n        return text;\n    }\n    const normalizedSourceLang = sourceLang ? (0,_lib_translation_js__WEBPACK_IMPORTED_MODULE_1__.ensureLangCodeFormat)(sourceLang) : null;\n    const normalizedTargetLang = (0,_lib_translation_js__WEBPACK_IMPORTED_MODULE_1__.ensureLangCodeFormat)(targetLang);\n    if (normalizedSourceLang && normalizedSourceLang === normalizedTargetLang) {\n        // text が文字列であることを確認してから substring を使用\n        const logText = typeof text === \"string\" ? text.substring(0, 50) : \"[non-string_text]\";\n        console.log(`同じ言語への翻訳をスキップ (${field} ${contentId}): ${normalizedSourceLang} -> ${normalizedTargetLang}. Text: \"${logText}...\"`);\n        return text;\n    }\n    const cacheKeyContentId = contentId || \"unknown_content_id\";\n    const cacheKey = `${cacheKeyContentId}_${field}_${normalizedTargetLang}`;\n    const cached = (0,_lib_cache_js__WEBPACK_IMPORTED_MODULE_3__.getCachedTranslation)(cacheKeyContentId, field, normalizedTargetLang);\n    if (cached) {\n        // cached が文字列であることを確認してから substring を使用\n        const logCached = typeof cached === \"string\" ? cached.substring(0, 50) : \"[non-string_cached_value]\";\n        console.log(`キャッシュされた翻訳を使用 (${field} ${cacheKeyContentId}, Key: ${cacheKey}): ${normalizedTargetLang} -> \"${logCached}...\"`);\n        return cached;\n    }\n    const effectiveSourceLang = normalizedSourceLang;\n    // text が文字列であることを確認してから substring を使用\n    const logTextForRequest = typeof text === \"string\" ? text.substring(0, 50) : \"[non-string_text]\";\n    console.log(`DeepL翻訳リクエスト (${field} ${cacheKeyContentId}, Key: ${cacheKey}): \"${logTextForRequest}...\" (${effectiveSourceLang || \"auto\"} → ${normalizedTargetLang})`);\n    const translatedText = await (0,_lib_translation_js__WEBPACK_IMPORTED_MODULE_1__.translateText)(text, normalizedTargetLang, effectiveSourceLang);\n    if (translatedText && typeof translatedText === \"string\" && translatedText !== text) {\n        // translatedText と text が文字列であることを確認してから substring を使用\n        const logOriginalText = typeof text === \"string\" ? text.substring(0, 50) : \"[non-string_original_text]\";\n        const logTranslated = translatedText.substring(0, 50); // translatedText は文字列であることが確認済み\n        console.log(`翻訳成功・キャッシュ保存 (${field} ${cacheKeyContentId}, Key: ${cacheKey}): \"${logOriginalText}...\" → \"${logTranslated}...\"`);\n        (0,_lib_cache_js__WEBPACK_IMPORTED_MODULE_3__.setCachedTranslation)(cacheKeyContentId, field, normalizedTargetLang, translatedText);\n    } else if (translatedText && typeof translatedText === \"string\" && translatedText === text) {\n        console.log(`翻訳結果が元テキストと同じ (${field} ${cacheKeyContentId}, Key: ${cacheKey}): ${normalizedTargetLang}. API呼び出しは行われた可能性があります。`);\n        (0,_lib_cache_js__WEBPACK_IMPORTED_MODULE_3__.setCachedTranslation)(cacheKeyContentId, field, normalizedTargetLang, translatedText);\n    } else if (!translatedText || typeof translatedText !== \"string\") {\n        console.error(`翻訳失敗または結果が文字列でない (${field} ${cacheKeyContentId}, Key: ${cacheKey}): Target: ${normalizedTargetLang}, Result:`, translatedText, `. 元のテキストを返します。\"`);\n        return text;\n    } else {\n        console.error(`予期せぬ翻訳結果 (${field} ${cacheKeyContentId}, Key: ${cacheKey}): Target: ${normalizedTargetLang}. 元のテキストを返します。\"`);\n        return text;\n    }\n    return translatedText;\n}\nasync function handler(req, res) {\n    const { id } = req.query;\n    const uiLangParam = req.query.lang || \"ja\"; // フロントエンドから渡される言語パラメータ\n    const uiLang = (0,_lib_translation_js__WEBPACK_IMPORTED_MODULE_1__.ensureLangCodeFormat)(uiLangParam); // DeepLが期待する形式 (JA, ENなど) に正規化\n    if (req.method === \"GET\") {\n        try {\n            console.log(`API HANDLER: Looking for thread with ID: ${id}, Requested UI language: ${uiLang} (param: ${uiLangParam})`);\n            let threadData = await (0,_lib_dataStore_js__WEBPACK_IMPORTED_MODULE_2__.getThreadWithPosts)(id);\n            if (!threadData) {\n                console.log(`API HANDLER: Thread not found for ID: ${id}`);\n                return res.status(404).json({\n                    error: \"Thread not found\"\n                });\n            }\n            // スレッド自体の元の言語。なければ'ja'をフォールバックとするか、エラーとするかは仕様次第。\n            // ここでは'ja'をフォールバックとします。\n            const threadOriginalLangStored = threadData.lang || \"ja\";\n            const threadOriginalLang = (0,_lib_translation_js__WEBPACK_IMPORTED_MODULE_1__.ensureLangCodeFormat)(threadOriginalLangStored);\n            console.log(`API HANDLER: Thread ${id} original language: ${threadOriginalLang} (stored as ${threadOriginalLangStored})`);\n            // スレッドタイトルの翻訳\n            if (threadData.thread.title) {\n                console.log(`API HANDLER: Processing title for thread ${id}. Original: \"${threadData.thread.title.substring(0, 50)}...\", Original lang: ${threadOriginalLang}, Target UI lang: ${uiLang}`);\n                threadData.thread.title = await translateContent(threadData.thread.title, uiLang, threadOriginalLang, `thread_${id}`, \"title\");\n            } else {\n                console.log(`API HANDLER: Thread ${id} has no title to translate.`);\n            }\n            // スレッド説明文の翻訳\n            if (threadData.thread.description) {\n                console.log(`API HANDLER: Processing description for thread ${id}. Original: \"${threadData.thread.description.substring(0, 50)}...\", Original lang: ${threadOriginalLang}, Target UI lang: ${uiLang}`);\n                const translatedDescription = await translateContent(threadData.thread.description, uiLang, threadOriginalLang, `thread_${id}`, \"description\");\n                threadData.thread[`description_${uiLangParam.toLowerCase()}`] = translatedDescription;\n            } else {\n                console.log(`API HANDLER: Thread ${id} has no description to translate.`);\n            }\n            // 各投稿の本文を翻訳\n            if (threadData.posts && threadData.posts.length > 0) {\n                console.log(`API HANDLER: Processing ${threadData.posts.length} posts for thread ${id}.`);\n                threadData.posts = await Promise.all(threadData.posts.map(async (post)=>{\n                    if (!post || !post.id) {\n                        console.warn(`API HANDLER: Invalid post object found in thread ${id}, skipping.`, post);\n                        return post; // or filter it out earlier\n                    }\n                    if (!post.body) {\n                        console.log(`API HANDLER: Post ${post.id} has no body to translate.`);\n                        return post; // 本文がなければ翻訳不要\n                    }\n                    // 各投稿の元の言語 (post.original_lang がDBに保存されていることを期待)\n                    let postOriginalLangStored = post.original_lang;\n                    let postOriginalLang = null;\n                    if (postOriginalLangStored) {\n                        postOriginalLang = (0,_lib_translation_js__WEBPACK_IMPORTED_MODULE_1__.ensureLangCodeFormat)(postOriginalLangStored);\n                        console.log(`API HANDLER: Post ${post.id} original language from DB: ${postOriginalLang} (stored as ${postOriginalLangStored}) for body: \"${post.body.substring(0, 20)}...\"`);\n                    } else {\n                        // original_lang がない場合、本文から言語を検出\n                        console.log(`API HANDLER: Post ${post.id} original_lang not found in DB. Detecting from body: \"${post.body.substring(0, 20)}...\"`);\n                        try {\n                            const detected = await (0,_lib_translation_js__WEBPACK_IMPORTED_MODULE_1__.detectLang)(post.body); // detectLangはDeepL形式の言語コードを返すと期待\n                            if (detected) {\n                                postOriginalLang = (0,_lib_translation_js__WEBPACK_IMPORTED_MODULE_1__.ensureLangCodeFormat)(detected);\n                                console.log(`API HANDLER: Post ${post.id} language detected as: ${postOriginalLang}`);\n                            // ここで検出した言語をDBの post.original_lang に保存する更新処理を入れても良い (オプション)\n                            // await savePostOriginalLang(post.id, postOriginalLang);\n                            } else {\n                                // 検出失敗時はスレッドの言語にフォールバック\n                                postOriginalLang = threadOriginalLang;\n                                console.log(`API HANDLER: Post ${post.id} language detection failed, falling back to thread lang: ${postOriginalLang}`);\n                            }\n                        } catch (e) {\n                            console.error(`API HANDLER: Error detecting language for post ${post.id}, falling back to thread lang ${threadOriginalLang}. Error:`, e);\n                            postOriginalLang = threadOriginalLang;\n                        }\n                    }\n                    const translatedBody = await translateContent(post.body, uiLang, postOriginalLang, post.id, \"body\");\n                    return {\n                        ...post,\n                        body: translatedBody,\n                        original_lang: postOriginalLang,\n                        translated_to: uiLang\n                    };\n                }));\n            } else {\n                console.log(`API HANDLER: Thread ${id} has no posts to translate.`);\n            }\n            console.log(`API HANDLER: Returning thread ${id} with ${threadData.posts ? threadData.posts.length : 0} posts, processed for UI language ${uiLang}.`);\n            return res.status(200).json(threadData);\n        } catch (error) {\n            console.error(`API HANDLER: Error fetching or processing thread ${id} (UI lang: ${uiLang}). Error:`, error);\n            // エラーオブジェクト全体やスタックトレースをログに出力するとデバッグに役立つ\n            console.error(\"Error details:\", error.message, error.stack);\n            return res.status(500).json({\n                error: \"Failed to fetch or process thread data\",\n                details: error.message\n            });\n        }\n    } else {\n        console.log(`API HANDLER: Method ${req.method} not allowed for /api/threads/[id]`);\n        res.setHeader(\"Allow\", [\n            \"GET\"\n        ]); // このエンドポイントがGETのみを想定する場合\n        return res.status(405).json({\n            error: `Method ${req.method} Not Allowed`\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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aHJlYWRzL1tpZF0uanM/YWU4ZiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBzdXBhYmFzZSB9IGZyb20gJy4uLy4uLy4uL2xpYi9zdXBhYmFzZUNsaWVudC5qcyc7XHJcbmltcG9ydCB7IHRyYW5zbGF0ZVdpdGhEZWVwTCwgZ2V0VHJhbnNsYXRpb24sIHNhdmVUcmFuc2xhdGlvbiwgdHJhbnNsYXRlVGV4dCwgZGV0ZWN0TGFuZywgZW5zdXJlTGFuZ0NvZGVGb3JtYXQgfSBmcm9tICcuLi8uLi8uLi9saWIvdHJhbnNsYXRpb24uanMnO1xyXG5pbXBvcnQgeyB0aHJlYWRzU3RvcmUsIHBvc3RzU3RvcmUsIGFkZFRocmVhZCwgYWRkUG9zdCwgZGVidWdEYXRhU3RvcmUsIGdldFRocmVhZFdpdGhQb3N0cyB9IGZyb20gJy4uLy4uLy4uL2xpYi9kYXRhU3RvcmUuanMnO1xyXG5pbXBvcnQgeyBnZXRDYWNoZWRUcmFuc2xhdGlvbiwgc2V0Q2FjaGVkVHJhbnNsYXRpb24gfSBmcm9tICcuLi8uLi8uLi9saWIvY2FjaGUuanMnO1xyXG5cclxuLy8gQVBJ44Or44O844OI44OP44Oz44OJ44Op44O85a6f6KGM5pmC44Gr44OH44O844K/44K544OI44Ki44Gu5YaF5a6544KS56K66KqNXHJcbnRyeSB7XHJcbiAgZGVidWdEYXRhU3RvcmUoKTtcclxufSBjYXRjaCAoZXJyb3IpIHtcclxuICBjb25zb2xlLmVycm9yKCfjg4fjg7zjgr/jgrnjg4jjgqLliJ3mnJ/ljJbjgqjjg6njg7w6JywgZXJyb3IpO1xyXG59XHJcblxyXG4vLyDnv7voqLPjgajjgq3jg6Pjg4Pjgrfjg6XjgpLmibHjgYbjg5jjg6vjg5Hjg7zplqLmlbBcclxuYXN5bmMgZnVuY3Rpb24gdHJhbnNsYXRlQ29udGVudCh0ZXh0LCB0YXJnZXRMYW5nLCBzb3VyY2VMYW5nLCBjb250ZW50SWQsIGZpZWxkKSB7XHJcbiAgaWYgKCF0ZXh0KSB7XHJcbiAgICBjb25zb2xlLmxvZyhg44OG44Kt44K544OI44GM56m644Gu44Gf44KB57+76Kiz44K544Kt44OD44OXICgke2ZpZWxkfSAke2NvbnRlbnRJZH0pYCk7XHJcbiAgICByZXR1cm4gdGV4dDtcclxuICB9XHJcblxyXG4gIGNvbnN0IG5vcm1hbGl6ZWRTb3VyY2VMYW5nID0gc291cmNlTGFuZyA/IGVuc3VyZUxhbmdDb2RlRm9ybWF0KHNvdXJjZUxhbmcpIDogbnVsbDtcclxuICBjb25zdCBub3JtYWxpemVkVGFyZ2V0TGFuZyA9IGVuc3VyZUxhbmdDb2RlRm9ybWF0KHRhcmdldExhbmcpO1xyXG5cclxuICBpZiAobm9ybWFsaXplZFNvdXJjZUxhbmcgJiYgbm9ybWFsaXplZFNvdXJjZUxhbmcgPT09IG5vcm1hbGl6ZWRUYXJnZXRMYW5nKSB7XHJcbiAgICAvLyB0ZXh0IOOBjOaWh+Wtl+WIl+OBp+OBguOCi+OBk+OBqOOCkueiuuiqjeOBl+OBpuOBi+OCiSBzdWJzdHJpbmcg44KS5L2/55SoXHJcbiAgICBjb25zdCBsb2dUZXh0ID0gdHlwZW9mIHRleHQgPT09ICdzdHJpbmcnID8gdGV4dC5zdWJzdHJpbmcoMCwgNTApIDogJ1tub24tc3RyaW5nX3RleHRdJztcclxuICAgIGNvbnNvbGUubG9nKGDlkIzjgZjoqIDoqp7jgbjjga7nv7voqLPjgpLjgrnjgq3jg4Pjg5cgKCR7ZmllbGR9ICR7Y29udGVudElkfSk6ICR7bm9ybWFsaXplZFNvdXJjZUxhbmd9IC0+ICR7bm9ybWFsaXplZFRhcmdldExhbmd9LiBUZXh0OiBcIiR7bG9nVGV4dH0uLi5cImApO1xyXG4gICAgcmV0dXJuIHRleHQ7XHJcbiAgfVxyXG5cclxuICBjb25zdCBjYWNoZUtleUNvbnRlbnRJZCA9IGNvbnRlbnRJZCB8fCAndW5rbm93bl9jb250ZW50X2lkJztcclxuICBjb25zdCBjYWNoZUtleSA9IGAke2NhY2hlS2V5Q29udGVudElkfV8ke2ZpZWxkfV8ke25vcm1hbGl6ZWRUYXJnZXRMYW5nfWA7XHJcblxyXG4gIGNvbnN0IGNhY2hlZCA9IGdldENhY2hlZFRyYW5zbGF0aW9uKGNhY2hlS2V5Q29udGVudElkLCBmaWVsZCwgbm9ybWFsaXplZFRhcmdldExhbmcpO1xyXG4gIGlmIChjYWNoZWQpIHtcclxuICAgIC8vIGNhY2hlZCDjgYzmloflrZfliJfjgafjgYLjgovjgZPjgajjgpLnorroqo3jgZfjgabjgYvjgokgc3Vic3RyaW5nIOOCkuS9v+eUqFxyXG4gICAgY29uc3QgbG9nQ2FjaGVkID0gdHlwZW9mIGNhY2hlZCA9PT0gJ3N0cmluZycgPyBjYWNoZWQuc3Vic3RyaW5nKDAsIDUwKSA6ICdbbm9uLXN0cmluZ19jYWNoZWRfdmFsdWVdJztcclxuICAgIGNvbnNvbGUubG9nKGDjgq3jg6Pjg4Pjgrfjg6XjgZXjgozjgZ/nv7voqLPjgpLkvb/nlKggKCR7ZmllbGR9ICR7Y2FjaGVLZXlDb250ZW50SWR9LCBLZXk6ICR7Y2FjaGVLZXl9KTogJHtub3JtYWxpemVkVGFyZ2V0TGFuZ30gLT4gXCIke2xvZ0NhY2hlZH0uLi5cImApO1xyXG4gICAgcmV0dXJuIGNhY2hlZDtcclxuICB9XHJcblxyXG4gIGNvbnN0IGVmZmVjdGl2ZVNvdXJjZUxhbmcgPSBub3JtYWxpemVkU291cmNlTGFuZztcclxuXHJcbiAgLy8gdGV4dCDjgYzmloflrZfliJfjgafjgYLjgovjgZPjgajjgpLnorroqo3jgZfjgabjgYvjgokgc3Vic3RyaW5nIOOCkuS9v+eUqFxyXG4gIGNvbnN0IGxvZ1RleHRGb3JSZXF1ZXN0ID0gdHlwZW9mIHRleHQgPT09ICdzdHJpbmcnID8gdGV4dC5zdWJzdHJpbmcoMCwgNTApIDogJ1tub24tc3RyaW5nX3RleHRdJztcclxuICBjb25zb2xlLmxvZyhgRGVlcEznv7voqLPjg6rjgq/jgqjjgrnjg4ggKCR7ZmllbGR9ICR7Y2FjaGVLZXlDb250ZW50SWR9LCBLZXk6ICR7Y2FjaGVLZXl9KTogXCIke2xvZ1RleHRGb3JSZXF1ZXN0fS4uLlwiICgke2VmZmVjdGl2ZVNvdXJjZUxhbmcgfHwgJ2F1dG8nfSDihpIgJHtub3JtYWxpemVkVGFyZ2V0TGFuZ30pYCk7XHJcbiAgY29uc3QgdHJhbnNsYXRlZFRleHQgPSBhd2FpdCB0cmFuc2xhdGVUZXh0KHRleHQsIG5vcm1hbGl6ZWRUYXJnZXRMYW5nLCBlZmZlY3RpdmVTb3VyY2VMYW5nKTtcclxuXHJcbiAgaWYgKHRyYW5zbGF0ZWRUZXh0ICYmIHR5cGVvZiB0cmFuc2xhdGVkVGV4dCA9PT0gJ3N0cmluZycgJiYgdHJhbnNsYXRlZFRleHQgIT09IHRleHQpIHtcclxuICAgIC8vIHRyYW5zbGF0ZWRUZXh0IOOBqCB0ZXh0IOOBjOaWh+Wtl+WIl+OBp+OBguOCi+OBk+OBqOOCkueiuuiqjeOBl+OBpuOBi+OCiSBzdWJzdHJpbmcg44KS5L2/55SoXHJcbiAgICBjb25zdCBsb2dPcmlnaW5hbFRleHQgPSB0eXBlb2YgdGV4dCA9PT0gJ3N0cmluZycgPyB0ZXh0LnN1YnN0cmluZygwLCA1MCkgOiAnW25vbi1zdHJpbmdfb3JpZ2luYWxfdGV4dF0nO1xyXG4gICAgY29uc3QgbG9nVHJhbnNsYXRlZCA9IHRyYW5zbGF0ZWRUZXh0LnN1YnN0cmluZygwLCA1MCk7IC8vIHRyYW5zbGF0ZWRUZXh0IOOBr+aWh+Wtl+WIl+OBp+OBguOCi+OBk+OBqOOBjOeiuuiqjea4iOOBv1xyXG4gICAgY29uc29sZS5sb2coYOe/u+ios+aIkOWKn+ODu+OCreODo+ODg+OCt+ODpeS/neWtmCAoJHtmaWVsZH0gJHtjYWNoZUtleUNvbnRlbnRJZH0sIEtleTogJHtjYWNoZUtleX0pOiBcIiR7bG9nT3JpZ2luYWxUZXh0fS4uLlwiIOKGkiBcIiR7bG9nVHJhbnNsYXRlZH0uLi5cImApO1xyXG4gICAgc2V0Q2FjaGVkVHJhbnNsYXRpb24oY2FjaGVLZXlDb250ZW50SWQsIGZpZWxkLCBub3JtYWxpemVkVGFyZ2V0TGFuZywgdHJhbnNsYXRlZFRleHQpO1xyXG4gIH0gZWxzZSBpZiAodHJhbnNsYXRlZFRleHQgJiYgdHlwZW9mIHRyYW5zbGF0ZWRUZXh0ID09PSAnc3RyaW5nJyAmJiB0cmFuc2xhdGVkVGV4dCA9PT0gdGV4dCkge1xyXG4gICAgY29uc29sZS5sb2coYOe/u+ios+e1kOaenOOBjOWFg+ODhuOCreOCueODiOOBqOWQjOOBmCAoJHtmaWVsZH0gJHtjYWNoZUtleUNvbnRlbnRJZH0sIEtleTogJHtjYWNoZUtleX0pOiAke25vcm1hbGl6ZWRUYXJnZXRMYW5nfS4gQVBJ5ZG844Gz5Ye644GX44Gv6KGM44KP44KM44Gf5Y+v6IO95oCn44GM44GC44KK44G+44GZ44CCYCk7XHJcbiAgICBzZXRDYWNoZWRUcmFuc2xhdGlvbihjYWNoZUtleUNvbnRlbnRJZCwgZmllbGQsIG5vcm1hbGl6ZWRUYXJnZXRMYW5nLCB0cmFuc2xhdGVkVGV4dCk7XHJcbiAgfSBlbHNlIGlmICghdHJhbnNsYXRlZFRleHQgfHwgdHlwZW9mIHRyYW5zbGF0ZWRUZXh0ICE9PSAnc3RyaW5nJykge1xyXG4gICAgY29uc29sZS5lcnJvcihg57+76Kiz5aSx5pWX44G+44Gf44Gv57WQ5p6c44GM5paH5a2X5YiX44Gn44Gq44GEICgke2ZpZWxkfSAke2NhY2hlS2V5Q29udGVudElkfSwgS2V5OiAke2NhY2hlS2V5fSk6IFRhcmdldDogJHtub3JtYWxpemVkVGFyZ2V0TGFuZ30sIFJlc3VsdDpgLCB0cmFuc2xhdGVkVGV4dCwgYC4g5YWD44Gu44OG44Kt44K544OI44KS6L+U44GX44G+44GZ44CCXCJgKTtcclxuICAgIHJldHVybiB0ZXh0O1xyXG4gIH0gZWxzZSB7IC8vIOOBk+OBrmVsc2Xjga/pgJrluLjliLDpgZTjgZfjgarjgYTjga/jgZrjgaDjgYzjgIHlv7Xjga7jgZ/jgoFcclxuICAgIGNvbnNvbGUuZXJyb3IoYOS6iOacn+OBm+OBrOe/u+ios+e1kOaenCAoJHtmaWVsZH0gJHtjYWNoZUtleUNvbnRlbnRJZH0sIEtleTogJHtjYWNoZUtleX0pOiBUYXJnZXQ6ICR7bm9ybWFsaXplZFRhcmdldExhbmd9LiDlhYPjga7jg4bjgq3jgrnjg4jjgpLov5TjgZfjgb7jgZnjgIJcImApO1xyXG4gICAgcmV0dXJuIHRleHQ7XHJcbiAgfVxyXG4gIHJldHVybiB0cmFuc2xhdGVkVGV4dDtcclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgYXN5bmMgZnVuY3Rpb24gaGFuZGxlcihyZXEsIHJlcykge1xyXG4gIGNvbnN0IHsgaWQgfSA9IHJlcS5xdWVyeTtcclxuICBjb25zdCB1aUxhbmdQYXJhbSA9IHJlcS5xdWVyeS5sYW5nIHx8ICdqYSc7IC8vIOODleODreODs+ODiOOCqOODs+ODieOBi+OCiea4oeOBleOCjOOCi+iogOiqnuODkeODqeODoeODvOOCv1xyXG4gIGNvbnN0IHVpTGFuZyA9IGVuc3VyZUxhbmdDb2RlRm9ybWF0KHVpTGFuZ1BhcmFtKTsgLy8gRGVlcEzjgYzmnJ/lvoXjgZnjgovlvaLlvI8gKEpBLCBFTuOBquOBqSkg44Gr5q2j6KaP5YyWXHJcblxyXG4gIGlmIChyZXEubWV0aG9kID09PSAnR0VUJykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc29sZS5sb2coYEFQSSBIQU5ETEVSOiBMb29raW5nIGZvciB0aHJlYWQgd2l0aCBJRDogJHtpZH0sIFJlcXVlc3RlZCBVSSBsYW5ndWFnZTogJHt1aUxhbmd9IChwYXJhbTogJHt1aUxhbmdQYXJhbX0pYCk7XHJcbiAgICAgIGxldCB0aHJlYWREYXRhID0gYXdhaXQgZ2V0VGhyZWFkV2l0aFBvc3RzKGlkKTtcclxuXHJcbiAgICAgIGlmICghdGhyZWFkRGF0YSkge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGBBUEkgSEFORExFUjogVGhyZWFkIG5vdCBmb3VuZCBmb3IgSUQ6ICR7aWR9YCk7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA0KS5qc29uKHsgZXJyb3I6ICdUaHJlYWQgbm90IGZvdW5kJyB9KTtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8g44K544Os44OD44OJ6Ieq5L2T44Gu5YWD44Gu6KiA6Kqe44CC44Gq44GR44KM44GwJ2phJ+OCkuODleOCqeODvOODq+ODkOODg+OCr+OBqOOBmeOCi+OBi+OAgeOCqOODqeODvOOBqOOBmeOCi+OBi+OBr+S7leanmOasoeesrOOAglxyXG4gICAgICAvLyDjgZPjgZPjgafjga8namEn44KS44OV44Kp44O844Or44OQ44OD44Kv44Go44GX44G+44GZ44CCXHJcbiAgICAgIGNvbnN0IHRocmVhZE9yaWdpbmFsTGFuZ1N0b3JlZCA9IHRocmVhZERhdGEubGFuZyB8fCAnamEnO1xyXG4gICAgICBjb25zdCB0aHJlYWRPcmlnaW5hbExhbmcgPSBlbnN1cmVMYW5nQ29kZUZvcm1hdCh0aHJlYWRPcmlnaW5hbExhbmdTdG9yZWQpO1xyXG4gICAgICBjb25zb2xlLmxvZyhgQVBJIEhBTkRMRVI6IFRocmVhZCAke2lkfSBvcmlnaW5hbCBsYW5ndWFnZTogJHt0aHJlYWRPcmlnaW5hbExhbmd9IChzdG9yZWQgYXMgJHt0aHJlYWRPcmlnaW5hbExhbmdTdG9yZWR9KWApO1xyXG5cclxuICAgICAgLy8g44K544Os44OD44OJ44K/44Kk44OI44Or44Gu57+76KizXHJcbiAgICAgIGlmICh0aHJlYWREYXRhLnRocmVhZC50aXRsZSkge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGBBUEkgSEFORExFUjogUHJvY2Vzc2luZyB0aXRsZSBmb3IgdGhyZWFkICR7aWR9LiBPcmlnaW5hbDogXCIke3RocmVhZERhdGEudGhyZWFkLnRpdGxlLnN1YnN0cmluZygwLDUwKX0uLi5cIiwgT3JpZ2luYWwgbGFuZzogJHt0aHJlYWRPcmlnaW5hbExhbmd9LCBUYXJnZXQgVUkgbGFuZzogJHt1aUxhbmd9YCk7XHJcbiAgICAgICAgdGhyZWFkRGF0YS50aHJlYWQudGl0bGUgPSBhd2FpdCB0cmFuc2xhdGVDb250ZW50KHRocmVhZERhdGEudGhyZWFkLnRpdGxlLCB1aUxhbmcsIHRocmVhZE9yaWdpbmFsTGFuZywgYHRocmVhZF8ke2lkfWAsICd0aXRsZScpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGBBUEkgSEFORExFUjogVGhyZWFkICR7aWR9IGhhcyBubyB0aXRsZSB0byB0cmFuc2xhdGUuYCk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIOOCueODrOODg+ODieiqrOaYjuaWh+OBrue/u+ios1xyXG4gICAgICBpZiAodGhyZWFkRGF0YS50aHJlYWQuZGVzY3JpcHRpb24pIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhgQVBJIEhBTkRMRVI6IFByb2Nlc3NpbmcgZGVzY3JpcHRpb24gZm9yIHRocmVhZCAke2lkfS4gT3JpZ2luYWw6IFwiJHt0aHJlYWREYXRhLnRocmVhZC5kZXNjcmlwdGlvbi5zdWJzdHJpbmcoMCw1MCl9Li4uXCIsIE9yaWdpbmFsIGxhbmc6ICR7dGhyZWFkT3JpZ2luYWxMYW5nfSwgVGFyZ2V0IFVJIGxhbmc6ICR7dWlMYW5nfWApO1xyXG4gICAgICAgIGNvbnN0IHRyYW5zbGF0ZWREZXNjcmlwdGlvbiA9IGF3YWl0IHRyYW5zbGF0ZUNvbnRlbnQodGhyZWFkRGF0YS50aHJlYWQuZGVzY3JpcHRpb24sIHVpTGFuZywgdGhyZWFkT3JpZ2luYWxMYW5nLCBgdGhyZWFkXyR7aWR9YCwgJ2Rlc2NyaXB0aW9uJyk7XHJcbiAgICAgICAgdGhyZWFkRGF0YS50aHJlYWRbYGRlc2NyaXB0aW9uXyR7dWlMYW5nUGFyYW0udG9Mb3dlckNhc2UoKX1gXSA9IHRyYW5zbGF0ZWREZXNjcmlwdGlvbjtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhgQVBJIEhBTkRMRVI6IFRocmVhZCAke2lkfSBoYXMgbm8gZGVzY3JpcHRpb24gdG8gdHJhbnNsYXRlLmApO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyDlkITmipXnqL/jga7mnKzmlofjgpLnv7voqLNcclxuICAgICAgaWYgKHRocmVhZERhdGEucG9zdHMgJiYgdGhyZWFkRGF0YS5wb3N0cy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coYEFQSSBIQU5ETEVSOiBQcm9jZXNzaW5nICR7dGhyZWFkRGF0YS5wb3N0cy5sZW5ndGh9IHBvc3RzIGZvciB0aHJlYWQgJHtpZH0uYCk7XHJcbiAgICAgICAgdGhyZWFkRGF0YS5wb3N0cyA9IGF3YWl0IFByb21pc2UuYWxsKFxyXG4gICAgICAgICAgdGhyZWFkRGF0YS5wb3N0cy5tYXAoYXN5bmMgKHBvc3QpID0+IHtcclxuICAgICAgICAgICAgaWYgKCFwb3N0IHx8ICFwb3N0LmlkKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oYEFQSSBIQU5ETEVSOiBJbnZhbGlkIHBvc3Qgb2JqZWN0IGZvdW5kIGluIHRocmVhZCAke2lkfSwgc2tpcHBpbmcuYCwgcG9zdCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcG9zdDsgLy8gb3IgZmlsdGVyIGl0IG91dCBlYXJsaWVyXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKCFwb3N0LmJvZHkpIHtcclxuICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgQVBJIEhBTkRMRVI6IFBvc3QgJHtwb3N0LmlkfSBoYXMgbm8gYm9keSB0byB0cmFuc2xhdGUuYCk7XHJcbiAgICAgICAgICAgICAgcmV0dXJuIHBvc3Q7IC8vIOacrOaWh+OBjOOBquOBkeOCjOOBsOe/u+ios+S4jeimgVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyDlkITmipXnqL/jga7lhYPjga7oqIDoqp4gKHBvc3Qub3JpZ2luYWxfbGFuZyDjgYxEQuOBq+S/neWtmOOBleOCjOOBpuOBhOOCi+OBk+OBqOOCkuacn+W+hSlcclxuICAgICAgICAgICAgbGV0IHBvc3RPcmlnaW5hbExhbmdTdG9yZWQgPSBwb3N0Lm9yaWdpbmFsX2xhbmc7XHJcbiAgICAgICAgICAgIGxldCBwb3N0T3JpZ2luYWxMYW5nID0gbnVsbDtcclxuXHJcbiAgICAgICAgICAgIGlmIChwb3N0T3JpZ2luYWxMYW5nU3RvcmVkKSB7XHJcbiAgICAgICAgICAgICAgcG9zdE9yaWdpbmFsTGFuZyA9IGVuc3VyZUxhbmdDb2RlRm9ybWF0KHBvc3RPcmlnaW5hbExhbmdTdG9yZWQpO1xyXG4gICAgICAgICAgICAgIGNvbnNvbGUubG9nKGBBUEkgSEFORExFUjogUG9zdCAke3Bvc3QuaWR9IG9yaWdpbmFsIGxhbmd1YWdlIGZyb20gREI6ICR7cG9zdE9yaWdpbmFsTGFuZ30gKHN0b3JlZCBhcyAke3Bvc3RPcmlnaW5hbExhbmdTdG9yZWR9KSBmb3IgYm9keTogXCIke3Bvc3QuYm9keS5zdWJzdHJpbmcoMCwyMCl9Li4uXCJgKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAvLyBvcmlnaW5hbF9sYW5nIOOBjOOBquOBhOWgtOWQiOOAgeacrOaWh+OBi+OCieiogOiqnuOCkuaknOWHulxyXG4gICAgICAgICAgICAgIGNvbnNvbGUubG9nKGBBUEkgSEFORExFUjogUG9zdCAke3Bvc3QuaWR9IG9yaWdpbmFsX2xhbmcgbm90IGZvdW5kIGluIERCLiBEZXRlY3RpbmcgZnJvbSBib2R5OiBcIiR7cG9zdC5ib2R5LnN1YnN0cmluZygwLDIwKX0uLi5cImApO1xyXG4gICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBkZXRlY3RlZCA9IGF3YWl0IGRldGVjdExhbmcocG9zdC5ib2R5KTsgLy8gZGV0ZWN0TGFuZ+OBr0RlZXBM5b2i5byP44Gu6KiA6Kqe44Kz44O844OJ44KS6L+U44GZ44Go5pyf5b6FXHJcbiAgICAgICAgICAgICAgICBpZiAoZGV0ZWN0ZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBwb3N0T3JpZ2luYWxMYW5nID0gZW5zdXJlTGFuZ0NvZGVGb3JtYXQoZGV0ZWN0ZWQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGBBUEkgSEFORExFUjogUG9zdCAke3Bvc3QuaWR9IGxhbmd1YWdlIGRldGVjdGVkIGFzOiAke3Bvc3RPcmlnaW5hbExhbmd9YCk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g44GT44GT44Gn5qSc5Ye644GX44Gf6KiA6Kqe44KSRELjga4gcG9zdC5vcmlnaW5hbF9sYW5nIOOBq+S/neWtmOOBmeOCi+abtOaWsOWHpueQhuOCkuWFpeOCjOOBpuOCguiJr+OBhCAo44Kq44OX44K344On44OzKVxyXG4gICAgICAgICAgICAgICAgICAgIC8vIGF3YWl0IHNhdmVQb3N0T3JpZ2luYWxMYW5nKHBvc3QuaWQsIHBvc3RPcmlnaW5hbExhbmcpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyDmpJzlh7rlpLHmlZfmmYLjga/jgrnjg6zjg4Pjg4njga7oqIDoqp7jgavjg5Xjgqnjg7zjg6vjg5Djg4Pjgq9cclxuICAgICAgICAgICAgICAgICAgICBwb3N0T3JpZ2luYWxMYW5nID0gdGhyZWFkT3JpZ2luYWxMYW5nO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGBBUEkgSEFORExFUjogUG9zdCAke3Bvc3QuaWR9IGxhbmd1YWdlIGRldGVjdGlvbiBmYWlsZWQsIGZhbGxpbmcgYmFjayB0byB0aHJlYWQgbGFuZzogJHtwb3N0T3JpZ2luYWxMYW5nfWApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYEFQSSBIQU5ETEVSOiBFcnJvciBkZXRlY3RpbmcgbGFuZ3VhZ2UgZm9yIHBvc3QgJHtwb3N0LmlkfSwgZmFsbGluZyBiYWNrIHRvIHRocmVhZCBsYW5nICR7dGhyZWFkT3JpZ2luYWxMYW5nfS4gRXJyb3I6YCwgZSk7XHJcbiAgICAgICAgICAgICAgICBwb3N0T3JpZ2luYWxMYW5nID0gdGhyZWFkT3JpZ2luYWxMYW5nO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY29uc3QgdHJhbnNsYXRlZEJvZHkgPSBhd2FpdCB0cmFuc2xhdGVDb250ZW50KHBvc3QuYm9keSwgdWlMYW5nLCBwb3N0T3JpZ2luYWxMYW5nLCBwb3N0LmlkLCAnYm9keScpO1xyXG4gICAgICAgICAgICByZXR1cm4geyAuLi5wb3N0LCBib2R5OiB0cmFuc2xhdGVkQm9keSwgb3JpZ2luYWxfbGFuZzogcG9zdE9yaWdpbmFsTGFuZywgdHJhbnNsYXRlZF90bzogdWlMYW5nIH07XHJcbiAgICAgICAgICB9KVxyXG4gICAgICAgICk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coYEFQSSBIQU5ETEVSOiBUaHJlYWQgJHtpZH0gaGFzIG5vIHBvc3RzIHRvIHRyYW5zbGF0ZS5gKTtcclxuICAgICAgfVxyXG4gICAgICBjb25zb2xlLmxvZyhgQVBJIEhBTkRMRVI6IFJldHVybmluZyB0aHJlYWQgJHtpZH0gd2l0aCAke3RocmVhZERhdGEucG9zdHMgPyB0aHJlYWREYXRhLnBvc3RzLmxlbmd0aCA6IDB9IHBvc3RzLCBwcm9jZXNzZWQgZm9yIFVJIGxhbmd1YWdlICR7dWlMYW5nfS5gKTtcclxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5qc29uKHRocmVhZERhdGEpO1xyXG5cclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoYEFQSSBIQU5ETEVSOiBFcnJvciBmZXRjaGluZyBvciBwcm9jZXNzaW5nIHRocmVhZCAke2lkfSAoVUkgbGFuZzogJHt1aUxhbmd9KS4gRXJyb3I6YCwgZXJyb3IpO1xyXG4gICAgICAvLyDjgqjjg6njg7zjgqrjg5bjgrjjgqfjgq/jg4jlhajkvZPjgoTjgrnjgr/jg4Pjgq/jg4jjg6zjg7zjgrnjgpLjg63jgrDjgavlh7rlipvjgZnjgovjgajjg4fjg5Djg4PjgrDjgavlvbnnq4vjgaRcclxuICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIGRldGFpbHM6XCIsIGVycm9yLm1lc3NhZ2UsIGVycm9yLnN0YWNrKTtcclxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6ICdGYWlsZWQgdG8gZmV0Y2ggb3IgcHJvY2VzcyB0aHJlYWQgZGF0YScsIGRldGFpbHM6IGVycm9yLm1lc3NhZ2UgfSk7XHJcbiAgICB9XHJcbiAgfSBlbHNlIHtcclxuICAgIGNvbnNvbGUubG9nKGBBUEkgSEFORExFUjogTWV0aG9kICR7cmVxLm1ldGhvZH0gbm90IGFsbG93ZWQgZm9yIC9hcGkvdGhyZWFkcy9baWRdYCk7XHJcbiAgICByZXMuc2V0SGVhZGVyKCdBbGxvdycsIFsnR0VUJ10pOyAvLyDjgZPjga7jgqjjg7Pjg4njg53jgqTjg7Pjg4jjgYxHRVTjga7jgb/jgpLmg7PlrprjgZnjgovloLTlkIhcclxuICAgIHJldHVybiByZXMuc3RhdHVzKDQwNSkuanNvbih7IGVycm9yOiBgTWV0aG9kICR7cmVxLm1ldGhvZH0gTm90IEFsbG93ZWRgIH0pO1xyXG4gIH1cclxufSAiXSwibmFtZXMiOlsic3VwYWJhc2UiLCJ0cmFuc2xhdGVXaXRoRGVlcEwiLCJnZXRUcmFuc2xhdGlvbiIsInNhdmVUcmFuc2xhdGlvbiIsInRyYW5zbGF0ZVRleHQiLCJkZXRlY3RMYW5nIiwiZW5zdXJlTGFuZ0NvZGVGb3JtYXQiLCJ0aHJlYWRzU3RvcmUiLCJwb3N0c1N0b3JlIiwiYWRkVGhyZWFkIiwiYWRkUG9zdCIsImRlYnVnRGF0YVN0b3JlIiwiZ2V0VGhyZWFkV2l0aFBvc3RzIiwiZ2V0Q2FjaGVkVHJhbnNsYXRpb24iLCJzZXRDYWNoZWRUcmFuc2xhdGlvbiIsImVycm9yIiwiY29uc29sZSIsInRyYW5zbGF0ZUNvbnRlbnQiLCJ0ZXh0IiwidGFyZ2V0TGFuZyIsInNvdXJjZUxhbmciLCJjb250ZW50SWQiLCJmaWVsZCIsImxvZyIsIm5vcm1hbGl6ZWRTb3VyY2VMYW5nIiwibm9ybWFsaXplZFRhcmdldExhbmciLCJsb2dUZXh0Iiwic3Vic3RyaW5nIiwiY2FjaGVLZXlDb250ZW50SWQiLCJjYWNoZUtleSIsImNhY2hlZCIsImxvZ0NhY2hlZCIsImVmZmVjdGl2ZVNvdXJjZUxhbmciLCJsb2dUZXh0Rm9yUmVxdWVzdCIsInRyYW5zbGF0ZWRUZXh0IiwibG9nT3JpZ2luYWxUZXh0IiwibG9nVHJhbnNsYXRlZCIsImhhbmRsZXIiLCJyZXEiLCJyZXMiLCJpZCIsInF1ZXJ5IiwidWlMYW5nUGFyYW0iLCJsYW5nIiwidWlMYW5nIiwibWV0aG9kIiwidGhyZWFkRGF0YSIsInN0YXR1cyIsImpzb24iLCJ0aHJlYWRPcmlnaW5hbExhbmdTdG9yZWQiLCJ0aHJlYWRPcmlnaW5hbExhbmciLCJ0aHJlYWQiLCJ0aXRsZSIsImRlc2NyaXB0aW9uIiwidHJhbnNsYXRlZERlc2NyaXB0aW9uIiwidG9Mb3dlckNhc2UiLCJwb3N0cyIsImxlbmd0aCIsIlByb21pc2UiLCJhbGwiLCJtYXAiLCJwb3N0Iiwid2FybiIsImJvZHkiLCJwb3N0T3JpZ2luYWxMYW5nU3RvcmVkIiwib3JpZ2luYWxfbGFuZyIsInBvc3RPcmlnaW5hbExhbmciLCJkZXRlY3RlZCIsImUiLCJ0cmFuc2xhdGVkQm9keSIsInRyYW5zbGF0ZWRfdG8iLCJtZXNzYWdlIiwic3RhY2siLCJkZXRhaWxzIiwic2V0SGVhZGVyIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./pages/api/threads/[id].js\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fthreads%2F%5Bid%5D&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cthreads%5C%5Bid%5D.js&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();